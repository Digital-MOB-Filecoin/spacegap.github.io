(this.webpackJsonpspacegap=this.webpackJsonpspacegap||[]).push([[0],{108:function(e,t,n){e.exports=n(178)},113:function(e,t,n){},122:function(e,t){},134:function(e,t){},136:function(e,t){},177:function(e,t,n){},178:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(101),o=n.n(i),c=(n(113),n(1)),s=n.n(c),u=n(2),l=n(3),d=n(10),f=n(12),m=n(8),p=n(6),h=n(14),v=n(9),b=n(11),g=n(4),w=n(73),y=n(55),E=n(74),x=n.n(E),j=function(e){var t=288888888e10,n=Math.pow(2,1/1051200),a=1/Math.log(n),r=-t*a;return Math.log((e-r)/(t*a))/Math.log(n)},O=function(e,t,n,a){var r=Math.log(2)/6307200,i=33e7*(1-Math.pow(Math.E,-r*t)),o=33e7*(1-Math.pow(Math.E,-r*e)),c=77e7*(1-Math.pow(Math.E,-r*a));return o+77e7*(1-Math.pow(Math.E,-r*n))-i-c},k=function(e){var t=Math.pow(2,1/1051200);return 288888888e10*Math.pow(t,e)},S=function(){function e(t){var n=t.currEpoch,a=t.nwqap,r=t.nwqapP,i=t.nwqapV,o=t.nwCircSupply,c=t.perEpochRewardP,s=t.perEpochRewardV,u=t.perDurationNwRbGrowth,l=t.projectedDays,d=t.perDurationMinerQaGrowth,f=t.nwCumsumRealized;Object(v.a)(this,e),Object.assign(this,{currEpoch:n,nwqap:a,nwqapP:r,nwqapV:i,nwCircSupply:o,perEpochRewardP:c,perEpochRewardV:s,perDurationNwRbGrowth:u,projectedDays:l,perDurationMinerQaGrowth:d,nwCumsumRealized:f})}return Object(b.a)(e,[{key:"projectFutureReward",value:function(e,t){var n=new M(this.nwqapP,this.nwqapV),a=new M(this.perEpochRewardP,this.perEpochRewardV);return e*N(a,n,2880*t)}},{key:"computeInitialPledgeForQAPower",value:function(e,t){return this.projectFutureReward(e,20)+.3*e*this.nwCircSupply/Math.max(this.nwqap,k(t))}},{key:"summary",value:function(){return{sectorIp:this.computeInitialPledgeForQAPower(32*Math.pow(2,30),this.currEpoch),sectorProjectedReward:this.projectFutureReward(32*Math.pow(2,30),360),sectorProjectedReward1:this.projectFutureReward(32*Math.pow(2,30),1),sectorFaultFee:this.projectFutureReward(32*Math.pow(2,30),3.51)}}},{key:"computeInitialPledgeFromAssumptions",value:function(){for(var e=this.currEpoch,t=this.nwqap,n=this.nwqapP,a=this.nwqapV,r=this.nwCircSupply,i=this.perEpochRewardP,o=this.perEpochRewardV,c=this.perDurationNwRbGrowth,s=this.projectedDays,u=this.perDurationMinerQaGrowth,l=this.nwCumsumRealized,d=new M(n,a),f=new M(i,o),m=c/s/2880,p=u/s/2880,h=[],v=0,b=t,g=l,w=j(l),y=e+1;y<e+2880*s+1;y++){var E=p*(N(f,d,57600)+.3*r/Math.max(b,k(y)));h.push(E),v+=E;var x=j(g+=b+=m),S=O(y,y-1,x,w);f.addNewEntry(S,1),d.addNewEntry(b,1),w=x}return{newInitialPledges:h,totalInitialPledge:v}}}]),e}(),M=function(){function e(t,n){Object(v.a)(this,e),this.alpha=925e-6,this.beta=284e-9,this.p=t,this.v=n}return Object(b.a)(e,[{key:"addNewEntry",value:function(e,t){this.p+=this.v*t;var n=e-this.p;this.p+=this.alpha*n,this.p=Math.max(this.p,0),this.v+=this.beta*n/t}}]),e}(),N=function(e,t,n){var a=Math.log(t.p+t.v),r=Math.log(t.p+t.v+t.v*n);return(t.v*e.p*(r-a)+e.v*(t.p*(a-r)+t.v*n))/Math.pow(t.v,2)},T=5*Math.pow(10,9);function P(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){var n=Object(l.a)(e,2),a=n[0],r=n[1];return t(r,a)})))}function R(e,t){return Object.entries(e).map((function(e,n){var a=Object(l.a)(e,2),r=a[0],i=a[1];return t(i,r,n)}))}function I(e){for(var t=["B","KiB","MiB","GiB","TiB","PiB","EiB"],n=0;e>=1024&&n<t.length-1;)e/=1024,n++;return e=e.toFixed(2),"".concat(e," ").concat(t[n])}var C=function(){function e(t,n){Object(v.a)(this,e),this.fetcher=t,this.average=n,this.tipsets={}}return Object(b.a)(e,[{key:"fetchCids",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Initializing gas stats engine"),e.next=3,this.fetcher.fetchHead();case 3:t=e.sent,n=t.Height,this.tipsets[t.Height]=t,a=1;case 7:if(!(a<this.average)){e.next=16;break}return e.next=10,this.fetcher.fetchTipsetHead(n-a);case 10:r=e.sent,this.tipsets[r.Height]=r,console.log(a,"/",this.average,": init fetched tipset at height ",r.Height," with [0] = ",r);case 13:a++,e.next=7;break;case 16:console.log("Stats: got "+Object.keys(this.tipsets).length+" tipset CIDs to make stats from");case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgGasOfMethod",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,a);case 2:return t=e.sent,n=t.reduce((function(e,t){return e+t[1].GasUsed}),0),e.abrupt("return",n/t.length);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgGasLimit",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,t);case 2:return e.abrupt("return",e.sent.reduce((function(e,t){return e+t[0].Message.GasLimit}),0));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgGasFeeCap",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,r,i,o,c,u,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=0,n=l.length,a=new Array(n),r=0;r<n;r++)a[r]=l[r];e.t0=s.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=12;break}return i=e.t1.value,c=this.tipsets[i],e.next=8,(o=this.fetcher).parentAndReceiptsMessages.apply(o,[c.Cids[0]].concat(a));case 8:u=e.sent,t+=u.reduce((function(e,t){return e+parseInt(t[0].Message.GasFeeCap)}),0)/u.length,e.next=3;break;case 12:return e.abrupt("return",t/Object.keys(this.tipsets).length);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgTotalGasUsed",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.keys(this.tipsets).length,e.next=3,this.transactions.apply(this,a);case 3:return n=e.sent.reduce((function(e,t){return e+t[1].GasUsed}),0),e.abrupt("return",n/t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgNumberTx",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,n);case 2:return t=e.sent,e.abrupt("return",t.length/Object.keys(this.tipsets).length);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"transactions",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,r,i,o,c,u,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=l.length,a=new Array(n),r=0;r<n;r++)a[r]=l[r];e.t0=s.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=12;break}return i=e.t1.value,c=this.tipsets[i],e.next=8,(o=this.fetcher).parentAndReceiptsMessages.apply(o,[c.Cids[0]].concat(a));case 8:u=e.sent,t=t.concat(u),e.next=3;break;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"transactionsPerHeight",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,r,i,o,c,u,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=l.length,a=new Array(n),r=0;r<n;r++)a[r]=l[r];e.t0=s.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=12;break}return i=e.t1.value,c=this.tipsets[i],e.next=8,(o=this.fetcher).parentAndReceiptsMessages.apply(o,[c.Cids[0]].concat(a));case 8:u=e.sent,t[i]=u,e.next=3;break;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgRatioUsedOverTotalUsed",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,a);case 2:return t=e.sent.reduce((function(e,t){return e+t[1].GasUsed}),0),e.next=5,this.transactions();case 5:return n=e.sent.reduce((function(e,t){return e+t[1].GasUsed}),0),e.abrupt("return",t/n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgRatioLimitOverTotalLimit",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,a);case 2:return t=e.sent.reduce((function(e,t){return e+t[0].Message.GasLimit}),0),e.next=5,this.transactions();case 5:return n=e.sent.reduce((function(e,t){return e+t[0].Message.GasLimit}),0),e.abrupt("return",t/n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgTotalGasLimitOverTipsetLimit",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,r,i,o,c,u,l,d,f,m=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=m.length,a=new Array(n),r=0;r<n;r++)a[r]=m[r];e.t0=s.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=15;break}return i=e.t1.value,c=this.tipsets[i],e.next=8,(o=this.fetcher).parentAndReceiptsMessages.apply(o,[c.Cids[0]].concat(a));case 8:u=e.sent,l=u.reduce((function(e,t){return e+t[0].Message.GasLimit}),0),d=c.Cids.length,f=l/(T*d),t.push(f),e.next=3;break;case 15:return e.abrupt("return",t.reduce((function(e,t){return e+t}),0)/t.length);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgTotalGasUsedOverTipsetLimit",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,r,i,o,c,u,l,d,f,m=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=m.length,a=new Array(n),r=0;r<n;r++)a[r]=m[r];e.t0=s.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=15;break}return i=e.t1.value,c=this.tipsets[i],e.next=8,(o=this.fetcher).parentAndReceiptsMessages.apply(o,[c.Cids[0]].concat(a));case 8:u=e.sent,l=u.reduce((function(e,t){return e+t[1].GasUsed}),0),d=c.Cids.length,f=l/(T*d),t.push(f),e.next=3;break;case 15:return e.abrupt("return",t.reduce((function(e,t){return e+t}),0)/t.length);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgRatioUsedOverLimit",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,a);case 2:return t=e.sent.reduce((function(e,t){return e+t[1].GasUsed}),0),e.next=5,this.transactions.apply(this,a);case 5:return n=e.sent.reduce((function(e,t){return e+t[0].Message.GasLimit}),0),e.abrupt("return",t/n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"biggestGasUserFor",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,r,i,o=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=s.a.keys(this.tipsets);case 2:if((e.t1=e.t0()).done){e.next=13;break}return n=e.t1.value,e.next=6,this.transactions.apply(this,o);case 6:a=e.sent,r=a.reduce((function(e,t){return void 0==e[t[0].Message.To]&&(e[t[0].Message.To]=0),e[t[0].Message.To]+=t[1].GasUsed,e}),{}),i=R(r,(function(e,t){return[t,e]})).sort((function(e,t){return t[1]-e[1]})),t[n]=i,console.log("Biggest txs at height",n," -> ",i.slice(0,10)),e.next=2;break;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sortedHeights",value:function(){return Object.keys(this.tipsets).sort((function(e,t){return t-e}))}},{key:"minerInfo",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,i,o,c,u,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.sortedHeights(),a=this.tipsets[n[0]],e.next=4,this.fetcher.getMinerPower(a.Cids,a.Height,t);case 4:return r=e.sent,e.next=7,this.avgGasOfMethod(5);case 7:return i=e.sent,d=r.MinerPower.RawBytePower,o=d/1024/1024/1024/32,c=I(r.MinerPower.RawBytePower),u=o/2349*i,e.t0=u,e.next=14,this.avgGasFeeCap(5);case 14:return e.t1=e.sent,l=e.t0*e.t1,e.abrupt("return",{raw:r.MinerPower.RawBytePower,ratio:(r.MinerPower.RawBytePower/r.TotalPower.RawBytePower).toFixed(3),size:c,dailyGas:u.toFixed(2),maxDailyPrice:(s=l,s*Math.pow(10,-18)).toFixed(2)});case 17:case"end":return e.stop()}var s,d}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),L=(n(25),n(27)),A=n.n(L),_=n(25),D=_.format("0.2f"),F=n(167)("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),z=n(42),q=n(179).testnet.fullNode;function G(e){if(""===e)return window.BigInt(0);var t=atob(e),n=[];return t.split("").forEach((function(e){var t=e.charCodeAt(0).toString(16);t.length%2&&(t="0"+t),n.push(t)})),window.BigInt("0x"+n.join(""))}var U={bafkqaddgnfwc6mjpon4xg5dfnu:"systemActor",bafkqactgnfwc6mjpnfxgs5a:"initActor",bafkqaddgnfwc6mjpojsxoylsmq:"rewardActor",bafkqactgnfwc6mjpmnzg63q:"cronActor",bafkqaetgnfwc6mjpon2g64tbm5sxa33xmvza:"storagePowerActor",bafkqae3gnfwc6mjpon2g64tbm5sw2ylsnnsxi:"storageMarketActor",bafkqaftgnfwc6mjpozsxe2lgnfswi4tfm5uxg5dspe:"verifiedRegistryActor",bafkqadlgnfwc6mjpmfrwg33vnz2a:"accountActor",bafkqadtgnfwc6mjpnv2wy5djonuwo:"multisigActor",bafkqafdgnfwc6mjpobqxs3lfnz2gg2dbnzxgk3a:"paymentChannelActor",bafkqaetgnfwc6mjpon2g64tbm5sw22lomvza:"storageMinerActor",bafkqaddgnfwc6mrpon4xg5dfnu:"systemActor",bafkqactgnfwc6mrpnfxgs5a:"initActor",bafkqaddgnfwc6mrpojsxoylsmq:"rewardActorV2",bafkqactgnfwc6mrpmnzg63q:"cronActor",bafkqaetgnfwc6mrpon2g64tbm5sxa33xmvza:"storagePowerActorV2",bafkqae3gnfwc6mrpon2g64tbm5sw2ylsnnsxi:"storageMarketActorV2",bafkqaftgnfwc6mrpozsxe2lgnfswi4tfm5uxg5dspe:"verifiedRegistryActor",bafkqadlgnfwc6mrpmfrwg33vnz2a:"accountActor",bafkqadtgnfwc6mrpnv2wy5djonuwo:"multisigActor",bafkqafdgnfwc6mrpobqxs3lfnz2gg2dbnzxgk3a:"paymentChannelActor",bafkqaetgnfwc6mrpon2g64tbm5sw22lomvza:"storageMinerActorV2"},B=function(e){return!e||e>=138720?{Sectors:"buffer",Unproven:"buffer",Faults:"buffer",Recoveries:"buffer",Terminated:"buffer",ExpirationEpochs:"cid",EarlyTerminated:"cid",LivePower:{a:"bigint",b:"bigint"},UnprovenPower:{a:"bigint",b:"bigint"},FaultyPower:{a:"bigint",b:"bigint"},RecoveringPower:{a:"bigint",b:"bigint"}}:{Sectors:"buffer",Faults:"buffer",Recoveries:"buffer",Terminated:"buffer",ExpirationEpochs:"cid",EarlyTerminated:"cid",LivePower:{a:"bigint",b:"bigint"},FaultyPower:{a:"bigint",b:"bigint"},RecoveringPower:{a:"bigint",b:"bigint"}}},V={type:"hamt",key:"bigint",value:{info:{seal_proof:"int",sector_number:"int",sealed_cid:"cid",seal_rand_epoch:"int",deal_ids:["list","int"],expiration:"int",replace_capacity:"bool",replace_sector_deadline:"int",replace_sector_partition:"int",replace_sector_number:"int"},precommit_deposit:"bigint",precommit_epoch:"int",deal_weight:"bigint",verified_deal_weight:"bigint"}},H=window.BigInt;function W(e){for(var t=H(0),n=0;n<e.length;n++)t*=H(256),t+=window.BigInt(e[n]);return t}function Y(e){for(var t=new z(0),n=0;n<e.length;n++)t=(t=t.mul(new z(256))).add(new z(e[e.length-n-1]));return t}function X(e,t){var n=e.num.and(new z(1).shln(t).sub(new z(1)));return e.num=e.num.shrn(t),e.left-=t,n.toNumber()}function Q(e){var t,n=function(e){for(var t={left:8*e.length,num:Y(e)},n=(X(t,2),X(t,1)),a=[];t.left>0;){if(1!==X(t,1))if(1!==X(t,1)){for(var r=0,i=0,o=0;;o++){if(10===o)throw new Error("run too long");var c=X(t,8);if(c<128){if(o>9||9===o&&c>1)throw new Error("run too long");if(0===c&&i>0)throw new Error("invalid run");r|=c<<i;break}r|=(127&c)<<i,i+=7}a.push(r)}else{var s=X(t,4);a.push(s)}else a.push(1)}return{first:n,runs:a}}(e),a=n.first,r=n.runs,i=a,o=[],c=0,s=Object(g.a)(r);try{for(s.s();!(t=s.n()).done;){for(var u=t.value,l=0;l<u;l++)1===i&&o.push(c),c++;i=1-i}}catch(d){s.e(d)}finally{s.f()}return o}var Z=function(){function e(t){Object(v.a)(this,e),this.url=t;var n=new y.a(t);console.log("new endpoint",t),this.client=new w.LotusRPC(n,{schema:q}),this.parents={},this.receipts={},this.minfo={}}return Object(b.a)(e,[{key:"getData",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n,a){var r,i,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.Blocks[0].ParentStateRoot["/"],i=t.Height>=138720?"".concat(r,"/1/").concat(n):"".concat(r,"/").concat(n),e.next=4,this.client.chainGetNode(i);case 4:return o=e.sent.Obj,c=this,e.next=8,x.a.methods.decode(a,o).asObject(function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.client.chainGetNode(t);case 2:return n=e.sent,e.abrupt("return",n.Obj);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"fetchHead",value:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.client.chainHead());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchPartitionsSectors",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.chainGetNode("".concat(t["/"]));case 2:return a=e.sent.Obj[2][2],e.abrupt("return",a.map((function(e){var t=x.a.methods.decode(B(n),e);return[{Sectors:Q(t.Sectors),Faults:Q(t.Faults).reduce((function(e,t){return e[t]=!0,e}),{}),Terminated:Q(t.Terminated).reduce((function(e,t){return e[t]=!0,e}),{}),Recoveries:Q(t.Recoveries).reduce((function(e,t){return e[t]=!0,e}),{})}]})));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchTipsetHead",value:function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.ChainGetTipSetByHeight(t,null);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchPower",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Blocks[0].ParentStateRoot["/"],a=t.Height>=138720?"".concat(n,"/1/@Ha:t04/1"):"".concat(n,"/@Ha:t04/1"),e.next=4,this.client.chainGetNode(a);case 4:return r=e.sent.Obj,e.abrupt("return",{TotalRawBytePower:W(F.decode(r[0])),TotalBytesCommitted:W(F.decode(r[1])),TotalQualityAdjPower:W(F.decode(r[2])),TotalQABytesCommitted:W(F.decode(r[3])),TotalPledgeCollateral:W(F.decode(r[4])),ThisEpochRawBytePower:W(F.decode(r[5])),ThisEpochQualityAdjPower:W(F.decode(r[6])),ThisEpochPledgeCollateral:W(F.decode(r[7]))});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchActor",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.StateGetActor(t,n.Cids);case 2:return(a=e.sent).type=U[a.Code["/"]],e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchDeposits",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r,i,o,c,u,l,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.StateReadState(t,n.Cids);case 2:return a=e.sent,r=a.State,i=a.Balance,o=r.PreCommitDeposits,c=r.LockedFunds,u=r.InitialPledge,l=r.FeeDebt,d=i-u-o-c,e.abrupt("return",{Balance:D(i/1e18),InitialPledge:D(u/1e18),Available:D(d/1e18),LockedFunds:D(c/1e18),PreCommitDeposits:D(o/1e18),FeeDebt:D(l/1e18)});case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMiners",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.localStorage.getItem("miners"),n=window.localStorage.getItem("time"),!(t&&n&&Date.now()-+n<1e3)){e.next=4;break}return e.abrupt("return",JSON.parse(t));case 4:return e.next=6,fetch("https://filfox.info/api/v1/miner/top-miners/power?count=30");case 6:return e.next=8,e.sent.json();case 8:return a=e.sent,r=a.miners.reduce((function(e,t){return e[t.address]=t,e}),{}),window.localStorage.setItem("miners",JSON.stringify(r)),window.localStorage.setItem("time",Date.now()),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchDeadlinesProxy",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r,i,o,c=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.Blocks[0].ParentStateRoot["/"],r=n.Height>=138720?"".concat(a,"/1/@Ha:").concat(t,"/1/12"):"".concat(a,"/@Ha:").concat(t,"/1/11"),e.next=4,this.client.chainGetNode(r);case 4:return i=e.sent.Obj[0],e.next=7,A()(24,i,function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.client.ChainGetNode("".concat(t["/"]));case 2:return n=e.sent.Obj,e.abrupt("return",{Partitions:n[0],LiveSectors:n[4],TotalSectors:n[5],FaultyPower:{Raw:Number(G(n[6][0]))}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:return o=e.sent,e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchMinerInfo",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.client.StateMinerInfo(t,n.Cids));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchDeadlines",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r,i,o,c,u,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.client.StateMinerProvingDeadline(t,n.Cids),this.fetchDeadlinesProxy(t,n)]);case 2:return a=e.sent,r=Object(l.a)(a,2),i=r[0],o=r[1],c=Object(h.a)(Array(48)).map((function(e,t){return Object(p.a)(Object(p.a)({},o[(i.Index+t)%48]),{},{Close:i.Close+60*t,Index:(i.Index+t)%48})})),u=o.map((function(e){return+e.LiveSectors})).reduce((function(e,t){return e+t}),0),d=o.map((function(e){return+e.FaultyPower.Raw})).reduce((function(e,t){return e+t}),0)/34359738368,e.abrupt("return",{deadlines:o.map((function(e,t){return Object(p.a)(Object(p.a)({},o[t]),{},{Close:i.Close+60*t,Index:t})})),nextDeadlines:c,SectorsCount:u,FaultsCount:d,ActiveCount:u-d,deadline:i});case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateMinerInfo",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n,a,r){var i,o,c=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=c.length>4&&void 0!==c[4]?c[4]:{deadlines:!0},o=t[n],a(Object(p.a)(Object(p.a)({},t),{},Object(m.a)({},n,Object(p.a)({},o)))),this.fetchMinerInfo(n,r).then((function(e){o.info=e,a(Object(p.a)(Object(p.a)({},t),{},Object(m.a)({},n,Object(p.a)({},o))))})).catch((function(e){console.error("failed to fetch miner info")})),i.deadlines&&this.fetchDeadlines(n,r).then((function(e){o.deadlines=e,a(Object(p.a)(Object(p.a)({},t),{},Object(m.a)({},n,Object(p.a)({},o))))})).catch((function(e){console.error("failed to fetch deadlines")})),this.fetchDeposits(n,r).then((function(e){o.deposits=e,a(Object(p.a)(Object(p.a)({},t),{},Object(m.a)({},n,Object(p.a)({},o))))})).catch((function(e){console.error("failed to fetch deposits")})),this.fetchPreCommittedSectors(n,r).then((function(e){o.preCommits=e,a(Object(p.a)(Object(p.a)({},t),{},Object(m.a)({},n,Object(p.a)({},o))))})).catch((function(e){console.error("failed to fetch precommitted sectors",e)}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"updateMinerMarketInfo",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n,a,r){var i,o=this,c=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.length>4&&void 0!==c[4]?c[4]:{deadlines:!0},delete(i=t[n]).ask,this.fetchMinerInfo(n,r).then((function(e){var r=new Promise((function(e){return setTimeout((function(){e({Error:!0})}),2e3)})),c=o.client.ClientQueryAsk(e.PeerId,n);Promise.any([r,c]).then((function(e){i.ask=e,a(Object(p.a)(Object(p.a)({},t),{},Object(m.a)({},n,Object(p.a)({},i))))}))})).catch((function(e){console.error("failed to fetch miner info")}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},{key:"fetchPreCommittedSectors",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.Height>=138720?"@Ha:".concat(t,"/1/6"):"@Ha:".concat(t,"/1/5"),e.next=3,this.getData(n,a,V);case 3:return r=e.sent,i=_.groups(Object.keys(r).map((function(e){return{SectorNumber:r[e].info.sector_number,Expiry:r[e].precommit_epoch+10210}})),(function(e){return e.Expiry})).map((function(e){var t=Object(l.a)(e,2);return{Expiry:t[0],Sectors:t[1].map((function(e){return e.SectorNumber}))}})).sort((function(e,t){return e.Expiry-t.Expiry})),e.abrupt("return",{PreCommitDeadlines:i,Count:Object.keys(r).length});case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchSectors",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.StateMinerSectors(t,null,n.Cids);case 2:return a=e.sent,r=a.reduce((function(e,t){return e[t.ID]={number:t.ID,info:t},e}),{}),i=Object.keys(r).length,e.abrupt("return",{sectorsCount:i,Sectors:r});case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"parentMessages",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t["/"]in this.parents)){e.next=2;break}return e.abrupt("return",this.parents[t["/"]]);case 2:return e.next=4,this.client.chainGetParentMessages(t);case 4:return n=e.sent,this.parents[t["/"]]=n,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiptParentMessages",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t["/"]in this.receipts)){e.next=2;break}return e.abrupt("return",this.receipts[t["/"]]);case 2:return e.next=4,this.client.chainGetParentReceipts(t);case 4:return n=e.sent,this.receipts[t["/"]]=n,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parentAndReceiptsMessages",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,i,o,c=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=c.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=c[r];return e.next=3,this.parentMessages(t);case 3:return i=e.sent,e.next=6,this.receiptParentMessages(t);case 6:if(o=e.sent,i.length==o.length){e.next=9;break}throw new Error("invalid length");case 9:return e.abrupt("return",K(i,o).filter((function(e){var t=Object(l.a)(e,2),n=t[0],r=0==t[1].ExitCode,i=!0;return a.length>0&&(i=a.includes(n.Message.Method)),r&&i})));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMinerPower",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n,a){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t["/"]in this.minfo)){e.next=2;break}return e.abrupt("return",this.minfo[t["/"]]);case 2:return e.next=4,this.client.stateMinerPower(a,t);case 4:return r=e.sent,this.minfo[t["/"]]=r,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"fetchGenesisActors",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,i,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.client.StateCirculatingSupply(t.Cids),this.client.StateReadState("f02",t.Cids),this.client.StateReadState("f04",t.Cids),this.client.StateReadState("f05",t.Cids)]);case 2:return n=e.sent,a=Object(l.a)(n,4),r=a[0],i=a[1],o=a[2],c=a[3],e.abrupt("return",{Supply:r,Reward:i,Power:o,Market:c});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"computeEconomics",value:function(e,t,n){var a=t.Supply,r=t.Reward,i=t.Power,o=n.projectedDays,c=n.perDurationNwRbGrowth,s=void 0===c?10*Math.pow(2,50):c,u=n.perDurationMinerQaGrowth,l=void 0===u?Math.pow(2,51):u,d={currEpoch:+e.Height,nwqap:+i.State.ThisEpochQualityAdjPower,nwqapP:+i.State.ThisEpochQAPowerSmoothed.PositionEstimate/Math.pow(2,128),nwqapV:+i.State.ThisEpochQAPowerSmoothed.VelocityEstimate/Math.pow(2,128),nwCircSupply:+a/1e18,perEpochRewardP:+r.State.ThisEpochRewardSmoothed.PositionEstimate/(1e18*Math.pow(2,128)),perEpochRewardV:+r.State.ThisEpochRewardSmoothed.VelocityEstimate/(1e18*Math.pow(2,128)),nwCumsumRealized:+r.State.CumsumRealized,perDurationNwRbGrowth:s,projectedDays:o,perDurationMinerQaGrowth:l};return new S(d).summary()}}]),e}(),K=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return e.map((function(e,t){return n.reduce((function(e,n){return[].concat(Object(h.a)(e),[n[t]])}),[e])}))};function J(e){var t=e.title,n=e.url,a=e.desc;return r.a.createElement("div",{className:"summary col-sm"},r.a.createElement("div",{className:"summary-title ".concat(t?"":"gradient")},n?r.a.createElement("a",{href:n},t):r.a.createElement(r.a.Fragment,null,t)),r.a.createElement("div",{className:"summary-desc"},a))}function $(){return r.a.createElement("img",{src:"https://filecoin.io/images/filecoin-logo.svg",class:"fil-logo"})}var ee=n(25),te=(ee.format(","),ee.format(",.0f")),ne=ee.format(",.3f"),ae=ee.format(",.1f");var re=Object(f.h)((function(e){var t=e.miners,n=e.client,i=e.actors,o=e.head,c=Object(a.useState)(),f=Object(l.a)(c,2),m=f[0],p=f[1],h=i&&n.computeEconomics(o,i,{projectedDays:1}),v=Object(a.useState)({}),b=Object(l.a)(v,2),g=b[0],w=b[1];Object(a.useEffect)((function(){o&&function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.Height-2880,e.next=3,n.fetchTipsetHead(t);case 3:return a=e.sent,e.next=6,n.fetchGenesisActors(a);case 6:r=e.sent,p(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[n,o]),Object(a.useEffect)((function(){w(t||{})}),[t]);var y=0;return Object(a.useEffect)((function(){if(n&&o&&t&&i){if(g){console.log("reload miners list",y++);var e=!0,a=function(t){e&&w(t)};return Object.keys(g).forEach((function(e){n.updateMinerInfo(g,e,a,o,{deadlines:!1})})),function(){e=!1}}w({})}}),[n,o,t,i]),r.a.createElement("section",{id:"home",className:"container"},r.a.createElement("div",{className:"section"},r.a.createElement("div",{class:"search-bar"},r.a.createElement("input",{type:"text",placeholder:"look up a miner address",onKeyDown:function(e){"Enter"===e.key&&(window.location.href="/#/address/".concat(e.target.value))}}))),r.a.createElement("div",{id:"actors",className:"section"},r.a.createElement("h3",null,"Tokens"),r.a.createElement("div",{className:"grid"},r.a.createElement(J,{title:i&&r.a.createElement(r.a.Fragment,null,te(+i.Supply/1e18||0),r.a.createElement($,null)),desc:"Circulating Supply"}),r.a.createElement(J,{title:i&&m&&r.a.createElement(r.a.Fragment,null,"+",te((+i.Supply-+m.Supply)/1e18||0),r.a.createElement($,null)),desc:"24h new liquidity"}))),r.a.createElement("div",{id:"actors2",className:"section"},r.a.createElement("h3",null,"Power"),r.a.createElement("div",{className:"grid"},r.a.createElement(J,{title:i&&"".concat(ae(+i.Power.State.TotalBytesCommitted/Math.pow(2,50)||0)," PiB"),desc:"Network Raw"}),r.a.createElement(J,{desc:"Active Miners",title:i&&"".concat(te(+i.Power.State.MinerAboveMinPowerCount||0))}))),r.a.createElement("div",{id:"economics",className:"section"},r.a.createElement("h3",null,"Economics"),r.a.createElement("div",{className:"grid"},r.a.createElement(J,{title:h&&r.a.createElement(r.a.Fragment,null,ne(h.sectorIp||0),r.a.createElement($,null)),desc:"Sector Pledge"}),r.a.createElement(J,{title:h&&r.a.createElement(r.a.Fragment,null,ne(h.sectorProjectedReward||0),r.a.createElement($,null)),desc:"Sector 360-Days Reward"}),r.a.createElement(J,{desc:"Sector Fault Fee",title:h&&r.a.createElement(r.a.Fragment,null,ne(h.sectorFaultFee||0),r.a.createElement($,null))})),r.a.createElement("div",{class:"grid"},r.a.createElement(J,{title:i&&r.a.createElement(r.a.Fragment,null,ne(+i.Reward.State.ThisEpochReward/5/1e18||0),r.a.createElement($,null)),desc:"Block Reward"}),r.a.createElement(J,{title:h&&r.a.createElement(r.a.Fragment,null,ne(1024*+h.sectorProjectedReward1/32),r.a.createElement($,null)),desc:"1-day FIL/TiB Reward"})),"These numbers are approximate projections based on the current network state and may be incorrect, do your own research."),r.a.createElement("div",{className:"section"},r.a.createElement("h3",null,"Gas"),"See ",r.a.createElement(d.b,{to:"/gas"}," Gas ")," for a detailed gas analysis."),r.a.createElement("div",{className:"section"},r.a.createElement("h3",null,"Market"),"See ",r.a.createElement(d.b,{to:"/market"}," Market "),"."),r.a.createElement("div",{className:"section"},r.a.createElement("h3",null,"Top miners"),r.a.createElement("div",null,"See deadlines of ",r.a.createElement(d.b,{to:"/full"},"top 50 miners")," or click on individual miners or the ",r.a.createElement(d.b,{to:"/status"},"network status"),".")),r.a.createElement("div",{className:"spacerace card section"},r.a.createElement("div",{className:"card-body"},r.a.createElement("table",{className:"table table-sm space table-borderless"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"#"),r.a.createElement("th",{scope:"col"},"Miner"),r.a.createElement("th",{scope:"col"},"Power"),r.a.createElement("th",{scope:"col"},"PreCommits"),r.a.createElement("th",{scope:"col"},"Available Balance"))),r.a.createElement("tbody",null,g&&t&&Object.keys(t).map((function(e,n){return r.a.createElement("tr",{key:n},r.a.createElement("th",{scope:"row"},n+1),r.a.createElement("td",{align:"right",className:"minerAddress"},r.a.createElement(d.b,{to:"/miners/".concat(t[e].address)},t&&t[e]&&t[e].address)),r.a.createElement("td",{align:"right"},ae(g[e]&&+g[e].rawBytePower/Math.pow(2,50))," ","PiB"),r.a.createElement("td",{align:"right"},g[e]&&g[e].preCommits?g[e].preCommits.Count:r.a.createElement("div",{className:"gradient"})),r.a.createElement("td",{align:"right"},g[e]&&g[e].deposits?"".concat(g[e].deposits.Available," FIL"):r.a.createElement("div",{className:"gradient"})))})))))))})),ie=n(78),oe=n(5);function ce(){var e=Object(oe.a)(["# regl-camera"]);return ce=function(){return e},e}function se(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(ce())})),n.variable(t("createReglCamera")).define("createReglCamera",["self","require"],(function(e,t){var n={},a={},r={};return function(t){"object"===typeof a&&"undefined"!==typeof r?r.exports=t():("undefined"!==typeof window?window:"undefined"!==typeof n?n:"undefined"!==typeof e?e:this).createREGLCamera=t()}((function(){return function e(n,a,r){function i(c,s){if(!a[c]){if(!n[c]){var u="function"==typeof t&&t;if(!s&&u)return u(c,!0);if(o)return o(c,!0);var l=new Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l}var d=a[c]={exports:{}};n[c][0].call(d.exports,(function(e){return i(n[c][1][e]||e)}),d,d.exports,e,n,a,r)}return a[c].exports}for(var o="function"==typeof t&&t,c=0;c<r.length;c++)i(r[c]);return i}({1:[function(e,t,n){t.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],2:[function(e,t,n){t.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],3:[function(e,t,n){t.exports=function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],c=t[5],s=t[6],u=t[7],l=t[8],d=t[9],f=t[10],m=t[11],p=t[12],h=t[13],v=t[14],b=t[15],g=n*c-a*o,w=n*s-r*o,y=n*u-i*o,E=a*s-r*c,x=a*u-i*c,j=r*u-i*s,O=l*h-d*p,k=l*v-f*p,S=l*b-m*p,M=d*v-f*h,N=d*b-m*h,T=f*b-m*v,P=g*T-w*N+y*M+E*S-x*k+j*O;if(!P)return null;return P=1/P,e[0]=(c*T-s*N+u*M)*P,e[1]=(r*N-a*T-i*M)*P,e[2]=(h*j-v*x+b*E)*P,e[3]=(f*x-d*j-m*E)*P,e[4]=(s*S-o*T-u*k)*P,e[5]=(n*T-r*S+i*k)*P,e[6]=(v*y-p*j-b*w)*P,e[7]=(l*j-f*y+m*w)*P,e[8]=(o*N-c*S+u*O)*P,e[9]=(a*S-n*N-i*O)*P,e[10]=(p*x-h*y+b*g)*P,e[11]=(d*y-l*x-m*g)*P,e[12]=(c*k-o*M-s*O)*P,e[13]=(n*M-a*k+r*O)*P,e[14]=(h*w-p*E-v*g)*P,e[15]=(l*E-d*w+f*g)*P,e}},{}],4:[function(e,t,n){var a=e("./identity");t.exports=function(e,t,n,r){var i,o,c,s,u,l,d,f,m,p,h=t[0],v=t[1],b=t[2],g=r[0],w=r[1],y=r[2],E=n[0],x=n[1],j=n[2];if(Math.abs(h-E)<1e-6&&Math.abs(v-x)<1e-6&&Math.abs(b-j)<1e-6)return a(e);d=h-E,f=v-x,m=b-j,p=1/Math.sqrt(d*d+f*f+m*m),i=w*(m*=p)-y*(f*=p),o=y*(d*=p)-g*m,c=g*f-w*d,(p=Math.sqrt(i*i+o*o+c*c))?(i*=p=1/p,o*=p,c*=p):(i=0,o=0,c=0);s=f*c-m*o,u=m*i-d*c,l=d*o-f*i,(p=Math.sqrt(s*s+u*u+l*l))?(s*=p=1/p,u*=p,l*=p):(s=0,u=0,l=0);return e[0]=i,e[1]=s,e[2]=d,e[3]=0,e[4]=o,e[5]=u,e[6]=f,e[7]=0,e[8]=c,e[9]=l,e[10]=m,e[11]=0,e[12]=-(i*h+o*v+c*b),e[13]=-(s*h+u*v+l*b),e[14]=-(d*h+f*v+m*b),e[15]=1,e}},{"./identity":2}],5:[function(e,t,n){t.exports=function(e,t,n){var a=t[0],r=t[1],i=t[2],o=t[3],c=t[4],s=t[5],u=t[6],l=t[7],d=t[8],f=t[9],m=t[10],p=t[11],h=t[12],v=t[13],b=t[14],g=t[15],w=n[0],y=n[1],E=n[2],x=n[3];return e[0]=w*a+y*c+E*d+x*h,e[1]=w*r+y*s+E*f+x*v,e[2]=w*i+y*u+E*m+x*b,e[3]=w*o+y*l+E*p+x*g,w=n[4],y=n[5],E=n[6],x=n[7],e[4]=w*a+y*c+E*d+x*h,e[5]=w*r+y*s+E*f+x*v,e[6]=w*i+y*u+E*m+x*b,e[7]=w*o+y*l+E*p+x*g,w=n[8],y=n[9],E=n[10],x=n[11],e[8]=w*a+y*c+E*d+x*h,e[9]=w*r+y*s+E*f+x*v,e[10]=w*i+y*u+E*m+x*b,e[11]=w*o+y*l+E*p+x*g,w=n[12],y=n[13],E=n[14],x=n[15],e[12]=w*a+y*c+E*d+x*h,e[13]=w*r+y*s+E*f+x*v,e[14]=w*i+y*u+E*m+x*b,e[15]=w*o+y*l+E*p+x*g,e}},{}],6:[function(e,t,n){t.exports=function(e,t,n,a,r){var i=1/Math.tan(t/2),o=1/(a-r);return e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+a)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*a*o,e[15]=0,e}},{}],7:[function(e,t,n){t.exports=function(e,t,n){var a=n[0],r=n[1],i=n[2];return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],8:[function(e,t,n){t.exports=function(e,t,n){var a,r,i,o,c,s,u,l,d,f,m,p,h=n[0],v=n[1],b=n[2];t===e?(e[12]=t[0]*h+t[4]*v+t[8]*b+t[12],e[13]=t[1]*h+t[5]*v+t[9]*b+t[13],e[14]=t[2]*h+t[6]*v+t[10]*b+t[14],e[15]=t[3]*h+t[7]*v+t[11]*b+t[15]):(a=t[0],r=t[1],i=t[2],o=t[3],c=t[4],s=t[5],u=t[6],l=t[7],d=t[8],f=t[9],m=t[10],p=t[11],e[0]=a,e[1]=r,e[2]=i,e[3]=o,e[4]=c,e[5]=s,e[6]=u,e[7]=l,e[8]=d,e[9]=f,e[10]=m,e[11]=p,e[12]=a*h+c*v+d*b+t[12],e[13]=r*h+s*v+f*b+t[13],e[14]=i*h+u*v+m*b+t[14],e[15]=o*h+l*v+p*b+t[15]);return e}},{}],9:[function(e,t,n){t.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},{}],10:[function(e,t,n){t.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],11:[function(e,t,n){t.exports=1e-6},{}],12:[function(e,t,n){t.exports=function(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],c=t[1],s=t[2];return Math.abs(n-o)<=a*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-c)<=a*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-s)<=a*Math.max(1,Math.abs(i),Math.abs(s))};var a=e("./epsilon")},{"./epsilon":11}],13:[function(e,t,n){t.exports=function(e,t){var n=t[0],a=t[1],r=t[2],i=n*n+a*a+r*r;i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i);return e}},{}],14:[function(e,t,n){t.exports=function(e,t,n,a){var r=n[1],i=n[2],o=t[1]-r,c=t[2]-i,s=Math.sin(a),u=Math.cos(a);return e[0]=t[0],e[1]=r+o*u-c*s,e[2]=i+o*s+c*u,e}},{}],15:[function(e,t,n){t.exports=function(e,t,n,a){var r=n[0],i=n[2],o=t[0]-r,c=t[2]-i,s=Math.sin(a),u=Math.cos(a);return e[0]=r+c*s+o*u,e[1]=t[1],e[2]=i+c*u-o*s,e}},{}],16:[function(e,t,n){t.exports=function(e,t,n,a){return e[0]=t[0]+n[0]*a,e[1]=t[1]+n[1]*a,e[2]=t[2]+n[2]*a,e}},{}],17:[function(e,t,n){t.exports=function(e,t,n){var a=t[0],r=t[1],i=t[2],o=n[3]*a+n[7]*r+n[11]*i+n[15];return o=o||1,e[0]=(n[0]*a+n[4]*r+n[8]*i+n[12])/o,e[1]=(n[1]*a+n[5]*r+n[9]*i+n[13])/o,e[2]=(n[2]*a+n[6]*r+n[10]*i+n[14])/o,e}},{}],18:[function(e,t,n){var a=e("gl-vec3/transformMat4"),r=e("gl-vec3/rotateY"),i=e("gl-vec3/rotateX"),o=e("gl-vec3/equals"),c=e("gl-vec3/add"),s=e("gl-vec3/scaleAndAdd"),u=e("gl-vec3/copy"),l=e("gl-vec3/normalize"),d=e("gl-mat4/identity"),f=e("gl-mat4/invert"),m=e("gl-mat4/translate"),p=e("gl-mat4/scale"),h=e("gl-mat4/lookAt"),v=e("gl-mat4/perspective"),b=.5*Math.PI-1e-4,g=.5*-Math.PI+1e-4;t.exports=function(e){var t=!0,n={aspectRatio:(e=e||{}).aspectRatio?e.aspectRatio:1,zoomAboutCursor:void 0===e.zoomAboutCursor||e.zoomAboutCursor,distance:void 0===e.distance?10:e.distance,phi:void 0===e.phi?0:e.phi,theta:void 0===e.theta?0:e.theta,fovY:void 0===e.fovY?Math.PI/4:e.fovY,near:void 0===e.near?.1:e.near,far:void 0===e.far?100:e.far,panDecayTime:e.panDecayTime||100,zoomDecayTime:e.zoomDecayTime||100,rotationDecayTime:e.rotationDecayTime||100,dirty:!0,up:e.up||new Float32Array([0,1,0]),center:e.center||new Float32Array(3),rotationCenter:e.rotationCenter||e.center&&e.center.slice()||new Float32Array(3),zoom:0,panX:0,panY:0,panZ:0,pitch:0,yaw:0,dTheta:0,dPhi:0,mouseX:0,mouseY:0},w=null,y={tick:function(e){if(L.zoom&&(n.zoom=L.zoom),L.dTheta&&(n.dTheta=L.dTheta),L.dPhi&&(n.dPhi=L.dPhi),L.panX&&(n.panX=L.panX),L.panY&&(n.panY=L.panY),L.panZ&&(n.panZ=L.panZ),L.yaw&&(n.yaw=L.yaw),L.pitch&&(n.pitch=L.pitch),C(L),e){var a=n.dPhi,r=n.dTheta,i=n.zoom,c=n.panX,s=n.panY,u=n.panZ,l=n.pitch,d=n.yaw;Object.assign(n,e),void 0!==e.dPhi&&(n.dPhi+=a),void 0!==e.dTheta&&(n.dTheta+=r),void 0!==e.zoom&&(n.zoom+=i),void 0!==e.panX&&(n.panX+=c),void 0!==e.panY&&(n.panY+=s),void 0!==e.panZ&&(n.panZ+=u),void 0!==e.pitch&&(n.pitch+=l),void 0!==e.yaw&&(n.yaw+=d)}o(n.up,M.up)&&o(n.center,M.center)&&n.near===M.near&&n.far===M.far&&n.phi===M.phi&&n.theta===M.theta&&n.distance===M.distance&&n.fovY===M.fovY||(T.dPhi=n.phi-M.phi,T.dTheta=n.theta-M.theta,T.zoom=n.distance/M.distance-1,n.theta=M.theta,n.distance=M.distance,n.phi=M.phi,T.yaw=0,T.pitch=0,T.panX=0,T.panY=0,T.panZ=0,T.mouseX=0,T.mouseY=0,A(T)),!function(){if(Math.abs(n.zoom)>1e-4)return!0;if(Math.abs(n.panX)>1e-4)return!0;if(Math.abs(n.panY)>1e-4)return!0;if(Math.abs(n.panZ)>1e-4)return!0;if(Math.abs(n.dTheta)>1e-4)return!0;if(Math.abs(n.dPhi)>1e-4)return!0;if(Math.abs(n.yaw)>1e-4)return!0;if(Math.abs(n.pitch)>1e-4)return!0}()?C(n):A(n);var f=Date.now();null!==w&&function(e){var t=n.panDecayTime?Math.exp(-e/n.panDecayTime/Math.LN2):0,a=n.zoomDecayTime?Math.exp(-e/n.zoomDecayTime/Math.LN2):0,r=n.rotationDecayTime?Math.exp(-e/n.rotationDecayTime/Math.LN2):0;n.zoom*=a,n.panX*=t,n.panY*=t,n.panZ*=t,n.dTheta*=r,n.dPhi*=r,n.yaw*=r,n.pitch*=r}(f-w),w=f,y.state.dirty=t,t=!1,N()},taint:R,resize:I,params:n,rotate:function(e,t){L.dTheta+=e,L.dPhi+=t},pivot:function(e,t){var a=y.params.fovY;L.yaw+=e*a*n.aspectRatio,L.pitch+=t*a},pan:function(e,t){var a=y.params.distance*Math.tan(.5*y.params.fovY)*2;return L.panX+=e*n.aspectRatio*a,L.panY+=t*a,y},zoom:function(e,t,a){return L.zoom+=a,n.mouseX=e,n.mouseY=t,y},computeMatrices:P,state:{}};y.state.projection=new Float32Array(16),y.state.viewInv=new Float32Array(16),y.state.view=new Float32Array(16),y.state.width=null,y.state.height=null,y.state.eye=new Float32Array(3);var E=new Float32Array(3),x=new Float32Array(3),j=new Float32Array(3),O=new Float32Array(3),k=new Float32Array(3),S=new Float32Array(16),M={up:new Float32Array(3),center:new Float32Array(3)};function N(){u(M.up,n.up),u(M.center,n.center),M.near=n.near,M.far=n.far,M.distance=n.distance,M.phi=n.phi,M.theta=n.theta,M.fovY=n.fovY}N();var T={};function P(){y.state.eye[0]=0,y.state.eye[1]=0,y.state.eye[2]=n.distance,i(y.state.eye,y.state.eye,k,-n.phi),r(y.state.eye,y.state.eye,k,n.theta),c(y.state.eye,y.state.eye,n.center),h(y.state.view,y.state.eye,n.center,n.up),v(y.state.projection,n.fovY,y.params.aspectRatio,n.near,n.far),f(y.state.viewInv,y.state.view)}function R(){t=!0}function I(e){y.params.aspectRatio=e,P(),R()}function C(e){e.zoom=0,e.dTheta=0,e.dPhi=0,e.panX=0,e.panY=0,e.panZ=0,e.yaw=0,e.pitch=0}var L={};function A(e){var t;d(S),n.zoomAboutCursor&&(t=n.distance*Math.tan(.5*n.fovY),E[0]=e.mouseX*n.aspectRatio*t,E[1]=e.mouseY*t,E[2]=0,m(S,S,E)),E[0]=1+e.zoom,E[1]=1+e.zoom,E[2]=1,p(S,S,E),n.zoomAboutCursor&&(t=n.distance*Math.tan(.5*n.fovY),E[0]=-e.mouseX*n.aspectRatio*t,E[1]=-e.mouseY*t,E[2]=0,m(S,S,E)),S[12]-=.5*e.panX,S[13]-=.5*e.panY,a(n.center,n.center,y.state.view),a(n.center,n.center,S),a(n.center,n.center,y.state.viewInv),n.rotateAboutCenter&&u(n.rotationCenter,n.center),n.distance*=1+e.zoom;var o=n.phi;n.phi+=e.dPhi,n.phi=Math.min(b,Math.max(g,n.phi));var c=n.phi-o,f=n.theta;n.theta+=e.dTheta;var h=n.theta-f;if(r(n.center,n.center,n.rotationCenter,h-n.theta),i(n.center,n.center,n.rotationCenter,-c),r(n.center,n.center,n.rotationCenter,n.theta),0!==e.yaw||0!==e.pitch){j[0]=y.state.view[0],j[1]=y.state.view[4],j[2]=y.state.view[8],l(j,j),x[0]=y.state.view[1],x[1]=y.state.view[5],x[2]=y.state.view[9],l(x,x),O[0]=y.state.view[2],O[1]=y.state.view[6],O[2]=y.state.view[10],l(O,O);var v=Math.min(b,Math.max(g,n.phi+.5*e.pitch)),w=v-n.phi;s(n.center,n.center,j,-Math.sin(.5*e.yaw)*n.distance),s(n.center,n.center,x,-Math.sin(w)*n.distance),s(n.center,n.center,O,(2-Math.cos(.5*e.yaw)-Math.cos(w))*n.distance),n.phi=v,n.theta+=.5*e.yaw}P(),R()}return C(L),I(y.params.aspectRatio),y}},{"gl-mat4/identity":2,"gl-mat4/invert":3,"gl-mat4/lookAt":4,"gl-mat4/perspective":6,"gl-mat4/scale":7,"gl-mat4/translate":8,"gl-vec3/add":9,"gl-vec3/copy":10,"gl-vec3/equals":12,"gl-vec3/normalize":13,"gl-vec3/rotateX":14,"gl-vec3/rotateY":15,"gl-vec3/scaleAndAdd":16,"gl-vec3/transformMat4":17}],19:[function(e,t,n){var a=e("gl-mat4/create"),r=e("gl-mat4/multiply"),i=e("./inertial-turntable-camera");t.exports=function(e,t){var n=e._gl.canvas;function o(){return n.clientWidth/n.clientHeight}var c=i(Object.assign({},{aspectRatio:o()},t||{})),s=a(),u=e({context:{projection:function(){return c.state.projection},view:function(){return c.state.view},viewInv:function(){return c.state.viewInv},eye:function(){return c.state.eye}},uniforms:{uProjectionView:function(e){return r(s,e.projection,e.view)}}});function l(e,t){t||(t=e,e={}),c.tick(e),e.afterTick&&(e.afterTick(c.state,c.params),c.computeMatrices()),u((function(){t(c.state,c.params)}))}return l.taint=c.taint,l.resize=c.resize,l.tick=c.tick,l.setUniforms=u,l.computeMatrices=c.computeMatrices,l.rotate=c.rotate,l.pan=c.pan,l.pivot=c.pivot,l.zoom=c.zoom,Object.defineProperties(l,{state:{get:function(){return c.state},set:function(e){c.state=e}},params:{get:function(){return c.params},set:function(e){c.params=e}},element:{get:function(){return n}}}),window.addEventListener("resize",(function(){c.resize(o())}),!1),l}},{"./inertial-turntable-camera":18,"gl-mat4/create":1,"gl-mat4/multiply":5}]},{},[19])(19)})),r.exports})),n.variable(t("createInteractions")).define("createInteractions",["self","require"],(function(e,t){var n={},a={},r={};return function(t){"object"===typeof a&&"undefined"!==typeof r?r.exports=t():("undefined"!==typeof window?window:"undefined"!==typeof n?n:"undefined"!==typeof e?e:this).createInteractions=t()}((function(){return function e(n,a,r){function i(c,s){if(!a[c]){if(!n[c]){var u="function"==typeof t&&t;if(!s&&u)return u(c,!0);if(o)return o(c,!0);var l=new Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l}var d=a[c]={exports:{}};n[c][0].call(d.exports,(function(e){return i(n[c][1][e]||e)}),d,d.exports,e,n,a,r)}return a[c].exports}for(var o="function"==typeof t&&t,c=0;c<r.length;c++)i(r[c]);return i}({1:[function(e,t,n){var a=e("es5-ext/object/assign"),r=e("es5-ext/object/normalize-options"),i=e("es5-ext/object/is-callable"),o=e("es5-ext/string/#/contains");(t.exports=function(e,t){var n,i,c,s,u;return arguments.length<2||"string"!==typeof e?(s=t,t=e,e=null):s=arguments[2],null==e?(n=c=!0,i=!1):(n=o.call(e,"c"),i=o.call(e,"e"),c=o.call(e,"w")),u={value:t,configurable:n,enumerable:i,writable:c},s?a(r(s),u):u}).gs=function(e,t,n){var c,s,u,l;return"string"!==typeof e?(u=n,n=t,t=e,e=null):u=arguments[3],null==t?t=void 0:i(t)?null==n?n=void 0:i(n)||(u=n,n=void 0):(u=t,t=n=void 0),null==e?(c=!0,s=!1):(c=o.call(e,"c"),s=o.call(e,"e")),l={get:t,set:n,configurable:c,enumerable:s},u?a(r(u),l):l}},{"es5-ext/object/assign":3,"es5-ext/object/is-callable":6,"es5-ext/object/normalize-options":11,"es5-ext/string/#/contains":14}],2:[function(e,t,n){t.exports=function(){}},{}],3:[function(e,t,n){t.exports=e("./is-implemented")()?Object.assign:e("./shim")},{"./is-implemented":4,"./shim":5}],4:[function(e,t,n){t.exports=function(){var e,t=Object.assign;return"function"===typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},{}],5:[function(e,t,n){var a=e("../keys"),r=e("../valid-value"),i=Math.max;t.exports=function(e,t){var n,o,c,s=i(arguments.length,2);for(e=Object(r(e)),c=function(a){try{e[a]=t[a]}catch(r){n||(n=r)}},o=1;o<s;++o)a(t=arguments[o]).forEach(c);if(void 0!==n)throw n;return e}},{"../keys":8,"../valid-value":13}],6:[function(e,t,n){t.exports=function(e){return"function"===typeof e}},{}],7:[function(e,t,n){var a=e("../function/noop")();t.exports=function(e){return e!==a&&null!==e}},{"../function/noop":2}],8:[function(e,t,n){t.exports=e("./is-implemented")()?Object.keys:e("./shim")},{"./is-implemented":9,"./shim":10}],9:[function(e,t,n){t.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],10:[function(e,t,n){var a=e("../is-value"),r=Object.keys;t.exports=function(e){return r(a(e)?Object(e):e)}},{"../is-value":7}],11:[function(e,t,n){var a=e("./is-value"),r=Array.prototype.forEach,i=Object.create,o=function(e,t){var n;for(n in e)t[n]=e[n]};t.exports=function(e){var t=i(null);return r.call(arguments,(function(e){a(e)&&o(Object(e),t)})),t}},{"./is-value":7}],12:[function(e,t,n){t.exports=function(e){if("function"!==typeof e)throw new TypeError(e+" is not a function");return e}},{}],13:[function(e,t,n){var a=e("./is-value");t.exports=function(e){if(!a(e))throw new TypeError("Cannot use null or undefined");return e}},{"./is-value":7}],14:[function(e,t,n){t.exports=e("./is-implemented")()?String.prototype.contains:e("./shim")},{"./is-implemented":15,"./shim":16}],15:[function(e,t,n){var a="razdwatrzy";t.exports=function(){return"function"===typeof a.contains&&(!0===a.contains("dwa")&&!1===a.contains("foo"))}},{}],16:[function(e,t,n){var a=String.prototype.indexOf;t.exports=function(e){return a.call(this,e,arguments[1])>-1}},{}],17:[function(e,t,n){var a,r,i,o,c,s,u,l=e("d"),d=e("es5-ext/object/valid-callable"),f=Function.prototype.apply,m=Function.prototype.call,p=Object.create,h=Object.defineProperty,v=Object.defineProperties,b=Object.prototype.hasOwnProperty,g={configurable:!0,enumerable:!1,writable:!0};r=function(e,t){var n,r;return d(t),r=this,a.call(this,e,n=function(){i.call(r,e,n),f.call(t,this,arguments)}),n.__eeOnceListener__=t,this},c={on:a=function(e,t){var n;return d(t),b.call(this,"__ee__")?n=this.__ee__:(n=g.value=p(null),h(this,"__ee__",g),g.value=null),n[e]?"object"===typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:r,off:i=function(e,t){var n,a,r,i;if(d(t),!b.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"===typeof(a=n[e]))for(i=0;r=a[i];++i)r!==t&&r.__eeOnceListener__!==t||(2===a.length?n[e]=a[i?0:1]:a.splice(i,1));else a!==t&&a.__eeOnceListener__!==t||delete n[e];return this},emit:o=function(e){var t,n,a,r,i;if(b.call(this,"__ee__")&&(r=this.__ee__[e]))if("object"===typeof r){for(n=arguments.length,i=new Array(n-1),t=1;t<n;++t)i[t-1]=arguments[t];for(r=r.slice(),t=0;a=r[t];++t)f.call(a,this,i)}else switch(arguments.length){case 1:m.call(r,this);break;case 2:m.call(r,this,arguments[1]);break;case 3:m.call(r,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,i=new Array(n-1),t=1;t<n;++t)i[t-1]=arguments[t];f.call(r,this,i)}}},s={on:l(a),once:l(r),off:l(i),emit:l(o)},u=v({},s),t.exports=n=function(e){return null==e?p(u):v(Object(e),s)},n.methods=c},{d:1,"es5-ext/object/valid-callable":12}],18:[function(e,t,n){t.exports=function(e,t,n){var a=t[0],r=t[1],i=t[2],o=n[3]*a+n[7]*r+n[11]*i+n[15];return o=o||1,e[0]=(n[0]*a+n[4]*r+n[8]*i+n[12])/o,e[1]=(n[1]*a+n[5]*r+n[9]*i+n[13])/o,e[2]=(n[2]*a+n[6]*r+n[10]*i+n[14])/o,e}},{}],19:[function(e,t,n){t.exports=function(e,t){t||(t=e,e=window);var n=0,r=0,i=0,o={shift:!1,alt:!1,control:!1,meta:!1},c=!1;function s(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==o.alt,o.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==o.shift,o.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==o.control,o.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==o.meta,o.meta=!!e.metaKey),t}function u(e,c){var u=a.x(c),l=a.y(c);"buttons"in c&&(e=0|c.buttons),(e!==n||u!==r||l!==i||s(c))&&(n=0|e,r=u||0,i=l||0,t&&t(n,r,i,o))}function l(e){u(0,e)}function d(){(n||r||i||o.shift||o.alt||o.meta||o.control)&&(r=i=0,n=0,o.shift=o.alt=o.control=o.meta=!1,t&&t(0,0,0,o))}function f(e){s(e)&&t&&t(n,r,i,o)}function m(e){0===a.buttons(e)?u(0,e):u(n,e)}function p(e){u(n|a.buttons(e),e)}function h(e){u(n&~a.buttons(e),e)}function v(){c||(c=!0,e.addEventListener("mousemove",m),e.addEventListener("mousedown",p),e.addEventListener("mouseup",h),e.addEventListener("mouseleave",l),e.addEventListener("mouseenter",l),e.addEventListener("mouseout",l),e.addEventListener("mouseover",l),e!==window&&(window.addEventListener("blur",d),window.addEventListener("keyup",f),window.addEventListener("keydown",f),window.addEventListener("keypress",f)))}v();var b={element:e};return Object.defineProperties(b,{enabled:{get:function(){return c},set:function(t){t?v():function(){if(!c)return;c=!1,e.removeEventListener("mousemove",m),e.removeEventListener("mousedown",p),e.removeEventListener("mouseup",h),e.removeEventListener("mouseleave",l),e.removeEventListener("mouseenter",l),e.removeEventListener("mouseout",l),e.removeEventListener("mouseover",l),e!==window&&(window.removeEventListener("blur",d),window.removeEventListener("keyup",f),window.removeEventListener("keydown",f),window.removeEventListener("keypress",f))}()},enumerable:!0},buttons:{get:function(){return n},enumerable:!0},x:{get:function(){return r},enumerable:!0},y:{get:function(){return i},enumerable:!0},mods:{get:function(){return o},enumerable:!0}}),b};var a=e("mouse-event")},{"mouse-event":21}],20:[function(e,t,n){var a={left:0,top:0};t.exports=function(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var r=e.clientX||0,i=e.clientY||0,o=(c=t,c===window||c===document||c===document.body?a:c.getBoundingClientRect());var c;return n[0]=r-o.left,n[1]=i-o.top,n}},{}],21:[function(e,t,n){function a(e){return e.target||e.srcElement||window}n.buttons=function(e){if("object"===typeof e){if("buttons"in e)return e.buttons;if("which"in e){if(2===(t=e.which))return 4;if(3===t)return 2;if(t>0)return 1<<t-1}else if("button"in e){var t;if(1===(t=e.button))return 4;if(2===t)return 2;if(t>=0)return 1<<t}}return 0},n.element=a,n.x=function(e){if("object"===typeof e){if("offsetX"in e)return e.offsetX;var t=a(e).getBoundingClientRect();return e.clientX-t.left}return 0},n.y=function(e){if("object"===typeof e){if("offsetY"in e)return e.offsetY;var t=a(e).getBoundingClientRect();return e.clientY-t.top}return 0}},{}],22:[function(e,t,n){var a=e("gl-vec3/transformMat4"),r=e("./normalized-interaction-events");t.exports=function(e,t){t=t||{};var n=e.element,o=.5*(void 0===t.zoomSpeed?1:t.zoomSpeed),c=void 0===t.zoom||t.zoom,s=void 0!==t.touchZoom?!!t.touchZoom:void 0===t.zoom||!!t.zoom,u=null,l=null,d=null,f={defaultPrevented:!1};function m(){f.defaultPrevented=!1}function p(e){return e.defaultPrevented=f.defaultPrevented,e.preventDefault=function(){e.defaultPrevented=!0,f.defaultPrevented=!0},e}var h=[0,0,0],v=[0,0];return r(n).on("wheel",(function(t){c&&(t.originalEvent.preventDefault(),e.zoom(t.x0,t.y0,Math.exp(-t.dy*o)-1))})).on("mousedown",(function(e){m(),e=p(e),u&&u(e),e.originalEvent.preventDefault()})).on("mousemove",(function(t){if(t=p(t),d&&d(t),!t.defaultPrevented&&t.active&&1===t.buttons)if(t.mods.alt){if(!c)return;e.zoom(t.x0,t.y0,Math.exp(t.dy*o)-1),t.originalEvent.preventDefault()}else t.mods.shift?(e.pan(t.dx,t.dy),t.originalEvent.preventDefault()):t.mods.meta?(e.pivot(t.dx,t.dy),t.originalEvent.preventDefault()):(e.rotate(-t.dx*i,-t.dy*i),t.originalEvent.preventDefault())})).on("mouseup",(function(e){m(),e=p(e),l&&l(e)})).on("touchstart",(function(e){e.originalEvent.preventDefault(),e=p(e),u&&u(e)})).on("touchmove",(function(t){t=p(t),d&&d(t),t.defaultPrevented||t.active&&(e.rotate(-t.dx*i,-t.dy*i),t.originalEvent.preventDefault())})).on("touchend",(function(e){m(),e=p(e),l&&l(e)})).on("pinchmove",(function(n){n.active&&(!function(e){h[0]=e.x,h[1]=e.y,h[2]=0,t.invViewportShift&&a(h,h,t.invViewportShift);v[0]=h[0],v[1]=h[1]}(n),s&&e.zoom(v[0],v[1],1-n.zoomx),e.pan(n.dx,n.dy),n.originalEvent.preventDefault())})).on("pinchstart",(function(e){e.originalEvent.preventDefault()})),u=t.onStart,d=t.onMove,l=t.onEnd,{setInteractions:function(e){u=e.onStart,l=e.onEnd,d=e.onMove}}};var i=.75*Math.PI},{"./normalized-interaction-events":23,"gl-vec3/transformMat4":18}],23:[function(e,t,n){t.exports=function(e){e=e||window;var t,n,o,c,s=i(),u=[null,null],l=[null,null],d=[null,null],f=[null,null],m=0,p={},h=e===window?function(){t=window.innerWidth,n=window.innerHeight}:function(){t=e.clientWidth,n=e.clientHeight},v=0,b={},g=a(e,(function(e,t,n,a){o=t,c=n,v=e,b=a}));function w(a){r(a,e,d),h(),p.buttons=v,p.mods=b,p.x0=p.x=p.x1=2*d[0]/t-1,p.y0=p.y=p.y1=1-2*d[1]/n,p.x2=null,p.y2=null,p.dx=2*a.deltaX/t,p.dy=-2*a.deltaY/n,p.dz=2*a.deltaZ/t,p.active=1,p.zoomx=1,p.zoomy=1,p.theta=0,p.dtheta=0,p.originalEvent=a,s.emit("wheel",p),u[0]=d[0],u[1]=d[1]}var y=null,E=null,x=0;function j(a){r(a,e,d),x=0,h(),p.buttons=v,p.mods=b,p.x=p.x1=2*d[0]/t-1,p.y=p.y1=1-2*d[1]/n,p.x2=null,p.y2=null,p.active=x,p.x0=2*y/t-1,p.y0=1-2*E/n,p.dx=0,p.dy=0,p.dz=0,p.zoomx=1,p.zoomy=1,p.theta=0,p.dtheta=0,p.originalEvent=a,s.emit("mouseup",p),y=E=null,u[0]=d[0],u[1]=d[1]}function O(a){r(a,e,d),x=1,h(),y=o,E=c,p.buttons=v,p.mods=b,p.x=p.x0=p.x1=2*d[0]/t-1,p.y=p.y0=p.y1=1-2*d[1]/n,p.x2=null,p.y2=null,p.active=x,p.dx=0,p.dy=0,p.dz=0,p.zoomx=1,p.zoomy=1,p.theta=0,p.dtheta=0,p.originalEvent=a,s.emit("mousedown",p),u[0]=d[0],u[1]=d[1]}function k(a){r(a,e,d),h(),p.buttons=v,p.mods=b,p.x0=2*y/t-1,p.y0=1-2*E/n,p.x=p.x1=2*d[0]/t-1,p.y=p.y1=1-2*d[1]/n,p.x2=null,p.y2=null,p.dx=2*(d[0]-u[0])/t,p.dy=-2*(d[1]-u[1])/n,p.active=x,p.dz=0,p.zoomx=1,p.zoomy=1,p.theta=0,p.dtheta=0,p.originalEvent=a,s.emit("mousemove",p),u[0]=d[0],u[1]=d[1]}function S(e){for(var t=e.identifier,n=0;n<f.length;n++)if(f[n]&&f[n].touch&&f[n].touch.identifier===t)return n;return-1}function M(a){l[0]=null,l[1]=null;for(var i=0;i<a.changedTouches.length;i++){var o=a.changedTouches[i];if(-1===S(o.identifier)&&m<2){var c=f[0]?1:0,u=f[0]?0:1,d={position:[0,0],touch:null};f[c]=d,m++,d.touch=o,r(o,e,d.position);f[u]&&f[u].touch}}var v=0,b=0,g=0;for(i=0;i<f.length;i++)f[i]&&(v+=f[i].position[0],b+=f[i].position[1],g++);if(v/=g,b/=g,m>0){if(p.theta=0,g>1){var w=f[1].position[0]-f[0].position[0],x=(f[0].position[1]-f[1].position[1])*t/n;p.theta=Math.atan2(x,w)}h(),p.buttons=0,p.mods={},p.active=m,y=v,E=b,p.x0=2*y/t-1,p.y0=1-2*E/n,p.x=2*v/t-1,p.y=1-2*b/n,p.x1=2*f[0].position[0]/t-1,p.y1=1-2*f[0].position[1]/n,m>1&&(p.x2=2*f[1].position[0]/t-1,p.y2=1-2*f[1].position[1]/n),p.active=m,p.dx=0,p.dy=0,p.dz=0,p.zoomx=1,p.zoomy=1,p.dtheta=0,p.originalEvent=a,s.emit(1===m?"touchstart":"pinchstart",p)}}function N(a){for(var i,o=!1,c=0;c<a.changedTouches.length;c++){var u=a.changedTouches[c];-1!==(i=S(u))&&(o=!0,f[i].touch=u,r(u,e,f[i].position))}if(o)if(1===m){for(i=0;i<f.length&&!f[i];i++);if(f[i]&&l[i]){var d=f[i].position[0],h=f[i].position[1],v=d-l[i][0],g=h-l[i][1];p.buttons=0,p.mods={},p.active=m,p.x=p.x1=2*d/t-1,p.y=p.y1=1-2*h/n,p.x2=null,p.y2=null,p.x0=2*y/t-1,p.y0=1-2*E/n,p.dx=2*v/t,p.dy=-2*g/n,p.dz=0,p.zoomx=1,p.zoomy=1,p.theta=0,p.dtheta=0,p.originalEvent=a,s.emit("touchmove",p)}}else if(2===m&&l[0]&&l[1]){var w=l[0],x=l[1],j=x[0]-w[0],O=(x[1]-w[1])*t/n,k=f[0].position,M=f[1].position,N=M[0]-k[0],T=(k[1]-M[1])*t/n,P=.5*Math.sqrt(j*j+O*O),R=Math.atan2(O,j),I=.5*Math.sqrt(N*N+T*T),C=Math.atan2(T,N),L=.5*(x[0]+w[0]),A=.5*(x[1]+w[1]),_=(v=.5*(M[0]+k[0]-w[0]-x[0]),g=.5*(M[1]+k[1]-w[1]-x[1]),I/P),D=C-R;p.buttons=0,p.mods=b,p.active=m,p.x=2*L/t-1,p.y=1-2*A/n,p.x0=2*y/t-1,p.y0=1-2*E/n,p.x1=2*k[0]/t-1,p.y1=1-2*k[1]/n,p.x2=2*M[0]/t-1,p.y2=1-2*M[1]/n,p.dx=2*v/t,p.dy=-2*g/n,p.dz=0,p.zoomx=_,p.zoomy=_,p.theta=C,p.dtheta=D,p.originalEvent=a,s.emit("pinchmove",p)}f[0]&&(l[0]=f[0].position.slice()),f[1]&&(l[1]=f[1].position.slice())}function T(e){for(var a,r=0;r<e.changedTouches.length;r++){var i=S(e.changedTouches[r]);if(-1!==i){a=f[i],f[i]=null,m--;var o=0===i?1:0;f[o]&&f[o].touch}}var c=0,u=0;if(0===m)a&&(c=a.position[0],u=a.position[1]);else{var l=0;for(r=0;r<f.length;r++)f[r]&&(c+=f[r].position[0],u+=f[r].position[1],l++);c/=l,u/=l}m<2&&(p.buttons=0,p.mods=b,p.active=m,p.x=2*c/t-1,p.y=1-2*u/n,p.x0=2*y/t-1,p.y0=1-2*E/n,p.dx=0,p.dy=0,p.dz=0,p.zoomx=1,p.zoomy=1,p.theta=0,p.dtheta=0,p.originalEvent=e,s.emit(0===m?"touchend":"pinchend",p)),0===m&&(y=E=null)}var P=!1;function R(){P||(P=!0,g.enabled=!0,e.addEventListener("wheel",w,!1),e.addEventListener("mousedown",O,!1),window.addEventListener("mousemove",k,!1),window.addEventListener("mouseup",j,!1),e.addEventListener("touchstart",M,!1),window.addEventListener("touchmove",N,!1),window.addEventListener("touchend",T,!1),window.addEventListener("touchcancel",T,!1))}return R(),s.enable=R,s.disable=function(){if(!P)return;P=!1,g.enabled=!1,e.removeEventListener("wheel",w,!1),e.removeEventListener("mousedown",O,!1),window.removeEventListener("mousemove",k,!1),window.removeEventListener("mouseup",j,!1),e.removeEventListener("touchstart",M,!1),window.removeEventListener("touchmove",N,!1),window.removeEventListener("touchend",T,!1),window.removeEventListener("touchcancel",T,!1)},s};var a=e("mouse-change"),r=e("mouse-event-offset"),i=e("event-emitter")},{"event-emitter":17,"mouse-change":19,"mouse-event-offset":20}]},{},[22])(22)})),r.exports})),n}function ue(){var e=Object(oe.a)(["## Implementation"]);return ue=function(){return e},e}function le(){var e=Object(oe.a)(["\nor you may import single functions directly\n\n```js\nimport {mat4create} from '@rreusser/gl-mat4'\n```\n"],["\nor you may import single functions directly\n\n\\`\\`\\`js\nimport {mat4create} from '@rreusser/gl-mat4'\n\\`\\`\\`\n"]);return le=function(){return e},e}function de(){var e=Object(oe.a)(["## Usage\n\nThere are two basic ways to use this module. You may either import all functions\n\n```js\nimport {mat4} from '@rreusser/gl-mat4'\n```\n\nafter which you can use the functions like normal, e.g."],["## Usage\n\nThere are two basic ways to use this module. You may either import all functions\n\n\\`\\`\\`js\nimport {mat4} from '@rreusser/gl-mat4'\n\\`\\`\\`\n\nafter which you can use the functions like normal, e.g."]);return de=function(){return e},e}function fe(){var e=Object(oe.a)(["## License\n\nCopyright (c) 2013 Brandon Jones, Colin MacKenzie IV\n\nThis software is provided 'as-is', without any express or implied\nwarranty. In no event will the authors be held liable for any damages\narising from the use of this software.\n\nPermission is granted to anyone to use this software for any purpose,\nincluding commercial applications, and to alter it and redistribute it\nfreely, subject to the following restrictions:\n\n 1. The origin of this software must not be misrepresented you must not\n    claim that you wrote the original software. If you use this software\n    in a product, an acknowledgment in the product documentation would be\n    appreciated but is not required.\n\n 2. Altered source versions must be plainly marked as such, and must not\n    be misrepresented as being the original software.\n\n 3. This notice may not be removed or altered from any source distribution."]);return fe=function(){return e},e}function me(){var e=Object(oe.a)(["This notebook re-exports functions from [stackgl/gl-mat4](https://github.com/stackgl/gl-mat4). The license may be found [here](https://github.com/stackgl/gl-mat4/blob/master/LICENSE.md).\n\nAdditionally, it adds a function called `mat4fromMat3` to expand a 2d homogeneous transformation matrix to a 3d homogeneous transformation matrix."],["This notebook re-exports functions from [stackgl/gl-mat4](https://github.com/stackgl/gl-mat4). The license may be found [here](https://github.com/stackgl/gl-mat4/blob/master/LICENSE.md).\n\nAdditionally, it adds a function called \\`mat4fromMat3\\` to expand a 2d homogeneous transformation matrix to a 3d homogeneous transformation matrix."]);return me=function(){return e},e}function pe(){var e=Object(oe.a)(["# gl-mat4"]);return pe=function(){return e},e}function he(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(pe())})),n.variable(t()).define(["md"],(function(e){return e(me())})),n.variable(t()).define(["md"],(function(e){return e(fe())})),n.variable(t()).define(["md"],(function(e){return e(de())})),n.variable(t("a")).define("a",["mat4"],(function(e){return e.create()})),n.variable(t()).define(["md"],(function(e){return e(le())})),n.variable(t("b")).define("b",["mat4create"],(function(e){return e()})),n.variable(t()).define(["md"],(function(e){return e(ue())})),n.variable(t("mat4")).define("mat4",["mat4create","mat4clone","mat4copy","mat4identity","mat4transpose","mat4invert","mat4adjoint","mat4determinant","mat4multiply","mat4translate","mat4scale","mat4rotate","mat4rotateX","mat4rotateY","mat4rotateZ","mat4fromMat3","mat4fromRotation","mat4fromRotationTranslation","mat4fromScaling","mat4fromTranslation","mat4fromXRotation","mat4fromYRotation","mat4fromZRotation","mat4fromQuat","mat4frustum","mat4perspective","mat4perspectiveFromFieldOfView","mat4ortho","mat4lookAt","mat4str"],(function(e,t,n,a,r,i,o,c,s,u,l,d,f,m,p,h,v,b,g,w,y,E,x,j,O,k,S,M,N,T){return{create:e,clone:t,copy:n,identity:a,transpose:r,invert:i,adjoint:o,determinant:c,multiply:s,translate:u,scale:l,rotate:d,rotateX:f,rotateY:m,rotateZ:p,fromMat3:h,fromRotation:v,fromRotationTranslation:b,fromScaling:g,fromTranslation:w,fromXRotation:y,fromYRotation:E,fromZRotation:x,fromQuat:j,frustum:O,perspective:k,perspectiveFromFieldOfView:S,ortho:M,lookAt:N,str:T}})),n.variable(t("mat4adjoint")).define("mat4adjoint",(function(){return function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],c=t[5],s=t[6],u=t[7],l=t[8],d=t[9],f=t[10],m=t[11],p=t[12],h=t[13],v=t[14],b=t[15];return e[0]=c*(f*b-m*v)-d*(s*b-u*v)+h*(s*m-u*f),e[1]=-(a*(f*b-m*v)-d*(r*b-i*v)+h*(r*m-i*f)),e[2]=a*(s*b-u*v)-c*(r*b-i*v)+h*(r*u-i*s),e[3]=-(a*(s*m-u*f)-c*(r*m-i*f)+d*(r*u-i*s)),e[4]=-(o*(f*b-m*v)-l*(s*b-u*v)+p*(s*m-u*f)),e[5]=n*(f*b-m*v)-l*(r*b-i*v)+p*(r*m-i*f),e[6]=-(n*(s*b-u*v)-o*(r*b-i*v)+p*(r*u-i*s)),e[7]=n*(s*m-u*f)-o*(r*m-i*f)+l*(r*u-i*s),e[8]=o*(d*b-m*h)-l*(c*b-u*h)+p*(c*m-u*d),e[9]=-(n*(d*b-m*h)-l*(a*b-i*h)+p*(a*m-i*d)),e[10]=n*(c*b-u*h)-o*(a*b-i*h)+p*(a*u-i*c),e[11]=-(n*(c*m-u*d)-o*(a*m-i*d)+l*(a*u-i*c)),e[12]=-(o*(d*v-f*h)-l*(c*v-s*h)+p*(c*f-s*d)),e[13]=n*(d*v-f*h)-l*(a*v-r*h)+p*(a*f-r*d),e[14]=-(n*(c*v-s*h)-o*(a*v-r*h)+p*(a*s-r*c)),e[15]=n*(c*f-s*d)-o*(a*f-r*d)+l*(a*s-r*c),e}})),n.variable(t("mat4clone")).define("mat4clone",(function(){return function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}})),n.variable(t("mat4copy")).define("mat4copy",(function(){return function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}})),n.variable(t("mat4create")).define("mat4create",(function(){return function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}})),n.variable(t("mat4determinant")).define("mat4determinant",(function(){return function(e){var t=e[0],n=e[1],a=e[2],r=e[3],i=e[4],o=e[5],c=e[6],s=e[7],u=e[8],l=e[9],d=e[10],f=e[11],m=e[12],p=e[13],h=e[14],v=e[15];return(t*o-n*i)*(d*v-f*h)-(t*c-a*i)*(l*v-f*p)+(t*s-r*i)*(l*h-d*p)+(n*c-a*o)*(u*v-f*m)-(n*s-r*o)*(u*h-d*m)+(a*s-r*c)*(u*p-l*m)}})),n.variable(t("mat4fromQuat")).define("mat4fromQuat",(function(){return function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=n+n,c=a+a,s=r+r,u=n*o,l=a*o,d=a*c,f=r*o,m=r*c,p=r*s,h=i*o,v=i*c,b=i*s;return e[0]=1-d-p,e[1]=l+b,e[2]=f-v,e[3]=0,e[4]=l-b,e[5]=1-u-p,e[6]=m+h,e[7]=0,e[8]=f+v,e[9]=m-h,e[10]=1-u-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}})),n.variable(t("mat4fromRotation")).define("mat4fromRotation",(function(){return function(e,t,n){var a,r,i,o=n[0],c=n[1],s=n[2],u=Math.sqrt(o*o+c*c+s*s);return Math.abs(u)<1e-6?null:(o*=u=1/u,c*=u,s*=u,a=Math.sin(t),i=1-(r=Math.cos(t)),e[0]=o*o*i+r,e[1]=c*o*i+s*a,e[2]=s*o*i-c*a,e[3]=0,e[4]=o*c*i-s*a,e[5]=c*c*i+r,e[6]=s*c*i+o*a,e[7]=0,e[8]=o*s*i+c*a,e[9]=c*s*i-o*a,e[10]=s*s*i+r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}})),n.variable(t("mat4fromMat3")).define("mat4fromMat3",(function(){return function(e,t){e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=t[4],e[6]=0,e[7]=t[5],e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[6],e[13]=t[7],e[14]=0,e[15]=t[8]}})),n.variable(t("mat4fromRotationTranslation")).define("mat4fromRotationTranslation",(function(){return function(e,t,n){var a=t[0],r=t[1],i=t[2],o=t[3],c=a+a,s=r+r,u=i+i,l=a*c,d=a*s,f=a*u,m=r*s,p=r*u,h=i*u,v=o*c,b=o*s,g=o*u;return e[0]=1-(m+h),e[1]=d+g,e[2]=f-b,e[3]=0,e[4]=d-g,e[5]=1-(l+h),e[6]=p+v,e[7]=0,e[8]=f+b,e[9]=p-v,e[10]=1-(l+m),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}})),n.variable(t("mat4fromScaling")).define("mat4fromScaling",(function(){return function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}})),n.variable(t("mat4fromTranslation")).define("mat4fromTranslation",(function(){return function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}})),n.variable(t("mat4fromXRotation")).define("mat4fromXRotation",(function(){return function(e,t){var n=Math.sin(t),a=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}})),n.variable(t("mat4fromYRotation")).define("mat4fromYRotation",(function(){return function(e,t){var n=Math.sin(t),a=Math.cos(t);return e[0]=a,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}})),n.variable(t("mat4fromZRotation")).define("mat4fromZRotation",(function(){return function(e,t){var n=Math.sin(t),a=Math.cos(t);return e[0]=a,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}})),n.variable(t("mat4frustum")).define("mat4frustum",(function(){return function(e,t,n,a,r,i,o){var c=1/(n-t),s=1/(r-a),u=1/(i-o);return e[0]=2*i*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*s,e[6]=0,e[7]=0,e[8]=(n+t)*c,e[9]=(r+a)*s,e[10]=(o+i)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*u,e[15]=0,e}})),n.variable(t("mat4identity")).define("mat4identity",(function(){return function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}})),n.variable(t("mat4invert")).define("mat4invert",(function(){return function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],c=t[5],s=t[6],u=t[7],l=t[8],d=t[9],f=t[10],m=t[11],p=t[12],h=t[13],v=t[14],b=t[15],g=n*c-a*o,w=n*s-r*o,y=n*u-i*o,E=a*s-r*c,x=a*u-i*c,j=r*u-i*s,O=l*h-d*p,k=l*v-f*p,S=l*b-m*p,M=d*v-f*h,N=d*b-m*h,T=f*b-m*v,P=g*T-w*N+y*M+E*S-x*k+j*O;return P?(P=1/P,e[0]=(c*T-s*N+u*M)*P,e[1]=(r*N-a*T-i*M)*P,e[2]=(h*j-v*x+b*E)*P,e[3]=(f*x-d*j-m*E)*P,e[4]=(s*S-o*T-u*k)*P,e[5]=(n*T-r*S+i*k)*P,e[6]=(v*y-p*j-b*w)*P,e[7]=(l*j-f*y+m*w)*P,e[8]=(o*N-c*S+u*O)*P,e[9]=(a*S-n*N-i*O)*P,e[10]=(p*x-h*y+b*g)*P,e[11]=(d*y-l*x-m*g)*P,e[12]=(c*k-o*M-s*O)*P,e[13]=(n*M-a*k+r*O)*P,e[14]=(h*w-p*E-v*g)*P,e[15]=(l*E-d*w+f*g)*P,e):null}})),n.variable(t("mat4lookAt")).define("mat4lookAt",["mat4identity"],(function(e){return function(t,n,a,r){var i,o,c,s,u,l,d,f,m,p,h=n[0],v=n[1],b=n[2],g=r[0],w=r[1],y=r[2],E=a[0],x=a[1],j=a[2];return Math.abs(h-E)<1e-6&&Math.abs(v-x)<1e-6&&Math.abs(b-j)<1e-6?e(t):(d=h-E,f=v-x,m=b-j,i=w*(m*=p=1/Math.sqrt(d*d+f*f+m*m))-y*(f*=p),o=y*(d*=p)-g*m,c=g*f-w*d,(p=Math.sqrt(i*i+o*o+c*c))?(i*=p=1/p,o*=p,c*=p):(i=0,o=0,c=0),s=f*c-m*o,u=m*i-d*c,l=d*o-f*i,(p=Math.sqrt(s*s+u*u+l*l))?(s*=p=1/p,u*=p,l*=p):(s=0,u=0,l=0),t[0]=i,t[1]=s,t[2]=d,t[3]=0,t[4]=o,t[5]=u,t[6]=f,t[7]=0,t[8]=c,t[9]=l,t[10]=m,t[11]=0,t[12]=-(i*h+o*v+c*b),t[13]=-(s*h+u*v+l*b),t[14]=-(d*h+f*v+m*b),t[15]=1,t)}})),n.variable(t("mat4multiply")).define("mat4multiply",(function(){return function(e,t,n){var a=t[0],r=t[1],i=t[2],o=t[3],c=t[4],s=t[5],u=t[6],l=t[7],d=t[8],f=t[9],m=t[10],p=t[11],h=t[12],v=t[13],b=t[14],g=t[15],w=n[0],y=n[1],E=n[2],x=n[3];return e[0]=w*a+y*c+E*d+x*h,e[1]=w*r+y*s+E*f+x*v,e[2]=w*i+y*u+E*m+x*b,e[3]=w*o+y*l+E*p+x*g,w=n[4],y=n[5],E=n[6],x=n[7],e[4]=w*a+y*c+E*d+x*h,e[5]=w*r+y*s+E*f+x*v,e[6]=w*i+y*u+E*m+x*b,e[7]=w*o+y*l+E*p+x*g,w=n[8],y=n[9],E=n[10],x=n[11],e[8]=w*a+y*c+E*d+x*h,e[9]=w*r+y*s+E*f+x*v,e[10]=w*i+y*u+E*m+x*b,e[11]=w*o+y*l+E*p+x*g,w=n[12],y=n[13],E=n[14],x=n[15],e[12]=w*a+y*c+E*d+x*h,e[13]=w*r+y*s+E*f+x*v,e[14]=w*i+y*u+E*m+x*b,e[15]=w*o+y*l+E*p+x*g,e}})),n.variable(t("mat4ortho")).define("mat4ortho",(function(){return function(e,t,n,a,r,i,o){var c=1/(t-n),s=1/(a-r),u=1/(i-o);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*c,e[13]=(r+a)*s,e[14]=(o+i)*u,e[15]=1,e}})),n.variable(t("mat4perspective")).define("mat4perspective",(function(){return function(e,t,n,a,r){var i=1/Math.tan(t/2),o=1/(a-r);return e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+a)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*a*o,e[15]=0,e}})),n.variable(t("mat4perspectiveFromFieldOfView")).define("mat4perspectiveFromFieldOfView",(function(){return function(e,t,n,a){var r=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),c=Math.tan(t.rightDegrees*Math.PI/180),s=2/(o+c),u=2/(r+i);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(o-c)*s*.5,e[9]=(r-i)*u*.5,e[10]=a/(n-a),e[11]=-1,e[12]=0,e[13]=0,e[14]=a*n/(n-a),e[15]=0,e}})),n.variable(t("mat4rotate")).define("mat4rotate",(function(){return function(e,t,n,a){var r,i,o,c,s,u,l,d,f,m,p,h,v,b,g,w,y,E,x,j,O,k,S,M,N=a[0],T=a[1],P=a[2],R=Math.sqrt(N*N+T*T+P*P);return Math.abs(R)<1e-6?null:(N*=R=1/R,T*=R,P*=R,r=Math.sin(n),o=1-(i=Math.cos(n)),c=t[0],s=t[1],u=t[2],l=t[3],d=t[4],f=t[5],m=t[6],p=t[7],h=t[8],v=t[9],b=t[10],g=t[11],w=N*N*o+i,y=T*N*o+P*r,E=P*N*o-T*r,x=N*T*o-P*r,j=T*T*o+i,O=P*T*o+N*r,k=N*P*o+T*r,S=T*P*o-N*r,M=P*P*o+i,e[0]=c*w+d*y+h*E,e[1]=s*w+f*y+v*E,e[2]=u*w+m*y+b*E,e[3]=l*w+p*y+g*E,e[4]=c*x+d*j+h*O,e[5]=s*x+f*j+v*O,e[6]=u*x+m*j+b*O,e[7]=l*x+p*j+g*O,e[8]=c*k+d*S+h*M,e[9]=s*k+f*S+v*M,e[10]=u*k+m*S+b*M,e[11]=l*k+p*S+g*M,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}})),n.variable(t("mat4rotateX")).define("mat4rotateX",(function(){return function(e,t,n){var a=Math.sin(n),r=Math.cos(n),i=t[4],o=t[5],c=t[6],s=t[7],u=t[8],l=t[9],d=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*r+u*a,e[5]=o*r+l*a,e[6]=c*r+d*a,e[7]=s*r+f*a,e[8]=u*r-i*a,e[9]=l*r-o*a,e[10]=d*r-c*a,e[11]=f*r-s*a,e}})),n.variable(t("mat4rotateY")).define("mat4rotateY",(function(){return function(e,t,n){var a=Math.sin(n),r=Math.cos(n),i=t[0],o=t[1],c=t[2],s=t[3],u=t[8],l=t[9],d=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r-u*a,e[1]=o*r-l*a,e[2]=c*r-d*a,e[3]=s*r-f*a,e[8]=i*a+u*r,e[9]=o*a+l*r,e[10]=c*a+d*r,e[11]=s*a+f*r,e}})),n.variable(t("mat4rotateZ")).define("mat4rotateZ",(function(){return function(e,t,n){var a=Math.sin(n),r=Math.cos(n),i=t[0],o=t[1],c=t[2],s=t[3],u=t[4],l=t[5],d=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*r+u*a,e[1]=o*r+l*a,e[2]=c*r+d*a,e[3]=s*r+f*a,e[4]=u*r-i*a,e[5]=l*r-o*a,e[6]=d*r-c*a,e[7]=f*r-s*a,e}})),n.variable(t("mat4scale")).define("mat4scale",(function(){return function(e,t,n){var a=n[0],r=n[1],i=n[2];return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}})),n.variable(t("mat4str")).define("mat4str",(function(){return function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}})),n.variable(t("mat4translate")).define("mat4translate",(function(){return function(e,t,n){var a,r,i,o,c,s,u,l,d,f,m,p,h=n[0],v=n[1],b=n[2];return t===e?(e[12]=t[0]*h+t[4]*v+t[8]*b+t[12],e[13]=t[1]*h+t[5]*v+t[9]*b+t[13],e[14]=t[2]*h+t[6]*v+t[10]*b+t[14],e[15]=t[3]*h+t[7]*v+t[11]*b+t[15]):(a=t[0],r=t[1],i=t[2],o=t[3],c=t[4],s=t[5],u=t[6],l=t[7],d=t[8],f=t[9],m=t[10],p=t[11],e[0]=a,e[1]=r,e[2]=i,e[3]=o,e[4]=c,e[5]=s,e[6]=u,e[7]=l,e[8]=d,e[9]=f,e[10]=m,e[11]=p,e[12]=a*h+c*v+d*b+t[12],e[13]=r*h+s*v+f*b+t[13],e[14]=i*h+u*v+m*b+t[14],e[15]=o*h+l*v+p*b+t[15]),e}})),n.variable(t("mat4transpose")).define("mat4transpose",(function(){return function(e,t){if(e===t){var n=t[1],a=t[2],r=t[3],i=t[6],o=t[7],c=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=a,e[9]=i,e[11]=t[14],e[12]=r,e[13]=o,e[14]=c}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}})),n}function ve(){var e=Object(oe.a)(["## Implementation"]);return ve=function(){return e},e}function be(){var e=Object(oe.a)(["\nor you may import single functions directly\n\n```js\nimport {mat3create} from '@rreusser/gl-mat3'\n```\n"],["\nor you may import single functions directly\n\n\\`\\`\\`js\nimport {mat3create} from '@rreusser/gl-mat3'\n\\`\\`\\`\n"]);return be=function(){return e},e}function ge(){var e=Object(oe.a)(["## Usage\n\nThere are two basic ways to use this module. You may either import all functions\n\n```js\nimport {mat3} from '@rreusser/gl-mat3'\n```\n\nafter which you can use the functions like normal, e.g."],["## Usage\n\nThere are two basic ways to use this module. You may either import all functions\n\n\\`\\`\\`js\nimport {mat3} from '@rreusser/gl-mat3'\n\\`\\`\\`\n\nafter which you can use the functions like normal, e.g."]);return ge=function(){return e},e}function we(){var e=Object(oe.a)(["## License\n\nCopyright (c) 2013 Brandon Jones, Colin MacKenzie IV\n\nThis software is provided 'as-is', without any express or implied\nwarranty. In no event will the authors be held liable for any damages\narising from the use of this software.\n\nPermission is granted to anyone to use this software for any purpose,\nincluding commercial applications, and to alter it and redistribute it\nfreely, subject to the following restrictions:\n\n 1. The origin of this software must not be misrepresented you must not\n    claim that you wrote the original software. If you use this software\n    in a product, an acknowledgment in the product documentation would be\n    appreciated but is not required.\n\n 2. Altered source versions must be plainly marked as such, and must not\n    be misrepresented as being the original software.\n\n 3. This notice may not be removed or altered from any source distribution."]);return we=function(){return e},e}function ye(){var e=Object(oe.a)(["This notebook re-exports functions from [stackgl/gl-mat3](https://github.com/stackgl/gl-mat3). The license may be found [here](https://github.com/stackgl/gl-mat3/blob/master/LICENSE.md)."]);return ye=function(){return e},e}function Ee(){var e=Object(oe.a)(["# gl-mat3"]);return Ee=function(){return e},e}function xe(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(Ee())})),n.variable(t()).define(["md"],(function(e){return e(ye())})),n.variable(t()).define(["md"],(function(e){return e(we())})),n.variable(t()).define(["md"],(function(e){return e(ge())})),n.variable(t("a")).define("a",["mat3"],(function(e){return e.create()})),n.variable(t()).define(["md"],(function(e){return e(be())})),n.variable(t("b")).define("b",["mat3create"],(function(e){return e()})),n.variable(t()).define(["md"],(function(e){return e(ve())})),n.variable(t("mat3")).define("mat3",["mat3adjoint","mat3clone","mat3copy","mat3create","mat3determinant","mat3frob","mat3fromMat2d","mat3fromMat4","mat3fromQuat","mat3identity","mat3invert","mat3multiply","mat3normalFromMat4","mat3rotate","mat3scale","mat3str","mat3translate","mat3transpose"],(function(e,t,n,a,r,i,o,c,s,u,l,d,f,m,p,h,v,b){return{adjoint:e,clone:t,copy:n,create:a,determinant:r,frob:i,fromMat2d:o,fromMat4:c,fromQuat:s,identity:u,invert:l,multiply:d,normalFromMat4:f,rotate:m,scale:p,str:h,translate:v,transpose:b}})),n.variable(t("mat3adjoint")).define("mat3adjoint",(function(){return function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],c=t[5],s=t[6],u=t[7],l=t[8];return e[0]=o*l-c*u,e[1]=r*u-a*l,e[2]=a*c-r*o,e[3]=c*s-i*l,e[4]=n*l-r*s,e[5]=r*i-n*c,e[6]=i*u-o*s,e[7]=a*s-n*u,e[8]=n*o-a*i,e}})),n.variable(t("mat3clone")).define("mat3clone",(function(){return function(e){var t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}})),n.variable(t("mat3copy")).define("mat3copy",(function(){return function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}})),n.variable(t("mat3create")).define("mat3create",(function(){return function(){var e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}})),n.variable(t("mat3determinant")).define("mat3determinant",(function(){return function(e){var t=e[0],n=e[1],a=e[2],r=e[3],i=e[4],o=e[5],c=e[6],s=e[7],u=e[8];return t*(u*i-o*s)+n*(o*c-u*r)+a*(s*r-i*c)}})),n.variable(t("mat3frob")).define("mat3frob",(function(){return function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8])}})),n.variable(t("mat3fromMat2d")).define("mat3fromMat2d",(function(){return function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}})),n.variable(t("mat3fromMat4")).define("mat3fromMat4",(function(){return function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}})),n.variable(t("mat3fromQuat")).define("mat3fromQuat",(function(){return function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=n+n,c=a+a,s=r+r,u=n*o,l=a*o,d=a*c,f=r*o,m=r*c,p=r*s,h=i*o,v=i*c,b=i*s;return e[0]=1-d-p,e[3]=l-b,e[6]=f+v,e[1]=l+b,e[4]=1-u-p,e[7]=m-h,e[2]=f-v,e[5]=m+h,e[8]=1-u-d,e}})),n.variable(t("mat3identity")).define("mat3identity",(function(){return function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}})),n.variable(t("mat3invert")).define("mat3invert",(function(){return function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],c=t[5],s=t[6],u=t[7],l=t[8],d=l*o-c*u,f=-l*i+c*s,m=u*i-o*s,p=n*d+a*f+r*m;return p?(p=1/p,e[0]=d*p,e[1]=(-l*a+r*u)*p,e[2]=(c*a-r*o)*p,e[3]=f*p,e[4]=(l*n-r*s)*p,e[5]=(-c*n+r*i)*p,e[6]=m*p,e[7]=(-u*n+a*s)*p,e[8]=(o*n-a*i)*p,e):null}})),n.variable(t("mat3multiply")).define("mat3multiply",(function(){return function(e,t,n){var a=t[0],r=t[1],i=t[2],o=t[3],c=t[4],s=t[5],u=t[6],l=t[7],d=t[8],f=n[0],m=n[1],p=n[2],h=n[3],v=n[4],b=n[5],g=n[6],w=n[7],y=n[8];return e[0]=f*a+m*o+p*u,e[1]=f*r+m*c+p*l,e[2]=f*i+m*s+p*d,e[3]=h*a+v*o+b*u,e[4]=h*r+v*c+b*l,e[5]=h*i+v*s+b*d,e[6]=g*a+w*o+y*u,e[7]=g*r+w*c+y*l,e[8]=g*i+w*s+y*d,e}})),n.variable(t("mat3normalFromMat4")).define("mat3normalFromMat4",(function(){return function(e,t){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],c=t[5],s=t[6],u=t[7],l=t[8],d=t[9],f=t[10],m=t[11],p=t[12],h=t[13],v=t[14],b=t[15],g=n*c-a*o,w=n*s-r*o,y=n*u-i*o,E=a*s-r*c,x=a*u-i*c,j=r*u-i*s,O=l*h-d*p,k=l*v-f*p,S=l*b-m*p,M=d*v-f*h,N=d*b-m*h,T=f*b-m*v,P=g*T-w*N+y*M+E*S-x*k+j*O;return P?(P=1/P,e[0]=(c*T-s*N+u*M)*P,e[1]=(s*S-o*T-u*k)*P,e[2]=(o*N-c*S+u*O)*P,e[3]=(r*N-a*T-i*M)*P,e[4]=(n*T-r*S+i*k)*P,e[5]=(a*S-n*N-i*O)*P,e[6]=(h*j-v*x+b*E)*P,e[7]=(v*y-p*j-b*w)*P,e[8]=(p*x-h*y+b*g)*P,e):null}})),n.variable(t("mat3rotate")).define("mat3rotate",(function(){return function(e,t,n){var a=t[0],r=t[1],i=t[2],o=t[3],c=t[4],s=t[5],u=t[6],l=t[7],d=t[8],f=Math.sin(n),m=Math.cos(n);return e[0]=m*a+f*o,e[1]=m*r+f*c,e[2]=m*i+f*s,e[3]=m*o-f*a,e[4]=m*c-f*r,e[5]=m*s-f*i,e[6]=u,e[7]=l,e[8]=d,e}})),n.variable(t("mat3scale")).define("mat3scale",(function(){return function(e,t,n){var a=n[0],r=n[1];return e[0]=a*t[0],e[1]=a*t[1],e[2]=a*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}})),n.variable(t("mat3str")).define("mat3str",(function(){return function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}})),n.variable(t("mat3translate")).define("mat3translate",(function(){return function(e,t,n){var a=t[0],r=t[1],i=t[2],o=t[3],c=t[4],s=t[5],u=t[6],l=t[7],d=t[8],f=n[0],m=n[1];return e[0]=a,e[1]=r,e[2]=i,e[3]=o,e[4]=c,e[5]=s,e[6]=f*a+m*o+u,e[7]=f*r+m*c+l,e[8]=f*i+m*s+d,e}})),n.variable(t("mat3transpose")).define("mat3transpose",(function(){return function(e,t){if(e===t){var n=t[1],a=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=a,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}})),n}function je(){var e=Object(oe.a)(["## Implementation"]);return je=function(){return e},e}function Oe(){var e=Object(oe.a)(["\nor you may import single functions directly\n\n```js\nimport {vec2create} from '@rreusser/gl-vec2'\n```\n"],["\nor you may import single functions directly\n\n\\`\\`\\`js\nimport {vec2create} from '@rreusser/gl-vec2'\n\\`\\`\\`\n"]);return Oe=function(){return e},e}function ke(){var e=Object(oe.a)(["## Usage\n\nThere are two basic ways to use this module. You may either import all functions\n\n```js\nimport {vec2} from '@rreusser/gl-vec2'\n```\n\nafter which you can use the functions like normal, e.g."],["## Usage\n\nThere are two basic ways to use this module. You may either import all functions\n\n\\`\\`\\`js\nimport {vec2} from '@rreusser/gl-vec2'\n\\`\\`\\`\n\nafter which you can use the functions like normal, e.g."]);return ke=function(){return e},e}function Se(){var e=Object(oe.a)(["## License\n\nCopyright (c) 2013 Brandon Jones, Colin MacKenzie IV\n\nThis software is provided 'as-is', without any express or implied\nwarranty. In no event will the authors be held liable for any damages\narising from the use of this software.\n\nPermission is granted to anyone to use this software for any purpose,\nincluding commercial applications, and to alter it and redistribute it\nfreely, subject to the following restrictions:\n\n 1. The origin of this software must not be misrepresented you must not\n    claim that you wrote the original software. If you use this software\n    in a product, an acknowledgment in the product documentation would be\n    appreciated but is not required.\n\n 2. Altered source versions must be plainly marked as such, and must not\n    be misrepresented as being the original software.\n\n 3. This notice may not be removed or altered from any source distribution."]);return Se=function(){return e},e}function Me(){var e=Object(oe.a)(["This notebook re-exports functions from [stackgl/gl-vec2](https://github.com/stackgl/gl-vec2). The license may be found [here](https://github.com/stackgl/gl-vec2/blob/master/LICENSE.md)."]);return Me=function(){return e},e}function Ne(){var e=Object(oe.a)(["# gl-vec2"]);return Ne=function(){return e},e}function Te(e,t){var n=e.module();return n.variable(t()).define(["md"],(function(e){return e(Ne())})),n.variable(t()).define(["md"],(function(e){return e(Me())})),n.variable(t()).define(["md"],(function(e){return e(Se())})),n.variable(t()).define(["md"],(function(e){return e(ke())})),n.variable(t("a")).define("a",["vec2"],(function(e){return e.create()})),n.variable(t()).define(["md"],(function(e){return e(Oe())})),n.variable(t("b")).define("b",["vec2create"],(function(e){return e()})),n.variable(t()).define(["md"],(function(e){return e(je())})),n.variable(t("vec2")).define("vec2",["EPSILON","vec2create","vec2clone","vec2fromValues","vec2copy","vec2set","vec2equals","vec2exactEquals","vec2add","vec2subtract","vec2sub","vec2multiply","vec2mul","vec2divide","vec2div","vec2inverse","vec2min","vec2max","vec2rotate","vec2floor","vec2ceil","vec2round","vec2scale","vec2scaleAndAdd","vec2distance","vec2dist","vec2squaredDistance","vec2sqrDist","vec2length","vec2len","vec2squaredLength","vec2sqrLen","vec2negate","vec2normalize","vec2dot","vec2cross","vec2lerp","vec2random","vec2transformMat2","vec2transformMat2d","vec2transformMat3","vec2transformMat4","vec2forEach","vec2limit"],(function(e,t,n,a,r,i,o,c,s,u,l,d,f,m,p,h,v,b,g,w,y,E,x,j,O,k,S,M,N,T,P,R,I,C,L,A,_,D,F,z,q,G,U,B){return{EPSILON:e,create:t,clone:n,fromValues:a,copy:r,set:i,equals:o,exactEquals:c,add:s,subtract:u,sub:l,multiply:d,mul:f,divide:m,div:p,inverse:h,min:v,max:b,rotate:g,floor:w,ceil:y,round:E,scale:x,scaleAndAdd:j,distance:O,dist:k,squaredDistance:S,sqrDist:M,length:N,len:T,squaredLength:P,sqrLen:R,negate:I,normalize:C,dot:L,cross:A,lerp:_,random:D,transformMat2:F,transformMat2d:z,transformMat3:q,transformMat4:G,forEach:U,limit:B}})),n.variable(t("EPSILON")).define("EPSILON",(function(){return 1e-6})),n.variable(t("vec2add")).define("vec2add",(function(){return function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}})),n.variable(t("vec2ceil")).define("vec2ceil",(function(){return function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}})),n.variable(t("vec2clone")).define("vec2clone",(function(){return function(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}})),n.variable(t("vec2copy")).define("vec2copy",(function(){return function(e,t){return e[0]=t[0],e[1]=t[1],e}})),n.variable(t("vec2create")).define("vec2create",(function(){return function(){var e=new Float32Array(2);return e[0]=0,e[1]=0,e}})),n.variable(t("vec2cross")).define("vec2cross",(function(){return function(e,t,n){var a=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=a,e}})),n.variable(t("vec2distance")).define("vec2distance",(function(){return function(e,t){var n=t[0]-e[0],a=t[1]-e[1];return Math.sqrt(n*n+a*a)}})),n.variable(t("vec2dist")).define("vec2dist",["vec2distance"],(function(e){return e})),n.variable(t("vec2divide")).define("vec2divide",(function(){return function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}})),n.variable(t("vec2div")).define("vec2div",["vec2divide"],(function(e){return e})),n.variable(t("vec2dot")).define("vec2dot",(function(){return function(e,t){return e[0]*t[0]+e[1]*t[1]}})),n.variable(t("vec2equals")).define("vec2equals",["EPSILON"],(function(e){return function(t,n){var a=t[0],r=t[1],i=n[0],o=n[1];return Math.abs(a-i)<=e*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(r-o)<=e*Math.max(1,Math.abs(r),Math.abs(o))}})),n.variable(t("vec2exactEquals")).define("vec2exactEquals",(function(){return function(e,t){return e[0]===t[0]&&e[1]===t[1]}})),n.variable(t("vec2floor")).define("vec2floor",(function(){return function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}})),n.variable(t("vec2forEach")).define("vec2forEach",["vec2create"],(function(e){var t=e();return function(e,n,a,r,i,o){var c,s;for(n||(n=2),a||(a=0),s=r?Math.min(r*n+a,e.length):e.length,c=a;c<s;c+=n)t[0]=e[c],t[1]=e[c+1],i(t,t,o),e[c]=t[0],e[c+1]=t[1];return e}})),n.variable(t("vec2fromValues")).define("vec2fromValues",(function(){return function(e,t){var n=new Float32Array(2);return n[0]=e,n[1]=t,n}})),n.variable(t("vec2inverse")).define("vec2inverse",(function(){return function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}})),n.variable(t("vec2length")).define("vec2length",(function(){return function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)}})),n.variable(t("vec2len")).define("vec2len",["vec2length"],(function(e){return e})),n.variable(t("vec2lerp")).define("vec2lerp",(function(){return function(e,t,n,a){var r=t[0],i=t[1];return e[0]=r+a*(n[0]-r),e[1]=i+a*(n[1]-i),e}})),n.variable(t("vec2limit")).define("vec2limit",(function(){return function(e,t,n){var a=t[0]*t[0]+t[1]*t[1];if(a>n*n){var r=Math.sqrt(a);e[0]=t[0]/r*n,e[1]=t[1]/r*n}else e[0]=t[0],e[1]=t[1];return e}})),n.variable(t("vec2max")).define("vec2max",(function(){return function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e}})),n.variable(t("vec2min")).define("vec2min",(function(){return function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e}})),n.variable(t("vec2multiply")).define("vec2multiply",(function(){return function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}})),n.variable(t("vec2mul")).define("vec2mul",["vec2multiply"],(function(e){return e})),n.variable(t("vec2negate")).define("vec2negate",(function(){return function(e,t){return e[0]=-t[0],e[1]=-t[1],e}})),n.variable(t("vec2normalize")).define("vec2normalize",(function(){return function(e,t){var n=t[0],a=t[1],r=n*n+a*a;return r>0&&(r=1/Math.sqrt(r),e[0]=t[0]*r,e[1]=t[1]*r),e}})),n.variable(t("vec2random")).define("vec2random",(function(){return function(e,t){t=t||1;var n=2*Math.random()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e}})),n.variable(t("vec2rotate")).define("vec2rotate",(function(){return function(e,t,n){var a=Math.cos(n),r=Math.sin(n),i=t[0],o=t[1];return e[0]=i*a-o*r,e[1]=i*r+o*a,e}})),n.variable(t("vec2round")).define("vec2round",(function(){return function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}})),n.variable(t("vec2scale")).define("vec2scale",(function(){return function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}})),n.variable(t("vec2scaleAndAdd")).define("vec2scaleAndAdd",(function(){return function(e,t,n,a){return e[0]=t[0]+n[0]*a,e[1]=t[1]+n[1]*a,e}})),n.variable(t("vec2set")).define("vec2set",(function(){return function(e,t,n){return e[0]=t,e[1]=n,e}})),n.variable(t("vec2squaredDistance")).define("vec2squaredDistance",(function(){return function(e,t){var n=t[0]-e[0],a=t[1]-e[1];return n*n+a*a}})),n.variable(t("vec2sqrDist")).define("vec2sqrDist",["vec2squaredDistance"],(function(e){return e})),n.variable(t("vec2squaredLength")).define("vec2squaredLength",(function(){return function(e){var t=e[0],n=e[1];return t*t+n*n}})),n.variable(t("vec2sqrLen")).define("vec2sqrLen",["vec2squaredLength"],(function(e){return e})),n.variable(t("vec2subtract")).define("vec2subtract",(function(){return function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}})),n.variable(t("vec2sub")).define("vec2sub",["vec2subtract"],(function(e){return e})),n.variable(t("vec2transformMat2")).define("vec2transformMat2",(function(){return function(e,t,n){var a=t[0],r=t[1];return e[0]=n[0]*a+n[2]*r,e[1]=n[1]*a+n[3]*r,e}})),n.variable(t("vec2transformMat2d")).define("vec2transformMat2d",(function(){return function(e,t,n){var a=t[0],r=t[1];return e[0]=n[0]*a+n[2]*r+n[4],e[1]=n[1]*a+n[3]*r+n[5],e}})),n.variable(t("vec2transformMat3")).define("vec2transformMat3",(function(){return function(e,t,n){var a=t[0],r=t[1];return e[0]=n[0]*a+n[3]*r+n[6],e[1]=n[1]*a+n[4]*r+n[7],e}})),n.variable(t("vec2transformMat4")).define("vec2transformMat4",(function(){return function(e,t,n){var a=t[0],r=t[1];return e[0]=n[0]*a+n[4]*r+n[12],e[1]=n[1]*a+n[5]*r+n[13],e}})),n}n(172);var Pe=n(107);function Re(){var e=Object(oe.a)(["---\n## Deprecations\n"]);return Re=function(){return e},e}function Ie(){var e=Object(oe.a)(["---\n## Internals"]);return Ie=function(){return e},e}function Ce(){var e=Object(oe.a)(["<a href>"]);return Ce=function(){return e},e}function Le(){var e=Object(oe.a)(["<style>"]);return Le=function(){return e},e}function Ae(){var e=Object(oe.a)(["---\n## Markup\n"]);return Ae=function(){return e},e}function _e(){var e=Object(oe.a)(["---\n## Images\n"]);return _e=function(){return e},e}function De(){var e=Object(oe.a)(["---\n## Reactivity\n"]);return De=function(){return e},e}function Fe(){var e=Object(oe.a)(["# Toolbox\n\nA growing<sup>*</sup> library of functions for various tasks.\nThis notebook will change frequently. If you rely on it be sure to pin the version:\n","\n\n<small><sup>*</sup> <i>A bit of a mess right now as I move things around. Let's not focus on the bad things though, shall we? :D</i></small>\n\n"]);return Fe=function(){return e},e}function ze(e,t){var n=e.module();n.variable(t()).define(["md","code","PINNED"],(function(e,t,n){return e(Fe(),t("import {/* ... */} from '".concat(n,"'")))})),n.variable(t()).define(["md"],(function(e){return e(De())})),n.variable(t("linkViews")).define("linkViews",(function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enumerable:!0};return Object.entries(t).forEach((function(t){var a=Object(l.a)(t,2),r=a[0],i=a[1];Object.defineProperty(e,r,Object.assign({get:function(){return i.value}},n))})),e}})),n.variable(t()).define(["md"],(function(e){return e(_e())})),n.variable(t()).define(["signature","fitSize"],(function(e,t){return e(t,{description:"Scales dimensions proportionally to fit into the given width and/or height.",example:"\nconst [width, height, scale] = fitSize(img.naturalWidth, img.naturalHeight, {width: 500, height: 500});\nimg.width = width;\nimg.height = height;\n",tests:{"no target dimensions":function(e){var n=t(200,150),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(200===r,"width"),e(150===i,"height"),e(1===o,"scale")},"target width only":function(){var e=Object(u.a)(s.a.mark((function e(n){var a,r,i,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t(200,150,{width:400}),r=Object(l.a)(a,3),i=r[0],o=r[1],c=r[2],n(400===i,"width"),n(300===o,"height"),n(2===c,"scale");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"target height only":function(e){var n=t(200,150,{height:300}),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")},"same aspect":function(e){var n=t(200,150,{width:400,height:300}),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")},"smaller aspect ratio":function(e){var n=t(200,150,{width:600,height:300}),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")},"greater aspect ratio":function(e){var n=t(200,150,{width:600,height:300}),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")}}})})),n.variable(t("fitSize")).define("fitSize",(function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.width,r=n.height;n.crop;if(null==a&&null==r)return[e,t,1];var i=e/t;return null==a||null!=r&&i<a/r?[r*i,r,r/t]:[a,a/i,a/e]}})),n.variable(t()).define(["signature","importAsset"],(function(e,t){return e(t,{description:"Imports a remote asset and returns its local URL and blob.",example:"const {blob, url} = await importAsset('https://example.com/image.png');",tests:{"import asset":function(){var e=Object(u.a)(s.a.mark((function e(n){var a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("https://en.wikipedia.org/static/favicon/wikipedia.ico");case 2:a=e.sent,r=a.blob,i=a.url,n(r instanceof Blob,"blob"),n("string"===typeof i,"url");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})})),n.variable(t("importAsset")).define("importAsset",["invalidation"],(function(e){return function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n).then((function(e){return e.blob()})).then((function(t){var n=URL.createObjectURL(t);return e.then((function(){return URL.revokeObjectURL(n)})),{url:n,blob:t}})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),n.variable(t()).define(["signature","importImage","DOM"],(function(e,t,n){return e(t,{description:"Returns an Image for a remote src. The image has been created from an object URL and won't taint a canvas.",example:"\nconst img = await importImage('https://example.com/image.png');\nconst ctx = DOM.context2d(img.naturalWidth, img.naturalHeight, 1);\nctx.drawImage(img, 0, 0);\n  ",tests:{"tainted canvas":function(){var e=Object(u.a)(s.a.mark((function e(t){var a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.element("img",{src:"https://i.imgur.com/D6H96Hc.png"}),e.next=3,a.decode();case 3:(r=n.context2d(a.naturalWidth,a.naturalHeight,1)).drawImage(a,0,0),i="";try{r.getImageData(0,0,1,1)}catch(o){i+=o}t(/^SecurityError/.test(i),"remote URL taints canvas");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"import image":function(){var e=Object(u.a)(s.a.mark((function e(a){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("https://i.imgur.com/D6H96Hc.png");case 2:r=e.sent,(i=n.context2d(r.naturalWidth,r.naturalHeight,1)).drawImage(r,0,0),o=i.getImageData(0,0,1,1).data,a(255===o[0],0===o[1],"Image can be imported and applied to canvas without tainting it");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})})),n.variable(t("importImage")).define("importImage",["DOM"],(function(e){return function(){var t=Object(u.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.element("img",{crossorigin:"anonymous",src:n}),t.abrupt("return",a.decode().then((function(){return a})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),n.variable(t()).define(["md"],(function(e){return e(Ae())})),n.variable(t("querylink")).define("querylink",["DOM"],(function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=a.query,i=void 0===r?function(e){return'https://duckduckgo.com/?q="'.concat(decodeURI(e),'"')}:r,o=e.element("a",Object(p.a)({href:n.href||i(t)},n));return o.textContent=t,o}})),n.variable(t()).define((function(){return""})),n.variable(t()).define(["signature","scopedStyle"],(function(e,t){return e(t,{description:"Creates a scoped `<style>` element from CSS.",example:"\nconst namespace = DOM.uid('scope').id;\nconst style = scopedStyle('.' + namespace, `\n  :scope { font-family: sans-serif }\n  :scope, :scope > * { padding: 0 }\n`);\nreturn html`<div class=\"${namespace}\">\n  ${style}\n  <span> text ...\n`;\n"})})),n.variable(t("scopedStyle")).define("scopedStyle",["html"],(function(e){return function(t,n){var a=e(Le());return a.textContent=n.replace(/\:scope\b/g,t),a}})),n.variable(t()).define(["signature","getPinnedSlug"],(function(e,t){return e(t)})),n.variable(t("getPinnedSlug")).define("getPinnedSlug",["html"],(function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,a=void 0===n?null:n,r=t.parseVersion,i=void 0===r?"v1":r,o=function(){var e=Object(u.a)(s.a.mark((function e(t,n,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://api.observablehq.com/".concat(t,".js?v=").concat(n)).then((function(e){return e.text()})).catch((function(e){return null})).then((function(e){return null==e?[]:e.split("\n",a+1).slice(0,a)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),c={v1:function(e){return o(e,1,4).then((function(e){var t=e[0].slice("// URL: https://observablehq.com/".length).replace(/^d\//,""),n=e[3].slice("// Version: ".length);return"".concat(t,"@").concat(n)}))},v3:function(e){return o(e,3,1).then((function(e){return e[0].slice("// https://observablehq.com/".length).replace(/^d\//,"")}))}};try{var l=null!=a?a.replace(/^(?!@)/,"d/"):e(Ce()).pathname.match(/^\/(d\/[a-f0-9]{16}|@[^\/]+\/[^@].*?)(?:$|\/)/)[1];return c[i](l).catch((function(e){return null}))}catch(d){return null}}})),n.variable(t()).define(["signature"],(function(e){return e("PINNED",{name:"PINNED",description:"Notebook slug, automatically pinned to the most recent version of the importing notebook.",example:'md`You can import my notebook this way:\n\\`\\`\\`javascript\nimport {foo} from "${PINNED}"\n\\`\\`\\``\n'})})),n.variable(t("PINNED")).define("PINNED",["getPinnedSlug"],(function(e){return e()})),n.variable(t()).define(["md"],(function(e){return e(Ie())})),n.variable(t("readChunks")).define("readChunks",(function(){return function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,i,o,c,u,l,d,f=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:{},a=n.separator,r=void 0===a?10:a,i=n.limit,o=void 0===i?1/0:i,c=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n},u=[],l=new Uint8Array,d=function e(){return t.read().then((function(n){var a=n.done,i=n.value,s=-1,d=0;if(i){for(console.log("chunk size",i.length);++s<i.length;)if(i[s]===r){if(u.push(c(l,i.slice(d,s))),u.length>=o)return t.cancel(),u;d=s+1}l=i.slice(d)}return a?(u.push(l),u):e()}))},e.abrupt("return",d());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),n.variable(t("PINNED_LIB")).define("PINNED_LIB",["getPinnedSlug"],(function(e){return e({name:"691ae3b95f02db79"})})),n.variable(t("viewof RUN_TESTS")).define("viewof RUN_TESTS",["deprecateImport","viewof _dep_RUN_TESTS"],(function(e,t){return e(t,"RUN_TESTS",!1)})),n.variable(t("RUN_TESTS")).define("RUN_TESTS",["Generators","viewof RUN_TESTS"],(function(e,t){return e.input(t)})),n.variable(t()).define(["md"],(function(e){return e(Re())})),n.variable(t("deprecateImport")).define("deprecateImport",["PINNED","PINNED_LIB"],(function(e,t){return function(n,a){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"3d9d1394d858ca97";return e&&e===t?r?void 0:n:(console.warn("".concat(a,' has been moved. Import it from "').concat(i,'".')),n)}}));var a=e.module(dt);return n.import("code","_dep_code",a),n.import("signature","_dep_signature",a),n.import("signature_theme","_dep_signature_theme",a),n.import("viewof RUN_TESTS","viewof _dep_RUN_TESTS",a),n.import("RUN_TESTS","_dep_RUN_TESTS",a),n.import("createStepper","_dep_createStepper",a),n.import("defaultTestRunner","_dep_defaultTestRunner",a),n.import("defaultSignatureParser","_dep_defaultSignatureParser",a),n.variable(t("signature")).define("signature",["deprecateImport","_dep_signature"],(function(e,t){return e(t,"signature",!1)})),n.variable(t("code")).define("code",["deprecateImport","_dep_code"],(function(e,t){return e(t,"code",!1)})),n.variable(t("signature_theme")).define("signature_theme",["deprecateImport","_dep_signature_theme"],(function(e,t){return e(t,"signature_theme")})),n.variable(t("createStepper")).define("createStepper",["deprecateImport","_dep_createStepper"],(function(e,t){return e(t,"createStepper")})),n.variable(t("defaultTestRunner")).define("defaultTestRunner",["deprecateImport","_dep_defaultTestRunner"],(function(e,t){return e(t,"defaultTestRunner")})),n.variable(t("defaultSignatureParser")).define("defaultSignatureParser",["deprecateImport","_dep_defaultSignatureParser"],(function(e,t){return e(t,"defaultSignatureParser")})),n}function qe(){var e=Object(oe.a)(["---\n## Testing\n\nTests can be incorporated into the documentation and executed\n- by passing `{runTests: true}`, which will execute tests immediately,\n- by clicking the `Run tests` button inside the documentation cell,\n- or by passing a promise for `runTests`. This promise can be used to execute all tests on the page.\n\nSelect how tests should be run for the following example:\n"],["---\n## Testing\n\nTests can be incorporated into the documentation and executed\n- by passing \\`{runTests: true}\\`, which will execute tests immediately,\n- by clicking the \\`Run tests\\` button inside the documentation cell,\n- or by passing a promise for \\`runTests\\`. This promise can be used to execute all tests on the page.\n\nSelect how tests should be run for the following example:\n"]);return qe=function(){return e},e}function Ge(){var e=Object(oe.a)(["\nIf you want to override the CSS globally (and also have shared instead of scoped styles), use the following steps:\n"]);return Ge=function(){return e},e}function Ue(){var e=Object(oe.a)(["\nTo override the CSS for a single instance, pass the default CSS along with your custom CSS:\n"]);return Ue=function(){return e},e}function Be(){var e=Object(oe.a)(["---\n## Superstylin'\n\n***Note:*** *This section is currently being reworked.*\n\nTo extend the base theme, first import it:\n"]);return Be=function(){return e},e}function Ve(){var e=Object(oe.a)(["---\n\n## Old docs - under construction\n"]);return Ve=function(){return e},e}function He(){var e=Object(oe.a)(["<tr data-status=",">\n        <td>","</td>\n        <td><span title=",">","</span> ","</td>"]);return He=function(){return e},e}function We(){var e=Object(oe.a)(["<table><thead><tr><th>Name</th><th>Result</th></tr><body>",""]);return We=function(){return e},e}function Ye(){var e=Object(oe.a)(["---\n## Internals\n"]);return Ye=function(){return e},e}function Xe(){var e=Object(oe.a)(["<div><button>Run all tests"]);return Xe=function(){return e},e}function Qe(){var e=Object(oe.a)(["```","\n","\n```"],["\\`\\`\\`","\\n","\\n\\`\\`\\`"]);return Qe=function(){return e},e}function Ze(){var e=Object(oe.a)(["Examples:"]);return Ze=function(){return e},e}function Ke(){var e=Object(oe.a)(["Example:"]);return Ke=function(){return e},e}function Je(){var e=Object(oe.a)(["<div class=examples>",""]);return Je=function(){return e},e}function $e(){var e=Object(oe.a)(["<div class=description>",""]);return $e=function(){return e},e}function et(){var e=Object(oe.a)(['<a class=link href="#','">']);return et=function(){return e},e}function tt(){var e=Object(oe.a)(["<"," class=signature>","",""]);return tt=function(){return e},e}function nt(){var e=Object(oe.a)(["<",' class="','">',""]);return nt=function(){return e},e}function at(){var e=Object(oe.a)(["",""]);return at=function(){return e},e}function rt(){var e=Object(oe.a)(["Test results:"]);return rt=function(){return e},e}function it(){var e=Object(oe.a)(["<div class=tests>",""]);return it=function(){return e},e}function ot(){var e=Object(oe.a)(["<p class=cta>"," to view results"]);return ot=function(){return e},e}function ct(){var e=Object(oe.a)(["<button>Run tests"]);return ct=function(){return e},e}function st(){var e=Object(oe.a)(["\nDocumentation template for functions. Extracts the function head from the function passed to **`fn`**:\n- If `fn` is a named function, the head is returned as written.\n- If `fn` is an arrow function, the declaration will be reformatted and the `function` keyword injected. If `name` was set, it will be injected as the function name.\n- Any other argument type is passed through unaltered.\n\n**Note:** Arrow functions are nameless, even when assigned to a variable. In these cases `name` must be provided explicitely.\n\nAll settings are optional. Available **`options`**:\n",""],["\nDocumentation template for functions. Extracts the function head from the function passed to **\\`fn\\`**:\n- If \\`fn\\` is a named function, the head is returned as written.\n- If \\`fn\\` is an arrow function, the declaration will be reformatted and the \\`function\\` keyword injected. If \\`name\\` was set, it will be injected as the function name.\n- Any other argument type is passed through unaltered.\n\n**Note:** Arrow functions are nameless, even when assigned to a variable. In these cases \\`name\\` must be provided explicitely.\n\nAll settings are optional. Available **\\`options\\`**:\n",""]);return st=function(){return e},e}function ut(){var e=Object(oe.a)(["---"]);return ut=function(){return e},e}function lt(){var e=Object(oe.a)(["# Signature\n\nThis notebook offers a set of documentation helpers.\n\nFor more examples please see [Toolbox](https://observablehq.com/d/691ae3b95f02db79).\n"]);return lt=function(){return e},e}function dt(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(lt())})),n.variable(t()).define(["md"],(function(e){return e(ut())})),n.variable(t()).define(["signature","md"],(function(e,t){return e(e,{description:t(st(),Object.entries({description:"Rendered as Markdown if a string, otherwise passed through.",example:"Single value or array of values. String values are formatted as Javascript code, everything else gets passed through.",name:"Anchor name to link to. Defaults to function name.",scope:"Class name to scope CSS selectors. Defaults to unique string.",css:"The theme CSS. If `scope` is used, the CSS should start every selector with `:scope`. Defaults to `signature_theme`.",open:"Boolean that controls the toggle state of the details wrapper. Set to `null` to disable collapsing.",tests:"Object map of test functions, keyed by test name. Each function receives `assert(condition, assertion)`   as argument. Async functions are supported.",runTests:"Boolean or Promise, controls test execution. Set to `false` to disable test output.",testRunner:"Executes tests and builds results markup. See [`defaultTestRunner()`](#defaultTestRunner) for details."}).map((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];return"- `".concat(n,":` ").concat(a,"\n")}))),example:['\n// Basic use\nsignature(myUsefulFunc, {\n  description: "\'Tis a very useful function, this construct of strung-together characters."\n})\n  ',"\n// Tests\nsignature(myTestedFunc, {\n  tests: {\n    'can retrieve data': async (assert) => {\n      const data = await myTestedFunc().getData();\n      assert(Array.isArray(data), 'data is array');\n      assert(data.length, 'data is not empty');\n    },\n    'is this finished?': assert => {\n      assert(myTestedFunc() !== 'todo: implement', 'actually implemented');\n    },\n    'Look, ma! No assert!': () => {\n      try { myTestedFunc().notImplemented() }\n      catch(e) { throw Error(`Hey signature(), catch this! ${e}`) };\n    }\n}})\n  "],tests:{"signature parsing":function(t){var n=function(n,a,r){var i=e(r,{name:a,formatter:function(e){return e.signature.textContent.trim()}});t(n===i,n)};n("function()",void 0,(function(){})),n("function foo1()",void 0,(function(){})),n("function foo2()","foo2",(function(){})),n("function()",void 0,(function(){})),n("function foo3()","foo3",(function(){})),n("async function()",void 0,Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),n("async function foo4(a)","foo4",function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n("async function foo5()",void 0,function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),n("async function* foo6()","foo6",Object(Pe.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),n("function*()",void 0,s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),n('function(a,b=({foo:"bar"}))',void 0,(function(e){}))}}})})),n.variable(t("signature")).define("signature",["RUN_TESTS","DOM","signature_theme","defaultSignatureParser","defaultTestRunner","html","md","code","scopedStyle"],(function(e,t,n,a,r,i,o,c,s){return function(u){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=l.name,f=void 0===d?"function"===typeof u&&u.name.length?u.name:null:d,m=l.description,p=void 0===m?null:m,v=l.example,b=void 0===v?null:v,g=l.open,w=void 0===g||g,y=l.tests,E=void 0===y?{}:y,x=l.runTests,j=void 0===x?e.promise:x,O=l.scope,k=void 0===O?t.uid("css-scope").id:O,S=l.css,M=void 0===S?n:S,N=l.formatter,T=void 0===N?G:N,P=l.signatureParser,R=void 0===P?a:P,I=l.testRunner,C=void 0===I?r:I,L="function"!==typeof u?u:R(u,f),A=null;if(j&&E&&Object.keys(E).length){var _=C(E),D=_.list,F=_.run,z=i(ct()),q=i(ot(),z);A=i(it(),[o(rt()),q]),Promise.race([Promise.resolve(j),new Promise((function(e){return z.onclick=e}))]).then((function(){return q.replaceWith(D),F()}))}return T({signature:"string"===typeof L?c(L):L,description:"string"===typeof p?o(at(),p):p,examples:(null==b?[]:Array.isArray(b)?b:[b]).map((function(e){return"string"===typeof e?c(e):e})),testList:A},{name:f,open:w,css:M,scope:k});function G(e,t){var n=e.signature,a=e.description,r=e.examples,c=e.testList,u=t.name,l=t.open,d=t.scope,f=t.css;return i(nt(),null==l?"div":"details ".concat(l?"open":""),d,[f?null==d?f:s("."+d,f):"",i(tt(),null==l?"div":"summary",n,u&&u.length?i(et(),u):""),null==a?"":i($e(),a),r.length?i(Je(),[r.length<2?o(Ke()):o(Ze())].concat(Object(h.a)(r))):"",c||""])}}})),n.variable(t("signature_theme")).define("signature_theme",(function(){return'\n:scope {\n  border: 1px solid #eee;\n  padding: .5em 1em;\n  margin-bottom: 1em;\n}\n:scope > div {\n  border-top: 1px solid #eee;\n}\n:scope > summary:focus {\n  outline: none;\n}\n:scope > summary {\n  padding-left: 1.2em;\n  position: relative;\n}\n:scope > summary::-webkit-details-marker {\n  display: none;\n}\n:scope > summary:before {\n  position: absolute;\n  left: 0;\n  content: "\u25ba";\n}\n:scope[open] > summary:before {\n  content: "\u25bc";\n}\n:scope .signature {\n  display: flex;\n  align-items: center;\n}\n:scope .examples .code {\n  background: #f5f5f5;\n  padding: .5rem;\n}\n:scope .link:before {\n  content: "";\n  display: block;\n  width: 1rem;\n  height: 1rem;\n  background: url(https://raw.githubusercontent.com/encharm/Font-Awesome-SVG-PNG/master/black/png/32/link.png) center 100%/contain;\n  margin-left: .5rem;\n  opacity: .3;\n}\n:scope .signature:hover .link:hover:before { opacity: 1}\n:scope .tests .cta {\n  font-style: italic;\n}\n:scope .tests th, :scope .tests td { padding: .25em .5em }\n:scope .tests tr[data-status="pending"] { background: hsl(40,90%,90%); opacity: .5 }\n:scope .tests tr[data-status="error"]   { background: hsl( 0,90%,90%)}\n:scope .tests tr[data-status="success"] { background: hsl(90,90%,90%)}\n'})),n.variable(t()).define(["signature","code"],(function(e,t){return e(t,{description:"Creates syntax-highlighted output.",example:"\nconst myCss = `.container { background: red; }`;\nreturn code(myCss, {\n  // Optional, defaults to Javascript. Supported languages:\n  // \n  language: 'css',\n  // Removes leading and trailing empty lines.\n  trim: false\n});"})})),n.variable(t("code")).define("code",["md"],(function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.type,r=void 0===a?"javascript":a,i=n.trim,o=void 0===i||i,c=n.className,s=void 0===c?"code":c,u=e(Qe(),r,o?t.replace(/^\s*\n|\s+?$/g,""):t);return s&&u.classList.add("code"),u}})),n.variable(t()).define(["signature","PINNED_LIB"],(function(e,t){return e("RUN_TESTS",{name:"RUN_TESTS",description:"Button that triggers all tests that have not run yet.",example:'\nimport {viewof RUN_TESTS} from "'.concat(t,'"\n// In another cell:\nviewof RUN_TESTS\n')})})),n.variable(t("viewof RUN_TESTS")).define("viewof RUN_TESTS",["createStepper","html"],(function(e,t){var n=e(),a=t(Xe());return a.onclick=function(e){e.stopPropagation(),n.next()},a.value=n,a})),n.variable(t("RUN_TESTS")).define("RUN_TESTS",["Generators","viewof RUN_TESTS"],(function(e,t){return e.input(t)})),n.variable(t()).define(["md"],(function(e){return e(Ye())})),n.variable(t("createStepper")).define("createStepper",(function(){return function(){var e=function(){},t={step:-1,next:function(){return t.step++,e(),t.promise=new Promise((function(t){return e=t})),t}};return t.next()}})),n.variable(t("defaultTestRunner")).define("defaultTestRunner",["html","DOM"],(function(e,t){return function(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.assert,i=void 0===r?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";if(!e)throw t}:r,o=a.formatList,c=void 0===o?function(t){return e(We(),t)}:o,d=a.formatItem,f=void 0===d?function(n,a,r){var i=null==a?"pending":a?"success":"error",o={pending:"\u231b",success:"\u2705",error:"\u2757"}[i];return e(He(),i,t.text(n),i,o,r||"")}:d,m=Object.entries(n).map((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];return{name:n,node:f(n),run:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.call(null,i);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}})),p=c(m.map((function(e){return e.node}))),h=function(){return Promise.all(m.map((function(e){var t=e.name,n=e.node;return(0,e.run)().then((function(e){return n.replaceWith(f(t,void 0===e,e))}))})))};return{list:p,run:h}}})),n.variable(t("defaultSignatureParser")).define("defaultSignatureParser",(function(){return function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.toString(),a=0,r=0,i=function(e){switch(e){case"(":++r;break;case")":--r;break;case"{":case"=":if(0===r)return!1}return!0};a<n.length&&i(n[a++]););var o=n.substring(0,a-1).trim();if(""!==e.name)return o;var c=o.match(/^(async\s*)?(function\s*)?(\*)?/),s=c[1]?"async ":"",u=c[3]?"*":"",l=null!=t?" ".concat(t):"",d=o.substring(c[0].length).trim();return"("!==d[0]&&(d="(".concat(d,")")),"".concat(s,"function").concat(u).concat(l).concat(d)}}));var a=e.module(ze);n.import("getPinnedSlug",a),n.variable(t("PINNED_LIB")).define("PINNED_LIB",["getPinnedSlug"],(function(e){return e("3d9d1394d858ca97")})),n.variable(t()).define(["md"],(function(e){return e(Ve())})),n.variable(t("demoFunction")).define("demoFunction",(function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==n&&null==a)return[e,t,1];var r=e/t;return null==n||null!=a&&r<n/a?[a*r,a,a/t]:[n,n/r,n/e]}})),n.variable(t()).define(["md"],(function(e){return e(Be())})),n.variable(t()).define(["md"],(function(e){return e(Ue())})),n.variable(t()).define(["signature","demoFunction","signature_theme"],(function(e,t,n){return e(t,{description:"Scales dimensions proportionally to fit into the given width and/or height.",example:"const [width, height, scale] = scaleContain(img.naturalWidth, img.naturalHeight, 500, 500);",css:"\n".concat(n,"\n:scope {\n  background: LightYellow;\n  box-shadow: 1px 2px 5px -3px;\n  font-family: sans-serif;\n}\n:scope .description {\n  font-size: 1.2rem;\n  font-style: italic;\n}\n:scope .examples .code {\n  background: NavajoWhite;\n}\n  ")})})),n.variable(t()).define(["md"],(function(e){return e(Ge())}));var r=e.module(ze);return n.import("scopedStyle",r),n.variable(t()).define(["scopedStyle","signature_theme"],(function(e,t){return e(".my-shared-scope","\n".concat(t,"\n// Adds \n:scope { border: 10px solid #888 }\n"))})),n.variable(t("myCustomSig")).define("myCustomSig",["signature"],(function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e(t,Object(p.a)({scope:"my-shared-scope",css:null},n))}})),n.variable(t()).define(["myCustomSig","demoFunction"],(function(e,t){return e(t,{description:"Scales dimensions proportionally to fit into the given width and/or height.",example:"const [width, height, scale] = scaleContain(img.naturalWidth, img.naturalHeight, 500, 500);"})})),n.variable(t()).define(["md"],(function(e){return e(qe())})),n.variable(t("viewof runType")).define("viewof runType",["DOM"],(function(e){return e.select(["wait for interaction","run immediately","hide tests"])})),n.variable(t("runType")).define("runType",["Generators","viewof runType"],(function(e,t){return e.input(t)})),n.variable(t()).define(["signature","demoFunction","RUN_TESTS","runType","Promises"],(function(e,t,n,a,r){return e(t,{description:"Scales dimensions proportionally to fit into the given width and/or height.",example:"\nconst [width, height, scale] = scaleContain(img.naturalWidth, img.naturalHeight, 500, 500);\nimg.width = width;\nimg.height = height;\n",runTests:{"run immediately":!0,"hide tests":!1,"wait for interaction":n.promise}[a],tests:{"no target dimensions":function(e){({}).callUndefined();var n=t(200,150),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(200===r,"width"),e(150===i,"height"),e(1===o,"scale")},"target width only":function(){var e=Object(u.a)(s.a.mark((function e(n){var a,i,o,c,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.delay(3e3);case 2:a=t(200,150,400),i=Object(l.a)(a,3),o=i[0],c=i[1],u=i[2],n(400===o,"width"),n(300===c,"height"),n(2===u,"scale");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"target height only":function(e){var n=t(200,150,null,300),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")},"same aspect":function(e){var n=t(200,150,400,300),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")},"smaller aspect ratio":function(){var e=Object(u.a)(s.a.mark((function e(n){var a,i,o,c,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.delay(2e3);case 2:a=t(200,150,600,300),i=Object(l.a)(a,3),o=i[0],c=i[1],u=i[2],n(400===o,"width"),n(300===c,"height"),n(0===u,"scale");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"greater aspect ratio":function(e){var n=t(200,150,600,300),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")}}})})),n}function ft(){var e=Object(oe.a)(["---\n## Deprecations\n"]);return ft=function(){return e},e}function mt(){var e=Object(oe.a)(["---\n## Internals"]);return mt=function(){return e},e}function pt(){var e=Object(oe.a)(["<a href>"]);return pt=function(){return e},e}function ht(){var e=Object(oe.a)(["<style>"]);return ht=function(){return e},e}function vt(){var e=Object(oe.a)(["---\n## Markup\n"]);return vt=function(){return e},e}function bt(){var e=Object(oe.a)(["---\n## Images\n"]);return bt=function(){return e},e}function gt(){var e=Object(oe.a)(["---\n## Reactivity\n"]);return gt=function(){return e},e}function wt(){var e=Object(oe.a)(["# Toolbox\n\nA growing<sup>*</sup> library of functions for various tasks.\nThis notebook will change frequently. If you rely on it be sure to pin the version:\n","\n\n<small><sup>*</sup> <i>A bit of a mess right now as I move things around. Let's not focus on the bad things though, shall we? :D</i></small>\n\n"]);return wt=function(){return e},e}function yt(e,t){var n=e.module();n.variable(t()).define(["md","code","PINNED"],(function(e,t,n){return e(wt(),t("import {/* ... */} from '".concat(n,"'")))})),n.variable(t()).define(["md"],(function(e){return e(gt())})),n.variable(t("linkViews")).define("linkViews",(function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enumerable:!0};return Object.entries(t).forEach((function(t){var a=Object(l.a)(t,2),r=a[0],i=a[1];Object.defineProperty(e,r,Object.assign({get:function(){return i.value}},n))})),e}})),n.variable(t()).define(["md"],(function(e){return e(bt())})),n.variable(t()).define(["signature","fitSize"],(function(e,t){return e(t,{description:"Scales dimensions proportionally to fit into the given width and/or height.",example:"\nconst [width, height, scale] = fitSize(img.naturalWidth, img.naturalHeight, {width: 500, height: 500});\nimg.width = width;\nimg.height = height;\n",tests:{"no target dimensions":function(e){var n=t(200,150),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(200===r,"width"),e(150===i,"height"),e(1===o,"scale")},"target width only":function(){var e=Object(u.a)(s.a.mark((function e(n){var a,r,i,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t(200,150,{width:400}),r=Object(l.a)(a,3),i=r[0],o=r[1],c=r[2],n(400===i,"width"),n(300===o,"height"),n(2===c,"scale");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"target height only":function(e){var n=t(200,150,{height:300}),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")},"same aspect":function(e){var n=t(200,150,{width:400,height:300}),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")},"smaller aspect ratio":function(e){var n=t(200,150,{width:600,height:300}),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")},"greater aspect ratio":function(e){var n=t(200,150,{width:600,height:300}),a=Object(l.a)(n,3),r=a[0],i=a[1],o=a[2];e(400===r,"width"),e(300===i,"height"),e(2===o,"scale")}}})})),n.variable(t("fitSize")).define("fitSize",(function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.width,r=n.height;n.crop;if(null==a&&null==r)return[e,t,1];var i=e/t;return null==a||null!=r&&i<a/r?[r*i,r,r/t]:[a,a/i,a/e]}})),n.variable(t()).define(["signature","importAsset"],(function(e,t){return e(t,{description:"Imports a remote asset and returns its local URL and blob.",example:"const {blob, url} = await importAsset('https://example.com/image.png');",tests:{"import asset":function(){var e=Object(u.a)(s.a.mark((function e(n){var a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("https://en.wikipedia.org/static/favicon/wikipedia.ico");case 2:a=e.sent,r=a.blob,i=a.url,n(r instanceof Blob,"blob"),n("string"===typeof i,"url");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})})),n.variable(t("importAsset")).define("importAsset",["invalidation"],(function(e){return function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(n).then((function(e){return e.blob()})).then((function(t){var n=URL.createObjectURL(t);return e.then((function(){return URL.revokeObjectURL(n)})),{url:n,blob:t}})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),n.variable(t()).define(["signature","importImage","DOM"],(function(e,t,n){return e(t,{description:"Returns an Image for a remote src. The image has been created from an object URL and won't taint a canvas.",example:"\nconst img = await importImage('https://example.com/image.png');\nconst ctx = DOM.context2d(img.naturalWidth, img.naturalHeight, 1);\nctx.drawImage(img, 0, 0);\n  ",tests:{"tainted canvas":function(){var e=Object(u.a)(s.a.mark((function e(t){var a,r,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.element("img",{src:"https://i.imgur.com/D6H96Hc.png"}),e.next=3,a.decode();case 3:(r=n.context2d(a.naturalWidth,a.naturalHeight,1)).drawImage(a,0,0),i="";try{r.getImageData(0,0,1,1)}catch(o){i+=o}t(/^SecurityError/.test(i),"remote URL taints canvas");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"import image":function(){var e=Object(u.a)(s.a.mark((function e(a){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("https://i.imgur.com/D6H96Hc.png");case 2:r=e.sent,(i=n.context2d(r.naturalWidth,r.naturalHeight,1)).drawImage(r,0,0),o=i.getImageData(0,0,1,1).data,a(255===o[0],0===o[1],"Image can be imported and applied to canvas without tainting it");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})})),n.variable(t("importImage")).define("importImage",["DOM"],(function(e){return function(){var t=Object(u.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.element("img",{crossorigin:"anonymous",src:n}),t.abrupt("return",a.decode().then((function(){return a})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),n.variable(t()).define(["md"],(function(e){return e(vt())})),n.variable(t("querylink")).define("querylink",["DOM"],(function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=a.query,i=void 0===r?function(e){return'https://duckduckgo.com/?q="'.concat(decodeURI(e),'"')}:r,o=e.element("a",Object(p.a)({href:n.href||i(t)},n));return o.textContent=t,o}})),n.variable(t()).define((function(){return""})),n.variable(t()).define(["signature","scopedStyle"],(function(e,t){return e(t,{description:"Creates a scoped `<style>` element from CSS.",example:"\nconst namespace = DOM.uid('scope').id;\nconst style = scopedStyle('.' + namespace, `\n  :scope { font-family: sans-serif }\n  :scope, :scope > * { padding: 0 }\n`);\nreturn html`<div class=\"${namespace}\">\n  ${style}\n  <span> text ...\n`;\n"})})),n.variable(t("scopedStyle")).define("scopedStyle",["html"],(function(e){return function(t,n){var a=e(ht());return a.textContent=n.replace(/\:scope\b/g,t),a}})),n.variable(t()).define(["signature","getPinnedSlug"],(function(e,t){return e(t)})),n.variable(t("getPinnedSlug")).define("getPinnedSlug",["html"],(function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,a=void 0===n?null:n,r=t.parseVersion,i=void 0===r?"v1":r,o=function(){var e=Object(u.a)(s.a.mark((function e(t,n,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://api.observablehq.com/".concat(t,".js?v=").concat(n)).then((function(e){return e.text()})).catch((function(e){return null})).then((function(e){return null==e?[]:e.split("\n",a+1).slice(0,a)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),c={v1:function(e){return o(e,1,4).then((function(e){var t=e[0].slice("// URL: https://observablehq.com/".length).replace(/^d\//,""),n=e[3].slice("// Version: ".length);return"".concat(t,"@").concat(n)}))},v3:function(e){return o(e,3,1).then((function(e){return e[0].slice("// https://observablehq.com/".length).replace(/^d\//,"")}))}};try{var l=null!=a?a.replace(/^(?!@)/,"d/"):e(pt()).pathname.match(/^\/(d\/[a-f0-9]{16}|@[^\/]+\/[^@].*?)(?:$|\/)/)[1];return c[i](l).catch((function(e){return null}))}catch(d){return null}}})),n.variable(t()).define(["signature"],(function(e){return e("PINNED",{name:"PINNED",description:"Notebook slug, automatically pinned to the most recent version of the importing notebook.",example:'md`You can import my notebook this way:\n\\`\\`\\`javascript\nimport {foo} from "${PINNED}"\n\\`\\`\\``\n'})})),n.variable(t("PINNED")).define("PINNED",["getPinnedSlug"],(function(e){return e()})),n.variable(t()).define(["md"],(function(e){return e(mt())})),n.variable(t("readChunks")).define("readChunks",(function(){return function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,i,o,c,u,l,d,f=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:{},a=n.separator,r=void 0===a?10:a,i=n.limit,o=void 0===i?1/0:i,c=function(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n},u=[],l=new Uint8Array,d=function e(){return t.read().then((function(n){var a=n.done,i=n.value,s=-1,d=0;if(i){for(console.log("chunk size",i.length);++s<i.length;)if(i[s]===r){if(u.push(c(l,i.slice(d,s))),u.length>=o)return t.cancel(),u;d=s+1}l=i.slice(d)}return a?(u.push(l),u):e()}))},e.abrupt("return",d());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),n.variable(t("PINNED_LIB")).define("PINNED_LIB",["getPinnedSlug"],(function(e){return e({name:"691ae3b95f02db79"})})),n.variable(t("viewof RUN_TESTS")).define("viewof RUN_TESTS",["deprecateImport","viewof _dep_RUN_TESTS"],(function(e,t){return e(t,"RUN_TESTS",!1)})),n.variable(t("RUN_TESTS")).define("RUN_TESTS",["Generators","viewof RUN_TESTS"],(function(e,t){return e.input(t)})),n.variable(t()).define(["md"],(function(e){return e(ft())})),n.variable(t("deprecateImport")).define("deprecateImport",["PINNED","PINNED_LIB"],(function(e,t){return function(n,a){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"3d9d1394d858ca97";return e&&e===t?r?void 0:n:(console.warn("".concat(a,' has been moved. Import it from "').concat(i,'".')),n)}}));var a=e.module(dt);return n.import("code","_dep_code",a),n.import("signature","_dep_signature",a),n.import("signature_theme","_dep_signature_theme",a),n.import("viewof RUN_TESTS","viewof _dep_RUN_TESTS",a),n.import("RUN_TESTS","_dep_RUN_TESTS",a),n.import("createStepper","_dep_createStepper",a),n.import("defaultTestRunner","_dep_defaultTestRunner",a),n.import("defaultSignatureParser","_dep_defaultSignatureParser",a),n.variable(t("signature")).define("signature",["deprecateImport","_dep_signature"],(function(e,t){return e(t,"signature",!1)})),n.variable(t("code")).define("code",["deprecateImport","_dep_code"],(function(e,t){return e(t,"code",!1)})),n.variable(t("signature_theme")).define("signature_theme",["deprecateImport","_dep_signature_theme"],(function(e,t){return e(t,"signature_theme")})),n.variable(t("createStepper")).define("createStepper",["deprecateImport","_dep_createStepper"],(function(e,t){return e(t,"createStepper")})),n.variable(t("defaultTestRunner")).define("defaultTestRunner",["deprecateImport","_dep_defaultTestRunner"],(function(e,t){return e(t,"defaultTestRunner")})),n.variable(t("defaultSignatureParser")).define("defaultSignatureParser",["deprecateImport","_dep_defaultSignatureParser"],(function(e,t){return e(t,"defaultSignatureParser")})),n}function Et(){var e=Object(oe.a)(["## License\n\nThe code in this notebook is MIT Licensed."]);return Et=function(){return e},e}function xt(){var e=Object(oe.a)(['<span style="color:blue">SVG element</span>']);return xt=function(){return e},e}function jt(){var e=Object(oe.a)(['<span style="color:green">HTML canvas</span>']);return jt=function(){return e},e}function Ot(){var e=Object(oe.a)(['<span style="color:red"><code>regl</code> WebGL context</span>']);return Ot=function(){return e},e}function kt(){var e=Object(oe.a)(["The view below shows a ",", a ",", and a "," stacked upon each other and living together in harmony."]);return kt=function(){return e},e}function St(){var e=Object(oe.a)(["## Sample Usage"]);return St=function(){return e},e}function Mt(){var e=Object(oe.a)(["## viewportAxes\n\nRender basic SVG axes given a viewport and two `d3` scales."],["## viewportAxes\n\nRender basic SVG axes given a viewport and two \\`d3\\` scales."]);return Mt=function(){return e},e}function Nt(){var e=Object(oe.a)(["## createViewport\n\nCreate a simple representation of a viewport"]);return Nt=function(){return e},e}function Tt(){var e=Object(oe.a)(["4 \times 4"],["4 \\times 4"]);return Tt=function(){return e},e}function Pt(){var e=Object(oe.a)(["## createReglMap\n\nCreate a `regl` command to configure a single triangle covering the whole viewport. Accepts options with an optional `transform` parameter defining the name of a uniform to use as a 3d homogeneous (",") matrix uniform to be applied in the vertex shader."],["## createReglMap\n\nCreate a \\`regl\\` command to configure a single triangle covering the whole viewport. Accepts options with an optional \\`transform\\` parameter defining the name of a uniform to use as a 3d homogeneous (",") matrix uniform to be applied in the vertex shader."]);return Pt=function(){return e},e}function Rt(){var e=Object(oe.a)(["4 \times 4"],["4 \\times 4"]);return Rt=function(){return e},e}function It(){var e=Object(oe.a)(["3 \times 3"],["3 \\times 3"]);return It=function(){return e},e}function Ct(){var e=Object(oe.a)(["## createReglLinearScaleConfiguration\n\nCreate a regl command which adds 2d (",") and and 3d (",") homogeneous transformation matrices to `regl` context and uniforms. Must be invoked with two `d3` `linearScales` and a `callback`."],["## createReglLinearScaleConfiguration\n\nCreate a regl command which adds 2d (",") and and 3d (",") homogeneous transformation matrices to \\`regl\\` context and uniforms. Must be invoked with two \\`d3\\` \\`linearScales\\` and a \\`callback\\`."]);return Ct=function(){return e},e}function Lt(){var e=Object(oe.a)(["## createReglViewportConfiguration\n\nConfigure a regl viewport independent of pixel ratio given a layer stack. Returns a `regl` command which may be invoked with a `viewport` and a `callback`."],["## createReglViewportConfiguration\n\nConfigure a regl viewport independent of pixel ratio given a layer stack. Returns a \\`regl\\` command which may be invoked with a \\`viewport\\` and a \\`callback\\`."]);return Lt=function(){return e},e}function At(){var e=Object(oe.a)(["## createLayerStack\n\nCreate a stack of layers (first on bottom). Each item receives width, height, and dpi. `layerConstructors` is either an array or an object of constructors for each layer. If an array, the returned layers are referenced by index. If an object, stable ordering of keys is assumed and layers may be referenced by name."],["## createLayerStack\n\nCreate a stack of layers (first on bottom). Each item receives width, height, and dpi. \\`layerConstructors\\` is either an array or an object of constructors for each layer. If an array, the returned layers are referenced by index. If an object, stable ordering of keys is assumed and layers may be referenced by name."]);return At=function(){return e},e}function _t(){var e=Object(oe.a)(["## reglCanvasWithOptions\n\nA convenience function to reduce boilerplate by currying arguments. To create a function which strictly accepts `width`, `height`, and `dpi`, e.g.\n\n```js\nfn = (width, height, dpi) => reglCanvas(width, height, dpi, { ...reglOptions })\n```\n\nyou may instead write\n\n```js\nfn = reglCanvasWithOptions({ ...reglOptions })\n```\n"],["## reglCanvasWithOptions\n\nA convenience function to reduce boilerplate by currying arguments. To create a function which strictly accepts \\`width\\`, \\`height\\`, and \\`dpi\\`, e.g.\n\n\\`\\`\\`js\nfn = (width, height, dpi) => reglCanvas(width, height, dpi, { ...reglOptions })\n\\`\\`\\`\n\nyou may instead write\n\n\\`\\`\\`js\nfn = reglCanvasWithOptions({ ...reglOptions })\n\\`\\`\\`\n"]);return _t=function(){return e},e}function Dt(){var e=Object(oe.a)(["## reusableReglCanvas"]);return Dt=function(){return e},e}function Ft(){var e=Object(oe.a)(["## reglCanvas\n\nCreate a [regl](https:/github.com/regl-project/regl) canvas using syntax which roughly mirrors that of [@observablehq/stdlib's DOM.context2d method](https://github.com/observablehq/stdlib)."]);return Ft=function(){return e},e}function zt(){var e=Object(oe.a)(["\n- It should use x0, y0, x1, y1 for the viewport. Not margins. Much more portable, except for the fact that you have to carry around the DPI along with it.\n- ~~It should add a WebGL context to an SVG as a foreign object, if possible. The reason I focused on stacking them is that WebGL contexts are limited and sooner or later you make subplots or layers and regret needing many WebGL contexts in a single plot. I was trying to make heavy use of viewports and scissoring for the sake of efficiency and minimizing contexts, but I could still do that and play the SVG game a bit better.~~\n- Update: WebGL *does not* play well with SVG as a foreign object. There are some really obscure rendering bugs that prevent WebGL contexts from obeying last-on-top SVG-style ordering. My conclusion is that it is *not*, in fact, wise to go overboard with fanciness and instead to just layer the elements.\n"]);return zt=function(){return e},e}function qt(){var e=Object(oe.a)(["~~~javascript\nimport { reglCanvas } from '","'\n~~~"]);return qt=function(){return e},e}function Gt(){var e=Object(oe.a)(['<div style="border:1px solid black; border-radius: 3px; padding: 10px; max-width:640px;">\ud83d\udc49<em style="color:#c22">NOTE:</em> I\'m learning Observable! You should <a href="https://observablehq.com/@bryangingechen/version-pinning-for-notebooks">pin the version</a> if you use any functions herein:\n\n',"\n\nThis notebook is highly subject to changes and regrets. My biggest current regrets are:\n","</span>"]);return Gt=function(){return e},e}function Ut(){var e=Object(oe.a)(["# regl-tools\n\nThis notebook implements a number of helper methods for simple regl, canvas and SVG plots in Observable. The goal is simple: to the extent reasonably possible, creating plots should contain information about the particular plot, not about setup and rendering.\n\nTo this end, it uses `d3` scales and makes some opinionated choices about how to represent things, though the result is hopefully general enough that it's more useful than constraining."],["# regl-tools\n\nThis notebook implements a number of helper methods for simple regl, canvas and SVG plots in Observable. The goal is simple: to the extent reasonably possible, creating plots should contain information about the particular plot, not about setup and rendering.\n\nTo this end, it uses \\`d3\\` scales and makes some opinionated choices about how to represent things, though the result is hopefully general enough that it's more useful than constraining."]);return Ut=function(){return e},e}function Bt(e,t){var n=e.module();n.variable(t()).define(["md"],(function(e){return e(Ut())})),n.variable(t()).define(["html","md","PINNED"],(function(e,t,n){return e(Gt(),t(qt(),n),t(zt()))}));var a=e.module(se);n.import("createReglCamera",a),n.import("createInteractions",a),n.variable(t()).define(["md"],(function(e){return e(Ft())})),n.variable(t("reglCanvas")).define("reglCanvas",["createREGL"],(function(e){return function(t,n,a,r){a=void 0===a?devicePixelRatio:a,r=r||{};var i=document.createElement("canvas");i.width=a*t,i.height=a*n,i.style.width=t+"px";var o=e(Object.assign({},r,{pixelRatio:a,canvas:i}));return i.value=o,i.__reglConfig={dpi:a,reglOptions:r},i}})),n.variable(t()).define(["md"],(function(e){return e(Dt())})),n.variable(t("reusableReglCanvas")).define("reusableReglCanvas",["width","reglCanvas"],(function(e,t){return function(n,a){var r=void 0===a.dpi?devicePixelRatio:a.dpi,i=a.reglOptions||{},o={dpi:r,reglOptions:i};return n&&JSON.stringify(o)===JSON.stringify(n.__reglConfig)?(n.width=Math.floor(a.width*r),n.height=Math.floor(a.height*r),n.style.width="".concat(e,"px"),n):(n&&n.value&&n.value.destroy&&(n.value.destroy(),delete n.value),t(a.width,a.height,r,i))}})),n.variable(t()).define(["md"],(function(e){return e(_t())})),n.variable(t("reglCanvasWithOptions")).define("reglCanvasWithOptions",["reglCanvas"],(function(e){return function(t){return function(n,a,r){return e(n,a,r,t)}}})),n.variable(t("getOrAttachReglFO")).define("getOrAttachReglFO",["createREGL"],(function(e){return function(t,n,a,r,i){var o=t.selectAll(".regl-canvas").data([null]).join((function(e){return e.append("foreignObject")})).attr("class","regl-canvas").attr("width",n).attr("height",a);o.selectAll("canvas").data([null]).join((function(e){return e.append("xhtml:canvas")})).attr("width",n*r).attr("height",a*r).style("width",n+"px").style("height",a+"px");var c=o.select("canvas").node(),s=c.value=c.value||e(Object.assign(i||{},{canvas:c,pixelRatio:r}));return s.data=s.data||{},c}})),n.variable(t()).define(["md"],(function(e){return e(At())})),n.variable(t("createLayerStack")).define("createLayerStack",["Element"],(function(e){return function(t,n,a,r){t=Math.floor(t),n=Math.floor(n),a=void 0===a?devicePixelRatio:a;var i,o=Math.floor(t*a),c=Math.floor(n*a),s=document.createElement("div");function u(r,i){var o,c=r(t,n,a);return c instanceof e?c=(o=c).value||o:o=c.canvas||c,o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.width="100%",o.style.height="100%",o.style.zIndex=i,s.appendChild(o),c}if(s.style.position="relative",s.style.width=t+"px",s.style.height=n+"px",Array.isArray(r))i=r.map(u);else{var l=Object.keys(r);i={},l.forEach((function(e,t){i[e]=u(r[e],t)}))}return{layers:i,container:s,dpiWidth:o,dpiHeight:c,dpi:a,width:t,height:n}}})),n.variable(t()).define(["md"],(function(e){return e(Lt())})),n.variable(t("createReglViewportConfiguration")).define("createReglViewportConfiguration",["mat3create"],(function(e){return function(t){e();var n=t({scissor:{enable:!0,box:{x:function(e,t){return e.pixelRatio*t.margin.l},y:function(e,t){return e.pixelRatio*t.margin.b},width:function(e,t){return e.framebufferWidth-e.pixelRatio*(t.margin.r+t.margin.l)},height:function(e,t){return e.framebufferHeight-e.pixelRatio*(t.margin.t+t.margin.b)}}},viewport:{x:function(e,t){return e.pixelRatio*t.margin.l},y:function(e,t){return e.pixelRatio*t.margin.b},width:function(e,t){return e.framebufferWidth-e.pixelRatio*(t.margin.r+t.margin.l)},height:function(e,t){return e.framebufferHeight-e.pixelRatio*(t.margin.t+t.margin.b)}},uniforms:{viewportResolution:function(e,t){return[e.viewportWidth,e.viewportHeight]},framebufferResolution:function(e){return[e.framebufferWidth,e.framebufferHeight]},inverseViewportResolution:function(e,t){return[1/e.viewportWidth,1/e.viewportHeight]},inverseFramebufferResolution:function(e){return[1/e.framebufferWidth,1/e.framebufferHeight]}}});return function(e,t){n(e,t)}}})),n.variable(t()).define(["md","tex"],(function(e,t){return e(Ct(),t(It()),t(Rt()))})),n.variable(t("createReglLinearScaleConfiguration")).define("createReglLinearScaleConfiguration",["mat3create","mat4create","mat3fromLinearScales","mat3invert","mat4fromMat3"],(function(e,t,n,a,r){return function(i){var o={view3:e(),inverseView3:e(),view:t(),inverseView:t()},c=i({context:{view3:i.prop("view3"),inverseView3:i.prop("inverseView3"),view:i.prop("view"),inverseView:i.prop("inverseView")},uniforms:{view3:i.prop("view3"),inverseView3:i.prop("inverseView3"),view:i.prop("view"),inverseView:i.prop("inverseView")}});return function(e,t,i){n(o.view3,e,t),a(o.inverseView3,o.view3),r(o.view,o.view3),r(o.inverseView,o.inverseView3),c(o,i)}}})),n.variable(t()).define(["md","tex"],(function(e,t){return e(Pt(),t(Tt()))})),n.variable(t("createReglMap")).define("createReglMap",(function(){return function(e,t){var n=void 0===(t=t||{}).transform?"inverseView":t.transform;return e({vert:"\n      precision highp float;\n      ".concat(n?"uniform mat4 ".concat(n,";"):"","\n      attribute vec2 aUV;\n      varying vec2 xy;\n      void main () {\n        xy = ").concat(n?"(".concat(n," * vec4(aUV, 0, 1)).xy"):"aUV",";\n        gl_Position = vec4(aUV, 0, 1);\n      }"),attributes:{aUV:[-4,-4,4,-4,0,4]},depth:{enable:!1},primitive:"triangles",count:3})}})),n.variable(t("mat3ViewportFromLinearScales")).define("mat3ViewportFromLinearScales",(function(){return function(e,t,n){var a=t.range(),r=n.range(),i=a[1]-a[0],o=r[0]-r[1];return e[0]=.5*i,e[1]=0,e[2]=0,e[3]=0,e[4]=-.5*o,e[5]=0,e[6]=.5*i+a[0],e[7]=.5*o+r[1],e[8]=1,e}})),n.variable(t("mat3fromLinearScales")).define("mat3fromLinearScales",(function(){return function(e,t,n){var a=t.domain(),r=n.domain(),i=2/(a[1]-a[0]),o=2/(r[1]-r[0]);return e[0]=i,e[1]=0,e[2]=0,e[3]=0,e[4]=o,e[5]=0,e[6]=-1-i*a[0],e[7]=-1-o*r[0],e[8]=1,e}})),n.variable(t()).define(["md"],(function(e){return e(Nt())})),n.variable(t("createViewport")).define("createViewport",(function(){return function(e,t){return{width:e.width,height:e.height,dpi:e.dpi,margin:Object.assign({t:0,r:0,b:0,l:0},t||{})}}})),n.variable(t()).define(["md"],(function(e){return e(Mt())})),n.variable(t("viewportAxes")).define("viewportAxes",["d3"],(function(e){return function(t,n,a,r){r=r||{},t.margin=void 0===t.margin?{t:0,r:0,b:0,l:0}:t.margin,r.xLabelSpacing=void 0===r.xLabelSpacing?80:r.xLabelSpacing,r.yLabelSpacing=void 0===r.yLabelSpacing?80:r.yLabelSpacing;var i=void 0===r.xAxis?e.axisBottom:r.xAxis,o=void 0===r.yAxis?e.axisLeft:r.yAxis,c=n.range(),s=n.range();return t.width=void 0===t.width?c[1]-c[0]:t.width,t.height=void 0===t.height?s[1]-s[0]:t.height,function(e){var c=e.select("g.x.axis");c.empty()&&(c=e.append("g").attr("class","x axis")),c.attr("transform","translate(0,"+(t.height-t.margin.b)+")").call(i(n).ticks(Math.floor((t.width-t.margin.l-t.margin.r)/r.xLabelSpacing)));var s=e.select("g.y.axis");return s.empty()&&(s=e.append("g").attr("class","y axis")),s.attr("transform","translate("+t.margin.l+", 0)").call(o(a).ticks(Math.floor((t.height-t.margin.t-t.margin.b)/r.yLabelSpacing))),e}}})),n.variable(t("constrainLinearScaleAspectRatio")).define("constrainLinearScaleAspectRatio",(function(){return function(e,t,n){var a=e.domain(),r=t.domain(),i=e.range(),o=t.range(),c=a[1]-a[0],s=i[1]-i[0],u=r[1]-r[0],l=(o[1]-o[0])/u,d=s/c,f=Math.abs(d/l),m=.5*(a[0]+a[1]);return e.domain([m-.5*c*f/n,m+.5*c*f/n]),e}})),n.variable(t("persistentZoom")).define("persistentZoom",["d3"],(function(e){return function(t,n,a,r,i){return e.zoom().on("zoom",(function(){var i,o=e.event.transform;i=t.range().map(o.invertX,o),t.domain(a.domain()),t.domain(i.map(t.invert,t)),i=n.range().map(o.invertY,o),n.domain(r.domain()),n.domain(i.map(n.invert,n))}))}})),n.variable(t("createTextureLookupTable")).define("createTextureLookupTable",(function(){return function(e,t,n){for(var a=e*t*(n=n||2),r=new Float32Array(a),i=0,o=0;o<a;i++,o+=n)r[o]=(i%e+.5)/e,r[o+1]=(.5+(i/e|0))/t;return r}})),n.variable(t("canWriteToFBOOfType")).define("canWriteToFBOOfType",(function(){return function(e,t){if(t=t||"float",!e.hasExtension("oes_texture_".concat(t.replace(" ","_"))))return!1;try{e.framebuffer({colorType:t,colorFormat:"rgba",radius:1});var n,a=e.framebuffer({colorType:"uint8",colorFormat:"rgba",radius:1}),r=e({vert:"\n      precision highp float;\n      attribute vec2 aXY;\n      void main () {\n        gl_Position = vec4(aXY, 0, 1);\n        gl_PointSize = 1.0;\n      }",frag:"\n      precision highp float;\n      void main () {\n        gl_FragColor = vec4(1, 0, 0, 1);\n      }",primitive:"points",count:1,attributes:{aXY:[0,0]},depth:{enable:!1}}),i=e({vert:"\n      precision highp float;\n      attribute vec2 aXY;\n      void main () {\n        gl_Position = vec4(aXY, 0, 1);\n      }",frag:"\n      precision highp float;\n      void main () {\n        gl_FragColor = vec4(1, 0, 0, 1);\n      }",attributes:{aXY:[-4,-4,4,-4,0,4]},count:3,primitive:"triangles",depth:{enable:!1}});return r(),a.use((function(){i(),n=e.read()})),0!==n[0]&&0===n[1]&&0===n[2]&&0!==n[3]}catch(o){return!1}}})),n.variable(t()).define(["md"],(function(e){return e(St())})),n.variable(t("stack")).define("stack",["createLayerStack","width","height","reglCanvas","DOM"],(function(e,t,n,a,r){return e(t,n,devicePixelRatio,{regl:function(e,t,n){return a(e,t,n)},canvas:r.context2d,svg:r.svg})})),n.variable(t("viewport")).define("viewport",["createViewport","stack"],(function(e,t){return e(t,{t:10,r:15,b:22,l:37})})),n.variable(t()).define(["md","html"],(function(e,t){return e(kt(),t(Ot()),t(jt()),t(xt()))})),n.variable(t()).define(["stack","d3","viewport","constrainLinearScaleAspectRatio","viewportAxes","configureViewport","configureLinearScales","drawStrip","mat3multiply","mat3create","mat3ViewportFromLinearScales","mat3fromLinearScales","vec2transformMat3"],s.a.mark((function e(t,n,a,r,i,o,c,u,l,d,f,m,p){var h,v,b,g,w,y,E,x,j,O;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=t.layers.regl,v=t.layers.canvas,b=n.select(t.layers.svg),g=n.scaleLinear().domain([-3,3]).range([a.margin.l,a.width-a.margin.r]).clamp(!0),w=r(n.scaleLinear().domain([-1.5,1.5]).range([a.height-a.margin.b,a.margin.t]).clamp(!0),g,1),E=[[1,-1],[1,1],[-1,-1],[-1,1]],x=h.buffer(E),b.selectAll("g.axes").remove(),b.append("g").attr("class","axes").call(i(a,g,w)),j=b.selectAll("g.handles").remove(),j=b.selectAll("g.handles").data([E]).enter().append("g").attr("class","handles"),O=j.selectAll("circle").data((function(e){return e})).enter().append("circle").attr("cursor","move").attr("r",5).attr("stroke-width",30).attr("stroke","transparent").attr("fill","blue").call(n.drag().on("drag",(function(e){e[0]=g.invert(n.event.x),e[1]=w.invert(n.event.y),y()}))),(y=function(){O.attr("cx",(function(e){return g(e[0])})).attr("cy",(function(e){return w(e[1])})),x.subdata(E),h.poll(),h.clear({color:[1,1,1,1]}),o(a,(function(e){e.viewport3;c(g,w,(function(e){e.view3;u({points:x,count:E.length})}))}));var e=l(d(),f(d(),g,w),m(d(),g,w));v.clearRect(0,0,t.width,t.height),v.beginPath(),v.lineWidth=4,v.strokeStyle="#3a3",v.moveTo.apply(v,p([],E[1],e)),v.lineTo.apply(v,p([],E[2],e)),v.moveTo.apply(v,p([],E[3],e)),v.lineTo.apply(v,p([],E[0],e)),v.stroke()})(),e.next=16,t.container;case 16:case"end":return e.stop()}}),e)}))),n.variable(t("configureLinearScales")).define("configureLinearScales",["createReglLinearScaleConfiguration","regl"],(function(e,t){return e(t)})),n.variable(t("regl")).define("regl",["stack"],(function(e){return e.layers.regl})),n.variable(t("height")).define("height",["width"],(function(e){return.5*e})),n.variable(t("configureViewport")).define("configureViewport",["createReglViewportConfiguration","regl"],(function(e,t){return e(t)})),n.variable(t("drawStrip")).define("drawStrip",["regl"],(function(e){return e({vert:"\n    precision highp float;\n    uniform mat4 view;\n    attribute vec2 xy;\n    void main () {\n      gl_Position = view * vec4(xy, 0, 1);\n    }",frag:"\n    precision highp float;\n    void main () {\n      gl_FragColor = vec4(1.0, 0.8, 0.8, 1);\n    }",attributes:{xy:e.prop("points")},primitive:"triangle strip",depth:{enable:!1},count:e.prop("count")})})),n.variable(t("d3")).define("d3",["require"],(function(e){return e("d3@5")})),n.variable(t("createREGL")).define("createREGL",["require"],(function(e){return e("regl")}));var r=e.module(he);n.import("mat4create",r),n.import("mat4fromMat3",r);var i=e.module(xe);n.import("mat3create",i),n.import("mat3invert",i),n.import("mat3multiply",i);var o=e.module(Te);n.import("vec2transformMat3",o);var c=e.module(yt);return n.import("PINNED",c),n.variable(t()).define(["md"],(function(e){return e(Et())})),n.variable(t("LICENSE")).define("LICENSE",(function(){return"mit"})),n}function Vt(e,t){var n=e.module();n.variable(t("viewof regl")).define("viewof regl",["createREGL","invalidation"],(function(e,t){console.log("reloaded");var n=devicePixelRatio,a=document.createElement("canvas");a.width=Math.floor(280*n),a.height=Math.floor(500*n),a.style.width="".concat(120,"px"),a.style.height="".concat(125,"px");var r=e({canvas:a,pixelRatio:n,extensions:["OES_standard_derivatives"],optionalExtensions:["OES_element_index_uint"]});return a.value=r,t.then((function(){return r.destroy()})),a})),n.variable(t("regl")).define("regl",["Generators","viewof regl"],(function(e,t){return e.input(t)})),n.variable(t("time")).define("time",(function(){return 3})),n.variable(t()).define((function(){return window.scrollY})),n.variable(t("opacity")).define("opacity",(function(){return.85})),n.variable(t("passes")).define("passes",(function(){return["Solid surface pass","Fake transparency pass"]})),n.variable(t("gridOpacity")).define("gridOpacity",(function(){return 0})),n.variable(t("gridWidth")).define("gridWidth",(function(){return.5})),n.variable(t("cartoonEdgeWidth")).define("cartoonEdgeWidth",(function(){return 2.5})),n.variable(t("cartoonEdgeOpacity")).define("cartoonEdgeOpacity",(function(){return 1})),n.variable(t("specular")).define("specular",(function(){return 1})),n.variable(t()).define(["camera","buffers","opacity","specular","cartoonEdgeWidth","cartoonEdgeOpacity","gridWidth","gridOpacity","regl","setUniforms","passes","drawMesh","invalidation"],(function(e,t,n,a,r,i,o,c,s,u,l,d,f){e.taint();var m={buffers:t,opacity:n,specular:a,cartoonEdgeWidth:r,cartoonEdgeOpacity:i,gridWidth:o,gridOpacity:c},h=s.frame((function(){e((function(e){e.dirty&&u((function(){s.clear({color:[1,1,1,1]}),~l.indexOf("Solid surface pass")&&d(Object(p.a)(Object(p.a)({},m),{},{solidPass:!0})),~l.indexOf("Fake transparency pass")&&d(Object(p.a)(Object(p.a)({},m),{},{solidPass:!1}))}))}))}));f.then((function(){return h.cancel()}))})),n.variable(t("createREGL")).define("createREGL",["require"],(function(e){return e("regl")})),n.variable(t("mesh")).define("mesh",["meshFromFunction"],(function(e){return e((function(e,t){return[e,t]}),{resolution:[151,151],uDomain:[0,1.5],vDomain:[-Math.PI,Math.PI],uPeriodic:!1,vPeriodic:!0})})),n.variable(t("drawMesh")).define("drawMesh",["regl"],(function(e){return e({vert:"\n    precision highp float;\n    attribute vec2 uv;\n    uniform mat4 projection, view;\n    varying vec3 vPosition, vNormal;\n    varying vec2 vUV;\n    uniform float time;\n\n    // Our function!\n    vec3 f(vec2 uv) {\n      float r2 = dot(uv, uv);\n      float s = 8.0 * sqrt(r2);\n      float t = time * 4.0;\n      return vec3(\n        uv.x,\n        -4.0 / sqrt(t*t+ s * s),\n        uv.y\n      );\n    }\n\n    void main () {\n      vUV = uv.x * vec2(cos(uv.y), sin(uv.y));\n      vPosition = f(vUV);\n\n      // We differentiate the surface numerically to get the partial\n      // derivative wrt u and v, then take the cross product to get\n      // the surface normal.\n      float dx = 1e-2;\n      vec3 dpdu = f(vUV + vec2(dx, 0)) - vPosition;\n      vec3 dpdv = f(vUV + vec2(0, dx)) - vPosition;\n      vNormal = normalize(cross(dpdu, dpdv));\n\n      gl_Position = projection * view * vec4(vPosition, 1);\n    }\n  ",frag:"\n    #extension GL_OES_standard_derivatives : enable\n    precision highp float;\n    varying vec3 vPosition, vNormal;\n    uniform vec3 eye;\n    uniform bool solidPass;\n    varying vec2 vUV;\n    uniform float pixelRatio, opacity, cartoonEdgeWidth, gridOpacity, specular, cartoonEdgeOpacity, gridWidth;\n\n    // This function implements a constant-width grid as a function of\n    // a two-dimensional input. This makes it possible to draw a grid\n    // which does not line up with the triangle edges.\n    // from: https://github.com/rreusser/glsl-solid-wireframe\n    float gridFactor (vec2 parameter, float width, float feather) {\n      float w1 = width - feather * 0.5;\n      vec2 d = fwidth(parameter);\n      vec2 looped = 0.5 - abs(mod(parameter, 1.0) - 0.5);\n      vec2 a2 = smoothstep(d * w1, d * (w1 + feather), looped);\n      return min(a2.x, a2.y);\n    }\n\n    void main () {\n      vec3 normal = normalize(vNormal);\n\n      // The dot product of the view direction and surface normal.\n      float vDotN = abs(dot(normal, normalize(vPosition - eye)));\n\n      // We divide vDotN by its gradient magnitude in screen space to\n      // give a function which goes roughly from 0 to 1 over a single\n      // pixel right at glancing angles. i.e. cartoon edges!\n      float cartoonEdge = smoothstep(0.75, 1.25, vDotN / fwidth(vDotN) / (cartoonEdgeWidth * pixelRatio));\n\n      // Combine the gridlines and cartoon edges\n      float grid = gridFactor(vUV * 10.0, 0.5 * gridWidth * pixelRatio, 0.5);\n      float combinedGrid = max(cartoonEdgeOpacity * (1.0 - cartoonEdge), gridOpacity * (1.0 - grid));\n\n      if (solidPass) {\n        // If the surface pass, we compute some shading\n        float shade = 0.2 + mix(1.2, specular * pow(vDotN, 3.0), 0.5);\n        vec3 colorFromNormal = (0.5 - (gl_FrontFacing ? 1.0 : -1.0) * 0.5 * normal);\n        vec3 baseColor = gl_FrontFacing ? vec3(12.0/255.0, 80.0/255.0, 255.0/255.0) : vec3(255.0/255.0, 116.0/255.0, 241.0/255.0);\n\n        vec3 color = shade * mix(\n            baseColor,\n            colorFromNormal,\n            0.0\n          );\n        // Apply the gridlines\n        color = mix(color, vec3(0), opacity * combinedGrid);\n        gl_FragColor = vec4(pow(color, vec3(0.454)), 1.0);\n      } else {\n        // If the wireframe pass, we just draw black lines with some alpha\n        gl_FragColor = vec4(\n          // To get the opacity to mix ~correctly, we use reverse-add blending mode\n          // so that white here shows up as black gridlines. This could be simplified\n          // by doing a bit more math to get the mixing right with just additive blending.\n          vec3(1),\n          (1.0 - opacity) * combinedGrid\n        );\n\n        if (gl_FragColor.a < 1e-3) discard;\n      }\n    }\n  ",primitive:"triangles",uniforms:{solidPass:e.prop("solidPass"),opacity:e.prop("opacity"),cartoonEdgeWidth:e.prop("cartoonEdgeWidth"),cartoonEdgeOpacity:e.prop("cartoonEdgeOpacity"),gridOpacity:e.prop("gridOpacity"),gridWidth:e.prop("gridWidth"),specular:e.prop("specular")},attributes:{uv:e.prop("buffers.uv")},depth:{enable:e.prop("solidPass")},blend:{enable:function(e,t){return!t.solidPass},func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:1,dstAlpha:1},equation:{rgb:"reverse subtract",alpha:"add"}},elements:e.prop("buffers.elements")})})),n.variable(t("setUniforms")).define("setUniforms",["regl","time"],(function(e,t){return e({uniforms:{projection:e.context("projection"),view:e.context("view"),eye:e.context("eye"),pixelRatio:e.context("pixelRatio"),time:function(e,n){return t}}})})),n.variable(t("buffers")).define("buffers",["regl","mesh","invalidation"],(function(e,t,n){var a=e.buffer(t.positions.flat()),r=e.elements(t.cells.flat());return n.then((function(){a.destroy(),r.destroy()})),{uv:a,elements:r}})),n.variable(t("meshFromFunction")).define("meshFromFunction",(function(){return function(e,t){var n,a,r,i,o=void 0===(t=t||{}).resolution?11:t.resolution,c=Array.isArray(t.resolution)?t.resolution[0]:o,s=Array.isArray(t.resolution)?t.resolution[1]:o,u=void 0===t.uDomain?[0,1]:t.uDomain,l=void 0===t.vDomain?[0,1]:t.vDomain,d=c,f=s;t.vPeriodic||(d+=1),t.uPeriodic||(f+=1);var m=[],p=[];for(n=0;n<d;n++)for(r=u[0]+(u[1]-u[0])*n/c,a=0;a<f;a++)i=l[0]+(l[1]-l[0])*a/s,m.push(e(r,i));for(n=0;n<c;n++){var h=n+1;for(t.vPeriodic&&(h%=c),a=0;a<s;a++){var v=a+1;t.uPeriodic&&(v%=s),p.push([n+d*a,h+d*a,h+d*v]),p.push([n+d*a,h+d*v,n+d*v])}}return{positions:m,cells:p}}})),n.variable(t("camera")).define("camera",["createReglCamera","regl","phi"],(function(e,t,n){return e(t,{distance:10,phi:n,theta:0})})),n.variable(t("phi")).define("phi",(function(){return 0}));var a=e.module(Bt);return n.import("createReglCamera",a),n.import("createInteractions",a),n.variable(t("LICENSE")).define("LICENSE",(function(){return"mit"})),n}var Ht=function(){var e=Object(a.useRef)(),t=Object(a.useState)(),n=Object(l.a)(t,2),i=n[0],o=n[1];return Object(a.useEffect)((function(){var t=(new ie.b).module(Vt,(function(t){return"viewof regl"===t?ie.a.into(e.current.querySelector(".viewof-regl"))():["drawMesh","setUniforms","buffers","camera"].includes(t)}));t.redefine("phi",1.6),t.redefine("time",3),o(t)}),[]),Object(a.useEffect)((function(){var e=function(){var e=window.scrollY>100?1:window.scrollY/100,t=1.6-1.21*e,n=3-2.57*e;i.redefine("phi",t),i.redefine("time",n)};return window.addEventListener("scroll",e),function(){window.removeEventListener("scroll",e)}}),[i]),r.a.createElement("div",{className:"FakeTransparencyForDSurfaces",ref:e},r.a.createElement("div",{className:"viewof-regl"}))},Wt=n(25),Yt=(Wt.format(","),Wt.format(",.0f")),Xt=Wt.format(",.3f"),Qt=Wt.format(",.1f");var Zt=Object(f.h)((function(e){var t=e.miners,n=e.client,i=e.actors,o=e.head,c=(i&&n.computeEconomics(o,i,{projectedDays:1}),Object(a.useState)({})),s=Object(l.a)(c,2),u=s[0],f=s[1];Object(a.useEffect)((function(){f(t)}),[t]);var m=0;return Object(a.useEffect)((function(){if(n&&o&&i){console.log("reload miners list",m++);var e=!0,t=function(t){e&&f(t)};return Object.keys(u).forEach((function(e){n.updateMinerMarketInfo(u,e,t,o)})),function(){e=!1}}}),[n,o,i]),r.a.createElement("section",{id:"market",className:"container"},r.a.createElement("div",{class:"section minerbar"},r.a.createElement("div",{class:"minerId"},r.a.createElement(d.b,{to:"/market"},"Market"))),r.a.createElement("div",{id:"actors",className:"section"},r.a.createElement("div",{className:"grid"},r.a.createElement(J,{title:i&&r.a.createElement(r.a.Fragment,null,Xt(+i.Market.State.TotalProviderLockedCollateral/1e18),r.a.createElement($,null)),desc:"Provider Collateral"}),r.a.createElement(J,{title:i&&r.a.createElement(r.a.Fragment,null,Xt(+i.Market.State.TotalClientStorageFee/1e18),r.a.createElement($,null)),desc:"Client Storage Fee"}),r.a.createElement(J,{title:i&&r.a.createElement(r.a.Fragment,null,Yt(+i.Market.State.NextID)),desc:"Total deals"})),"These numbers are approximate projections based on the current network state and may be incorrect, do your own research."),r.a.createElement("div",{className:"section"},r.a.createElement("h3",null,"Asks")),r.a.createElement("div",{className:"spacerace card section"},r.a.createElement("div",{className:"card-body"},r.a.createElement("table",{className:"table table-sm space table-borderless"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"#"),r.a.createElement("th",{scope:"col"},"Miner"),r.a.createElement("th",{scope:"col"},"Power"),r.a.createElement("th",{scope:"col"},"Ask"))),r.a.createElement("tbody",null,u&&t&&Object.keys(t).map((function(e,n){return r.a.createElement("tr",{key:n},r.a.createElement("th",{scope:"row"},n+1),r.a.createElement("td",{align:"right",className:"minerAddress"},r.a.createElement(d.b,{to:"/miners/".concat(t[e].address)},t&&t[e]&&t[e].address)),r.a.createElement("td",{align:"right"},Qt(u[e]&&+u[e].rawBytePower/Math.pow(2,50))," ","PiB"),r.a.createElement("td",{align:"right"},u[e]&&u[e].ask?+u[e].ask.Error?"no price":"".concat(Xt(+u[e].ask.Price/1e18*2880*30*1024)," TiB/month"):r.a.createElement("div",{className:"gradient"})))})))))))}));function Kt(e){var t=e.deadline,n=e.head,a=t;return r.a.createElement("div",{className:"deadlines windowpost"},r.a.createElement("div",{className:0===a.LiveSectors?"deadline opacity5":"deadline"},r.a.createElement("div",{className:"out"},"In ",a.Close-n.Height),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(32*a.LiveSectors/1024)," TiB"),r.a.createElement("div",{className:"hdds"},Object(h.a)(Array(Math.ceil(Math.round(32*a.LiveSectors/1024-+a.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd"}," ")})),Object(h.a)(Array(Math.ceil(Math.round(+a.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd faulty"}," ")}))))))}var Jt=n(25).format(",.2f");function $t(e){var t=e.client,n=e.spa,i=e.head,o=e.miners,c=Object(a.useState)({}),f=Object(l.a)(c,2),m=f[0],h=f[1],v=Object(a.useState)({}),b=Object(l.a)(v,2),g=b[0],w=b[1],y=Object(a.useState)(),E=Object(l.a)(y,2),x=E[0],j=E[1],O=Object(a.useState)(),k=Object(l.a)(O,2),S=k[0],M=k[1];return Object(a.useEffect)((function(){i&&function(){var e=Object(u.a)(s.a.mark((function e(){var n,a,r,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){var e=Object(u.a)(s.a.mark((function e(n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchTipsetHead(i.Height-n);case 2:return a=e.sent,e.next=5,t.fetchPower(a);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=3,Promise.all([n(60),n(120)]);case 3:return a=e.sent,r=Object(l.a)(a,2),o=r[0],c=r[1],e.next=9,j(o);case 9:return e.next=11,M(c);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[i]),Object(a.useEffect)((function(){var e=!0;if(i){var n=Object.keys(o).slice(0,40).map((function(e){return o[e].address}));return A()(5,n,function(){var n=Object(u.a)(s.a.mark((function n(a){var r,o,c;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.fetchDeadlines(a,i);case 4:if(r=n.sent,e){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,t.fetchTipsetHead(i.Height-2880);case 9:if(o=n.sent,e){n.next=12;break}return n.abrupt("return");case 12:return n.next=14,t.fetchDeadlines(a,o);case 14:if(c=n.sent,e){n.next=17;break}return n.abrupt("return");case 17:return m[a]=r,g[a]=c,n.next=21,h(Object(p.a)({},m));case 21:return n.next=23,w(Object(p.a)({},g));case 23:return n.abrupt("return",n.sent);case 24:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),function(){e=!1}}}),[t,i,o]),r.a.createElement("section",{className:"container"},r.a.createElement("div",{id:"deposits",className:"section"},r.a.createElement("div",{className:"grid"},n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(J,{title:Jt(parseInt(n.TotalQualityAdjPower)/0x4000000000000),desc:"Total QA Power"})),x&&n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(J,{title:Jt(parseInt(n.TotalQualityAdjPower-x.TotalQualityAdjPower)/0x4000000000000),desc:"60 Epochs delta"})),S&&n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(J,{title:Jt(parseInt(n.TotalQualityAdjPower-S.TotalQualityAdjPower)/0x4000000000000),desc:"120 Epochs delta"})))),"Listing WindowPoSt duties of the top 50 miners.",o&&Object.keys(o).slice(0,40).map((function(e,t){return r.a.createElement("div",{className:"flex",key:t},r.a.createElement(d.b,{to:"/miners/".concat(o[e].address)},o[e].address),m&&m[o[e].address]&&r.a.createElement(Kt,{head:i,deadline:m[o[e].address].nextDeadlines[47]}),g&&g[o[e].address]&&r.a.createElement(Kt,{head:i,deadline:g[o[e].address].nextDeadlines[47]}))})))}function en(e){var t=e.minerId,n=e.deadlines,a=e.head,i=e.link,o=e.out;return i||(i=function(e){return"/miners/".concat(t,"/deadlines/").concat(e.Index)}),o||(o=function(e){var t=e.d,n=e.head;e.i;return"In ".concat(t.Close-n.Height)}),a&&n?r.a.createElement("div",{className:"deadlines windowpost"},n&&n.map((function(e,t){return r.a.createElement("div",{key:t,className:0===e.LiveSectors?"deadline opacity5":"deadline"},r.a.createElement(d.b,{to:i(e)},r.a.createElement("div",{className:"out"},o({d:e,head:a,i:t})),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(32*e.LiveSectors/1024)," TiB"),r.a.createElement("div",{className:"hdds"},Object(h.a)(Array(Math.ceil(Math.round(32*e.LiveSectors/1024-+e.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd"}," ")})),Object(h.a)(Array(Math.ceil(Math.round(+e.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd faulty"}," ")}))))))}))):r.a.createElement(r.a.Fragment,null)}function tn(e){var t=e.miners,n=e.client,i=Object(a.useState)({}),o=Object(l.a)(i,2),c=o[0],f=o[1],m=Object(a.useState)(),h=Object(l.a)(m,2),v=h[0],b=h[1];return Object(a.useEffect)((function(){(function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetchHead();case 2:t=e.sent,b(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[n]),Object(a.useEffect)((function(){var e=!0;if(v){var a=Object.keys(t).slice(0,50).map((function(e){return t[e].address}));return A()(5,a,function(){var t=Object(u.a)(s.a.mark((function t(a){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.fetchDeadlines(a,v);case 4:if(r=t.sent,e){t.next=7;break}return t.abrupt("return");case 7:return c[a]=r.nextDeadlines,t.next=10,f(Object(p.a)({},c));case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),function(){e=!1}}}),[n,v,t]),r.a.createElement("section",{id:"LookUp",className:"container"},"Listing WindowPoSt duties of the top 50 miners.",t&&Object.keys(t).slice(0,50).map((function(e,n){return r.a.createElement("div",{key:n},r.a.createElement(d.b,{to:"/miners/".concat(t[e].address)},t[e].address),r.a.createElement(en,{deadlines:c[t[e].address],head:v}))})))}var nn=n(35);function an(e){e.client;var t=e.miners,n=e.minerId,a=e.deadlineId,i=e.miner;return r.a.createElement("div",{className:"section minerbar"},r.a.createElement("div",{className:"minerId"},!a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.b,{to:"/address/".concat(n)},n),r.a.createElement("span",{className:"tinyarrow"},r.a.createElement("a",{href:"https://filfox.info/en/address/".concat(n)},"\u2197")),r.a.createElement("span",{className:"rekt rekt-miner"},"MINER"),i&&i.deposits&&0!==+i.deposits.FeeDebt&&r.a.createElement("span",{className:"rekt"},"DEBT")),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.b,{to:"/miners/".concat(n,"/deadlines/").concat(a)},"Deadline ",a))),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"backto"},r.a.createElement(d.b,{to:"/miners/".concat(n)},"See address",r.a.createElement("span",{className:"bolder"}," ",n)))),!a&&r.a.createElement("div",null,t&&t[n]&&t[n].tag&&r.a.createElement("span",{className:"miner-name"},t[n].tag.name,t&&t[n].location&&r.a.createElement("span",null," ",t[n].location.flagEmoji))))}var rn=n(25),on=rn.format(","),cn=rn.format(",.1f");var sn=Object(f.h)((function(e){var t,n=e.miners,i=e.client,o=e.head,c=Object(f.g)(),d=c.minerId,m=c.deadlineId,v=Object(a.useState)(),b=Object(l.a)(v,2),g=b[0],w=b[1],y=Object(a.useState)({}),E=Object(l.a)(y,2),x=E[0],j=E[1],O=Object(a.useState)(),k=Object(l.a)(O,2),S=k[0],M=k[1];return Object(a.useEffect)((function(){S&&(console.log(">> today is set",S),i.fetchPartitionsSectors(S.deadlines[m].Partitions).then((function(e){w(e)})).catch((function(e){console.error("failed to load sectors")})))}),[S]),Object(a.useEffect)((function(){if(d&&o&&m){var e=Math.ceil(o.Height/2880),t=Object(h.a)(Array(e)).map((function(t,n){return{height:2880*n<=o.Height?2880*n:o.Height,day:e-n-1}})).reverse();if(console.log(">>> epochs",t),!S){try{A()(40,t,function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.day,a=t.height,e.prev=1,e.next=4,i.fetchTipsetHead(a);case 4:r=e.sent,e.next=7;break;case 7:e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(1),console.log("could not fetch head",d,n,a,e.t0),e.abrupt("return");case 13:return e.prev=13,e.next=16,i.fetchDeadlines(d,r);case 16:o=e.sent,e.next=19;break;case 19:x[n]=o,j(Object(p.a)({},x)),0===n&&M(o),e.next=27;break;case 24:e.prev=24,e.t1=e.catch(13),console.log("could not find",d,n,a,e.t1);case 27:case"end":return e.stop()}}),e,null,[[1,9],[13,24]])})));return function(t){return e.apply(this,arguments)}}())}catch(n){console.log("trouble with ",n)}return function(){!1}}}}),[i,o,d,m,S]),r.a.createElement("section",{className:"container"},r.a.createElement(an,{client:i,miners:n,minerId:d,deadlineId:m}),r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"grid"},r.a.createElement(J,{title:x&&x[0]&&"".concat(cn(32*+x[0].deadlines[m].LiveSectors/1024)," TiB"),desc:"".concat(x&&x[0]?on(x[0].deadlines[m].LiveSectors):""," Live Sectors")}),r.a.createElement(J,{title:x&&x[0]&&"".concat(cn(+x[0].deadlines[m].FaultyPower.Raw/1099511627776)," TiB"),desc:"".concat(x&&x[0]?on(+x[0].deadlines[m].FaultyPower.Raw/34359738368):""," Faulty Sectors")}))),r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"History"),r.a.createElement("a",{"data-tip":!0,"data-for":"wpost-desc"},"(what is this?)"),r.a.createElement(nn.a,{id:"wpost-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of 48 WindowPoSt submission deadlines ordered by due time (in epochs).",r.a.createElement("br",null),"Bars represent ~8TB disks to be proven, white are healthy disks, red are faulty.")))),r.a.createElement(en,{link:function(e){return"/miners/".concat(d,"/deadlines/").concat(m)},deadlines:(t=m,Object.keys(x).sort((function(e,t){return+e-+t})).map((function(e){return[e,x[e]]})).map((function(e){var n=Object(l.a)(e,2);return n[0],n[1].deadlines[t]})).flat()),head:o,out:function(e){e.d,e.head;var t=e.i;return 0===t?"Today":"".concat(t,"d ago")}})),r.a.createElement("div",{className:"section sectors"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Sectors"),r.a.createElement("a",{"data-tip":!0,"data-for":"sectors-desc"},"(what is this?)"),r.a.createElement(nn.a,{id:"sectors-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"Each square is a 32GiB sector.")))),g&&r.a.createElement("div",null,g.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("h4",null,"Partition ",t," ",Object.keys(e[0].Faults).length===e[0].Sectors.length&&r.a.createElement("span",{className:"rekt"},"REKT")),r.a.createElement("div",{className:"s-partition"},e[0].Sectors.map((function(t){return r.a.createElement("div",{key:t,className:"s-sector ".concat(e[0].Faults[t]&&"faulty"," ").concat(e[0].Terminated[t]&&"terminated"," ").concat(e[0].Recoveries[t]&&"recovering")},r.a.createElement("span",null,t))}))))})))))})),un=n(25),ln=un.format(","),dn=(un.format(",.0f"),un.format(",.2f"));var fn=Object(f.h)((function(e){var t=e.client,n=e.miners,i=e.head,o=e.actors,c=Object(f.g)().minerId,s=Object(a.useState)(Object(m.a)({},c,{id:c})),u=Object(l.a)(s,2),d=u[0],p=u[1],h=o&&t.computeEconomics(i,o,{projectedDays:1}).sectorFaultFee,v=o&&t.computeEconomics(i,o,{}).sectorProjectedReward1,b=o&&t.computeEconomics(i,o,{}).sectorProjectedReward;if(Object(a.useEffect)((function(){if(c&&i&&t){var e=!0;return t.updateMinerInfo(d,c,(function(t){e&&p(t)}),i),function(){e=!1}}}),[t,i,c]),!c||!i||!d[c])return r.a.createElement(r.a.Fragment,null);var g=d[c];return r.a.createElement("section",{className:"container"},r.a.createElement(an,{client:t,miners:n,minerId:c,miner:g}),r.a.createElement("div",{id:"deposits",className:"section"},r.a.createElement("div",{className:"grid"},r.a.createElement(J,{title:g.deposits&&r.a.createElement(r.a.Fragment,null,ln(g.deposits.Balance||0),r.a.createElement($,null)),desc:"Balance"}),r.a.createElement(J,{title:g.deposits&&r.a.createElement(r.a.Fragment,null,ln(g.deposits.Available||0),r.a.createElement($,null)),desc:"Available"}),r.a.createElement(J,{desc:"Vesting",title:g.deposits&&r.a.createElement(r.a.Fragment,null,ln(g.deposits.LockedFunds||0),r.a.createElement($,null))})),r.a.createElement("div",{className:"grid grid-4"},r.a.createElement(J,{title:g.deadlines&&"".concat(dn(32*g.deadlines.SectorsCount/1024)," TiB"),desc:"".concat(g.deadlines&&ln(g.deadlines.SectorsCount)||""," Total Sectors")}),r.a.createElement(J,{title:g.deadlines&&"".concat(dn(32*g.deadlines.ActiveCount/1024)," TiB"),desc:"".concat(g.deadlines&&ln(g.deadlines.ActiveCount)||""," Active Sectors")}),r.a.createElement(J,{title:g.deadlines&&"".concat(dn(32*g.deadlines.FaultsCount/1024)," TiB"),desc:"".concat(g.deadlines&&ln(g.deadlines.FaultsCount)||""," Faulty Sectors")}),r.a.createElement(J,{title:g.preCommits&&ln(g.preCommits.Count)||"",desc:"PreCommits"}))),r.a.createElement("div",{id:"sectors"},r.a.createElement("h3",null,"Economics"),r.a.createElement("div",{className:"grid grid-4"},r.a.createElement(J,{title:g.deposits&&r.a.createElement(r.a.Fragment,null,ln(g.deposits.InitialPledge||0),r.a.createElement($,null)),desc:"Initial Pledge"}),r.a.createElement(J,{desc:"PreCommit Deposit",title:g.deposits&&r.a.createElement(r.a.Fragment,null,ln(g.deposits.PreCommitDeposits||0),r.a.createElement($,null))}),r.a.createElement(J,{title:g.deposits&&r.a.createElement(r.a.Fragment,null,ln(g.deposits.FeeDebt||0),r.a.createElement($,null)),desc:"Fee Debt"}),r.a.createElement(J,{title:g.deposits&&h&&"".concat(dn((+g.deposits.Available+ +g.deposits.LockedFunds)/+h||0)),desc:"Faults to Debt"})),r.a.createElement("div",{className:"grid"},r.a.createElement(J,{title:g.deadlines&&v&&r.a.createElement(r.a.Fragment,null,dn(v*g.deadlines.ActiveCount),r.a.createElement($,null)),desc:"Daily reward*"}),r.a.createElement(J,{title:g.deadlines&&b&&r.a.createElement(r.a.Fragment,null,dn(b*g.deadlines.ActiveCount),r.a.createElement($,null)),desc:"360-Day reward*"}),r.a.createElement(J,{title:o&&g.deadlines&&b&&r.a.createElement(r.a.Fragment,null,dn(32*g.deadlines.ActiveCount/(+o.Power.State.TotalBytesCommitted/Math.pow(2,30))*14400)),desc:"Daily Blocks*"})),"(*) These numbers are projections and do not take into account several factors like network growth. Do your own research."),g.deadlines&&r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Deadlines"),r.a.createElement("a",{"data-tip":!0,"data-for":"wpost-desc"},"(what is this?)"),r.a.createElement(nn.a,{id:"wpost-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of 48 WindoPoSt submission deadlines ordered by due time (in epochs).",r.a.createElement("br",null),"Bars represent ~8TB disks to be proven, white are healthy disks, red are faulty.")))),r.a.createElement(en,{minerId:c,deadlines:g.deadlines.nextDeadlines,head:i})),g.deadlines&&r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Upcoming Deadline"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"timeline"}),r.a.createElement("ul",null,r.a.createElement("li",null,"PoStSubmissions:",g.deadlines.nextDeadlines[0].PostSubmissions),r.a.createElement("li",null,"Sectors to Prove:"," ",g.deadlines.nextDeadlines[0].LiveSectors),r.a.createElement("li",null,"Current Deadline: ",g.deadlines.deadline.Index),r.a.createElement("li",null,"FaultCutoff:"," ",g.deadlines.deadline.FaultCutoff-i.Height),r.a.createElement("li",null,"Challenge: ",g.deadlines.deadline.Challenge-i.Height),r.a.createElement("li",null,g.deadlines.deadline.Open-i.Height>0?"Open":"Opened",": ",g.deadlines.deadline.Open-i.Height),r.a.createElement("li",null,"Close: ",g.deadlines.deadline.Close-i.Height))),r.a.createElement("div",{className:"col"},r.a.createElement(en,{minerId:c,deadlines:[g.deadlines.nextDeadlines[0]],head:i})))),g.preCommits&&r.a.createElement("div",{id:"provecommit",className:"section"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"New sectors"),r.a.createElement("a",{"data-tip":!0,"data-for":"provecommit-desc"},"(what is this?)"),r.a.createElement(nn.a,{id:"provecommit-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of ProveCommits ordered by due time (in epochs).",r.a.createElement("br",null),"Circles represent sectors to be proven.")))),0===g.preCommits.PreCommitDeadlines.length&&r.a.createElement("div",null,"No new sectors"),r.a.createElement("div",{className:"deadlines provecommit"},g.preCommits.PreCommitDeadlines.map((function(e,t){return r.a.createElement("div",{key:t,className:"deadline"},r.a.createElement("div",{className:"out"},"In ",e.Expiry-i.Height),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(e.Sectors.length)," sectors"),r.a.createElement("div",{className:"hdds"},e.Sectors.map((function(e){return r.a.createElement("div",{key:e,className:"hdd"},"")})))))})))))})),mn=n(25),pn=mn.format(",");mn.format(",.0f");var hn=Object(f.h)((function(e){var t=e.client,n=e.miners,i=e.head,o=(e.actors,Object(f.g)().minerId),c=Object(a.useState)(Object(m.a)({},o,{id:o})),s=Object(l.a)(c,2),u=s[0],d=s[1];if(Object(a.useEffect)((function(){o&&i&&t&&t.client.StateReadState(o,i.Cids).then((function(e){var t=u[o];t.deposits=e,d(Object(p.a)(Object(p.a)({},u),{},Object(m.a)({},o,Object(p.a)({},t))))}))}),[t,i,o]),!o||!i||!u[o])return r.a.createElement(r.a.Fragment,null);var h=u[o];return r.a.createElement("section",{className:"container"},r.a.createElement(an,{client:t,miners:n,minerId:o,miner:h}),r.a.createElement("div",{id:"deposits",className:"section"},r.a.createElement("div",{className:"grid"},r.a.createElement(J,{title:h.deposits&&r.a.createElement(r.a.Fragment,null,pn(h.deposits.Balance||0),r.a.createElement($,null)),desc:"Balance"}))))})),vn=n(25);vn.format(","),vn.format(",.0f");var bn=Object(f.h)((function(e){var t=e.client,n=(e.miners,e.head),i=(e.actors,Object(f.g)().minerId),o=Object(a.useState)(),c=Object(l.a)(o,2),s=c[0],u=c[1];return Object(a.useEffect)((function(){t&&n&&t.fetchActor(i,n.Cids).then((function(e){console.log(e),u(e.type)})).catch((function(e){console.error("actor type not supported"),u("NotSupported")}))}),[t,n]),r.a.createElement(r.a.Fragment,null,"storageMinerActorV2"===s&&r.a.createElement(f.a,{to:"/miners/".concat(i)}),"NotSupported"===s&&r.a.createElement(r.a.Fragment,null,"Actor type not supported"))})),gn=function(){return wn.apply(this,arguments)};function wn(){return(wn=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api3.drand.sh/health");case 2:return e.next=4,e.sent.json();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var yn=n(25).format(",");function En(){var e=new Date("2020-08-24 22:00:00Z").getTime();return Math.floor((Date.now()-e)/1e3/30)}function xn(e){var t=e.client,n=e.head,i=Object(a.useState)(En()),o=Object(l.a)(i,2),c=o[0],d=o[1],f=Object(a.useState)(),m=Object(l.a)(f,2),p=m[0],h=m[1];return Object(a.useEffect)((function(){var e=!0,t=function(){var t=Object(u.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:gn().then((function(t){e&&(p&&t.current===p.current?console.log("   repeated drand, skip"):(console.log("   new drand",t),h(t)))})),En()!==c&&d(En());case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t();var n=setInterval((function(){e&&t()}),5e3);return function(){e=!1,clearInterval(n),console.log("removing interval")}}),[t,n,p]),r.a.createElement("div",{className:"d-none d-md-block"},r.a.createElement("div",{className:"tiny-grid"},r.a.createElement("div",null,"Filecoin Status"," ",r.a.createElement("span",null,n&&c&&n.Height<c?c-n.Height===1?"behind":"receiving":"ok")),r.a.createElement("div",{className:"tiny"},"Current Tipset"," ",r.a.createElement("a",{href:"https://filfox.info/en/tipset/".concat(n&&n.Height)},n&&yn(n.Height))),r.a.createElement("div",{className:"tiny"},"Expected Tipset"," ",r.a.createElement("a",{href:"https://filfox.info/en/tipset/".concat(c)},yn(c))),r.a.createElement("div",{className:"tiny"},"Drand Status"," ",r.a.createElement("span",null,p&&p.current<p.expected?"catching up":"ok")),r.a.createElement("div",{className:"tiny"},"Current Drand"," ",r.a.createElement("a",{href:"https://api.drand.sh/public/".concat(p&&p.current)},yn(p&&p.current))),r.a.createElement("div",{className:"tiny"},"Expected Drand"," ",r.a.createElement("a",{href:"https://api.drand.sh/public/".concat(p&&p.expected)},yn(p&&p.expected)))))}var jn=n(77),On=n.n(jn);function kn(e){var t=e.nstats,n=e.head,i=Object(a.useState)({}),o=Object(l.a)(i,2),c=o[0],d=o[1],f=Object(a.useState)({}),m=Object(l.a)(f,2),h=m[0],v=m[1],b=Object(a.useState)(void 0),g=Object(l.a)(b,2),w=g[0],y=g[1],E=Object(a.useRef)(null),x=Object(a.useRef)(null),j=function(e){x.current.addEventListener("show.bs.collapse",(function(){e.update()})),x.current.addEventListener("hide.bs.collapse",(function(){e.update()}))},O={title:{display:!0,text:"Growth rate and proven sectors"},scales:{yAxes:[{id:"commits",type:"linear",position:"left",scaleLabel:{labelString:"Estimated Growth Rate (PB/day) ",display:!0}},{id:"wposts",type:"linear",position:"right",scaleLabel:{labelString:"Estimated Sectors Proven per height",display:!0}}]}},k=function(){var e=Object(u.a)(s.a.mark((function e(){var n,a,r,i,o,u,l,f,m,b,g,x,k,S,M,N;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.transactionsPerHeight(7);case 2:return n=e.sent,e.next=5,t.transactionsPerHeight(5);case 5:a=e.sent,r=Object.fromEntries(R(n,(function(e,t){return[t,e.length]}))),i=Object.fromEntries(R(a,(function(e,t){return[t,e.length]}))),o=Object(p.a)(Object(p.a)({},c),r),u=Object(p.a)(Object(p.a)({},h),i),l=R(o,(function(e,t){return t})).sort((function(e,t){return t-e})).slice(0,30).reverse(),f=P(o,(function(e,t){return l.includes(t)})),d(f),m=l.map((function(e){return f[e]})).map((function(e){return Math.round(32*e/1024/1024*2880)})),b=P(u,(function(e,t){return l.includes(t)})),v(b),g=l.map((function(e){return b[e]})).map((function(e){return Math.round(2349*e)})),void 0==(x=w)?(k=[{data:m,borderColor:Rn.blue,fill:!1,label:"Estimated growth rate in PB per day",yAxisID:"commits"},{data:g,borderColor:Rn.red,fill:!1,label:"Estimated number of proven sectors per height",yAxisID:"wposts"}],S={datasets:k,labels:l},M=E.current.getContext("2d"),N=new On.a(M,{type:"line",data:S,options:O}),j(x=N)):(x.data.datasets[0].data=m,x.data.datasets[1].data=g,x.data.labels=l,x.update()),y(x);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){k()}),[n,t]),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"growth"},r.a.createElement("h2",null,r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseGrowth","aria-expanded":"true","aria-controls":"collapseBiggest"},"Growth evolution"))),r.a.createElement("div",{id:"collapseGrowth",ref:x,className:"collapse","aria-labelledby":"growth","data-parent":"#accordionExample"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"col-12"},void 0==w&&r.a.createElement("p",null," Loading.... "),r.a.createElement("canvas",{ref:E},"Loading...")))))}function Sn(e){var t=e.nstats,n=Object(a.useState)(""),i=Object(l.a)(n,2),o=i[0],c=i[1],d=Object(a.useState)({}),f=Object(l.a)(d,2),m=f[0],p=f[1],h=function(){var e=Object(u.a)(s.a.mark((function e(n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),console.log("search miner for ",o),e.next=4,t.minerInfo(o);case 4:a=e.sent,p(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"minerInfo"},r.a.createElement("h2",null,r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseInfo","aria-expanded":"true","aria-controls":"collapseInfo"},"Miner info search"))),r.a.createElement("div",{id:"collapseInfo",className:"collapse","aria-labelledby":"minerInfo","data-parent":"#accordionExample"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-4"}," "),r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{for:"minerAddress"},"Miner address"),r.a.createElement("input",{value:o,onChange:function(e){return c(e.target.value)},type:"text",className:"form-control",placeholder:"Enter miner address"})),r.a.createElement("button",{onClick:h,type:"submit",className:"btn btn-primary"},"Search"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,["Miner","Raw Byte Power","Ratio over total raw power","Size","Daily gas required (wpost)","Daily price FIL"].map((function(e){return r.a.createElement("th",{key:e}," ",e," ")})))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null," ",o," "),r.a.createElement("td",null," ",m.raw," "),r.a.createElement("td",null," ",m.ratio," "),r.a.createElement("td",null," ",m.size," "),r.a.createElement("td",null," ",m.dailyGas," "),r.a.createElement("td",null," ",m.maxDailyPrice," ")))))))))}function Mn(e){var t=e.head,n=e.nstats,i=Object(a.useState)({}),o=Object(l.a)(i,2),c=(o[0],o[1]),d=Object(a.useState)({}),f=Object(l.a)(d,2),m=(f[0],f[1]),p=Object(a.useState)(void 0),h=Object(l.a)(p,2),v=h[0],b=h[1],g=Object(a.useRef)(null),w=Object(a.useRef)(null),y=function(e){w.current.addEventListener("show.bs.collapse",(function(){e.update()})),w.current.addEventListener("hide.bs.collapse",(function(){e.update()}))},E=function(){var e=Object(u.a)(s.a.mark((function e(){var t,a,r,i,o,u,l,d,f,p,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.biggestGasUserFor();case 2:if(t=e.sent,!(Object.keys(t).length<1)){e.next=5;break}return e.abrupt("return");case 5:a=Object.keys(t).sort((function(e,t){return t-e})),r=t[a[0]],i=r.slice(0,10).map((function(e){return e[1]})),o=[{data:i,backgroundColor:R(Rn,(function(e,t){return e})).slice(0,10),label:"transaction gas"}],u=r.slice(0,10).map((function(e){return e[0]})),l={title:{display:!0,text:"Gas usage at height ".concat(a[0])}},d={datasets:o,labels:u},m(l),c(d),void 0==(f=v)?(p=g.current.getContext("2d"),h=new On.a(p,{type:"doughnut",data:d,options:l}),y(f=h)):(v.data.datasets[0].data=i,v.options=l,v.update()),b(f);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){E()}),[t,n]),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"biggestGas"},r.a.createElement("h2",null,r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseBiggest","aria-expanded":"true","aria-controls":"collapseBiggest"},"Biggest gas users"))),r.a.createElement("div",{id:"collapseBiggest",ref:w,className:"collapse","aria-labelledby":"biggestGas","data-parent":"#accordionExample"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"col-12"},void 0==v&&r.a.createElement("p",null," Loading.... "),r.a.createElement("canvas",{ref:g},"Loading...")))))}function Nn(e){var t=e.nstats,n=e.head,i=["","Average Count","Average GasUsed ","Ratio over total GasUsed","Average GasLimit","Ratio avg over total GasLimit","Ratio GasUsed over GasLimit","Ratio GasUsed over BlockLimit","Ratio GasLimit over BlockLimit"],o=Array(i.length-1).fill(0),c=Object(a.useState)({headers:i,total:o,wpost:o,pre:o,prove:o}),d=Object(l.a)(c,2),f=d[0],m=d[1],p=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.avgTotalGasUsed();case 2:return e.sent,e.next=5,t.avgGasLimit();case 5:return e.sent,n=function(){var e=Object(u.a)(s.a.mark((function e(){var n,a,r,i,o,c,u,l,d=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.avgNumberTx.apply(t,d);case 2:return n=e.sent,e.next=5,t.avgGasOfMethod.apply(t,d);case 5:return a=e.sent,e.next=8,t.avgGasLimit.apply(t,d);case 8:return r=e.sent,e.next=11,t.avgRatioUsedOverTotalUsed.apply(t,d);case 11:return i=e.sent,e.next=14,t.avgRatioLimitOverTotalLimit.apply(t,d);case 14:return o=e.sent,e.next=17,t.avgRatioUsedOverLimit.apply(t,d);case 17:return c=e.sent,e.next=20,t.avgTotalGasUsedOverTipsetLimit.apply(t,d);case 20:return u=e.sent,e.next=23,t.avgTotalGasLimitOverTipsetLimit.apply(t,d);case 23:return l=e.sent,e.abrupt("return",[n,a,i,r,o,c,u,l]);case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),(a={}).headers=i,e.next=11,n();case 11:return a.total=e.sent,e.next=14,n(5);case 14:return a.wpost=e.sent,e.next=17,n(6);case 17:return a.pre=e.sent,e.next=20,n(7);case 20:a.prove=e.sent,m(a);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){p(t)}),[t,n]);return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"headingOne"},r.a.createElement("h2",null,r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOne","aria-expanded":"false","aria-controls":"collapseOne"},"Gas usage table"))),r.a.createElement("div",{id:"collapseOne",className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"row"},r.a.createElement("p",null," ","This table shows different statistics about the gas usage per epoch. All results are averaged accross the last",3," epochs. You can find a complete description of each column below the table."," "),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,f.headers.map((function(e){return r.a.createElement("th",{key:e}," ",e," ")})))),r.a.createElement("tbody",null,r.a.createElement(Tn,{name:"Total gas used:",values:f.total}),r.a.createElement(Tn,{name:"WindowPoSt:",values:f.wpost}),r.a.createElement(Tn,{name:"PreCommit:",values:f.pre}),r.a.createElement(Tn,{name:"ProveCommit:",values:f.prove}))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-0"}," "),r.a.createElement("div",{className:"col-11"},r.a.createElement("ul",{className:"list-group list-group-flush"},r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Average Count:")," number of transaction per epoch in average of the method"," "),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Average GasUsed:")," gas used per transaction of the method"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Ratio over total GasUsed:")," Precedent number divided by the total gas used accross all epochs"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Average GasLimit:")," gas limit set per transaction of the method"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Ratio over total GasLimit:")," Precedent number divided by the total gas used accross all epochs"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Ratio GasUsed over GasLimit:")," Total gas used for the method over total gas limit set accross all epoch"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Total GasUsed over BlockLimit:")," Total gas used divided by total gas limit set per epoch"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Total GasLimit over BlockLimit:")," precedent number divided by total gas limit set per epoch"))))))))}function Tn(e){return r.a.createElement("tr",null,r.a.createElement("td",null," ",e.name," "),e.values.map((function(e,t){return r.a.createElement("td",{key:t.toString()},isNaN(e)||Math.ceil(e)===e?e:e.toFixed(2))})))}var Pn=Object(f.h)((function(e){var t=e.client,n=e.head,i=Object(a.useState)(),o=Object(l.a)(i,2),c=o[0],d=o[1],f=function(){var e=Object(u.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new C(t,3),e.next=3,n.fetchCids();case 3:d(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){f()}),[t,n]),c?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"accordion col-12",id:"accordionExample"},r.a.createElement(kn,{nstats:c,head:n}),r.a.createElement(Sn,{nstats:c}),r.a.createElement(Mn,{nstats:c,head:n}),r.a.createElement(Nn,{nstats:c,head:n}))):r.a.createElement(r.a.Fragment,null)})),Rn={red:"rgb(255, 99, 132)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(75, 192, 192)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"};n(174),n(175),n(177);var In=function(){console.log("reloaded");var e=Object(a.useState)(),t=Object(l.a)(e,2),n=t[0],i=t[1],o=Object(a.useState)(),c=Object(l.a)(o,2),m=c[0],p=c[1],h=Object(a.useState)("wss://node.glif.io/space07/lotus/rpc/v0"),v=Object(l.a)(h,2),b=v[0],g=(v[1],Object(a.useState)(new Z(b))),w=Object(l.a)(g,2),y=w[0],E=w[1],x=Object(a.useState)(),j=Object(l.a)(x,2),O=j[0],k=(j[1],Object(a.useState)()),S=Object(l.a)(k,2),M=S[0],N=S[1];return Object(a.useEffect)((function(){(function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return e.next=4,E(new Z(b));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[b]),Object(a.useEffect)((function(){m&&function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.fetchGenesisActors(m);case 2:t=e.sent,N(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[y,m]),Object(a.useEffect)((function(){var e=!0;y.getMiners().then((function(t){e&&i(t)}));var t=function(){var t=Object(u.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:y.fetchHead().then((function(t){e&&(m&&t.Height===m.Height?console.log("   repeated block, skip"):(console.log("   new block",t.Height,m&&m.Height),p(t)))}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t();var n=setInterval((function(){e&&t()}),5e3);return function(){e=!1,clearInterval(n),console.log("removing interval")}}),[y,m]),r.a.createElement(d.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"container"},r.a.createElement(xn,{client:y,head:m})),r.a.createElement("header",{className:"container-fluid"},r.a.createElement(d.b,{to:"/"},r.a.createElement("h1",{id:"logo",className:"logo"},r.a.createElement("span",null,"spacegap")))),r.a.createElement("div",{className:"container"},r.a.createElement(Ht,null),r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/miners/:minerId/deadlines/:deadlineId"},r.a.createElement(sn,{client:y,miners:n,head:m})),r.a.createElement(f.b,{path:"/miners/:minerId"},r.a.createElement(fn,{actors:M,client:y,miners:n,head:m})),r.a.createElement(f.b,{path:"/address/:minerId"},r.a.createElement(bn,{actors:M,client:y,miners:n,head:m})),r.a.createElement(f.b,{path:"/accounts/:minerId"},r.a.createElement(hn,{actors:M,client:y,miners:n,head:m})),r.a.createElement(f.b,{path:"/full"},r.a.createElement(tn,{client:y,miners:n})),r.a.createElement(f.b,{path:"/status"},r.a.createElement($t,{head:m,spa:O,client:y,miners:n})),r.a.createElement(f.b,{path:"/gas"},r.a.createElement(Pn,{client:y,head:m})),r.a.createElement(f.b,{path:"/market"},r.a.createElement(Zt,{actors:M,client:y,head:m,miners:n})),r.a.createElement(f.b,{path:"/"},r.a.createElement(re,{actors:M,client:y,head:m,miners:n}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(In,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[108,1,2]]]);
//# sourceMappingURL=main.9e0268dc.chunk.js.map