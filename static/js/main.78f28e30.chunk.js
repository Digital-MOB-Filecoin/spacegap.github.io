(this.webpackJsonpspacegap=this.webpackJsonpspacegap||[]).push([[0],{101:function(e,t){},113:function(e,t){},115:function(e,t){},155:function(e,t,a){},156:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(83),s=a.n(c),i=(a(92),a(1)),o=a.n(i),l=a(3),u=a(4),d=a(10),p=a(9),m=a(12),h=a(5),f=a(14),v=a(7),b=a(8),E=a(2),w=a(58),g=a(45),y=a(59),j=a.n(y),O=function(e){var t=288888888e10,a=Math.pow(2,1/1051200),n=1/Math.log(a),r=-t*n;return Math.log((e-r)/(t*n))/Math.log(a)},x=function(e,t,a,n){var r=Math.log(2)/6307200,c=33e7*(1-Math.pow(Math.E,-r*t)),s=33e7*(1-Math.pow(Math.E,-r*e)),i=77e7*(1-Math.pow(Math.E,-r*n));return s+77e7*(1-Math.pow(Math.E,-r*a))-c-i},k=function(e){var t=Math.pow(2,1/1051200);return 288888888e10*Math.pow(t,e)},N=function(){function e(t){var a=t.currEpoch,n=t.nwqap,r=t.nwqapP,c=t.nwqapV,s=t.nwCircSupply,i=t.perEpochRewardP,o=t.perEpochRewardV,l=t.perDurationNwRbGrowth,u=t.projectedDays,d=t.perDurationMinerQaGrowth,p=t.nwCumsumRealized;Object(v.a)(this,e),Object.assign(this,{currEpoch:a,nwqap:n,nwqapP:r,nwqapV:c,nwCircSupply:s,perEpochRewardP:i,perEpochRewardV:o,perDurationNwRbGrowth:l,projectedDays:u,perDurationMinerQaGrowth:d,nwCumsumRealized:p})}return Object(b.a)(e,[{key:"projectFutureReward",value:function(e,t){var a=new S(this.nwqapP,this.nwqapV),n=new S(this.perEpochRewardP,this.perEpochRewardV);return e*P(n,a,2880*t)}},{key:"computeInitialPledgeForQAPower",value:function(e,t){return this.projectFutureReward(e,20)+.3*e*this.nwCircSupply/Math.max(this.nwqap,k(t))}},{key:"summary",value:function(){return{sectorIp:this.computeInitialPledgeForQAPower(32*Math.pow(2,30),this.currEpoch),sectorProjectedReward:this.projectFutureReward(32*Math.pow(2,30),360),sectorFaultFee:this.projectFutureReward(32*Math.pow(2,30),3.51)}}},{key:"computeInitialPledgeFromAssumptions",value:function(){for(var e=this.currEpoch,t=this.nwqap,a=this.nwqapP,n=this.nwqapV,r=this.nwCircSupply,c=this.perEpochRewardP,s=this.perEpochRewardV,i=this.perDurationNwRbGrowth,o=this.projectedDays,l=this.perDurationMinerQaGrowth,u=this.nwCumsumRealized,d=new S(a,n),p=new S(c,s),m=i/o/2880,h=l/o/2880,f=[],v=0,b=t,E=u,w=O(u),g=e+1;g<e+2880*o+1;g++){var y=h*(P(p,d,57600)+.3*r/Math.max(b,k(g)));f.push(y),v+=y;var j=O(E+=b+=m),N=x(g,g-1,j,w);p.addNewEntry(N,1),d.addNewEntry(b,1),w=j}return{newInitialPledges:f,totalInitialPledge:v}}}]),e}(),S=function(){function e(t,a){Object(v.a)(this,e),this.alpha=925e-6,this.beta=284e-9,this.p=t,this.v=a}return Object(b.a)(e,[{key:"addNewEntry",value:function(e,t){this.p+=this.v*t;var a=e-this.p;this.p+=this.alpha*a,this.p=Math.max(this.p,0),this.v+=this.beta*a/t}}]),e}(),P=function(e,t,a){var n=Math.log(t.p+t.v),r=Math.log(t.p+t.v+t.v*a);return(t.v*e.p*(r-n)+e.v*(t.p*(n-r)+t.v*a))/Math.pow(t.v,2)},M=5*Math.pow(10,9);function C(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){var a=Object(u.a)(e,2),n=a[0],r=a[1];return t(r,n)})))}function R(e,t){return Object.entries(e).map((function(e,a){var n=Object(u.a)(e,2),r=n[0],c=n[1];return t(c,r,a)}))}function F(e){for(var t=["B","KiB","MiB","GiB","TiB","PiB","EiB"],a=0;e>=1024&&a<t.length-1;)e/=1024,a++;return e=e.toFixed(2),"".concat(e," ").concat(t[a])}var I=function(){function e(t,a){Object(v.a)(this,e),this.fetcher=t,this.average=a,this.tipsets={}}return Object(b.a)(e,[{key:"fetchCids",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Initializing gas stats engine"),e.next=3,this.fetcher.fetchHead();case 3:t=e.sent,a=t.Height,this.tipsets[t.Height]=t,n=1;case 7:if(!(n<this.average)){e.next=16;break}return e.next=10,this.fetcher.fetchTipsetHead(a-n);case 10:r=e.sent,this.tipsets[r.Height]=r,console.log(n,"/",this.average,": init fetched tipset at height ",r.Height," with [0] = ",r);case 13:n++,e.next=7;break;case 16:console.log("Stats: got "+Object.keys(this.tipsets).length+" tipset CIDs to make stats from");case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgGasOfMethod",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,n);case 2:return t=e.sent,a=t.reduce((function(e,t){return e+t[1].GasUsed}),0),e.abrupt("return",a/t.length);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgGasLimit",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,t);case 2:return e.abrupt("return",e.sent.reduce((function(e,t){return e+t[0].Message.GasLimit}),0));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgGasFeeCap",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r,c,s,i,l,u=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=0,a=u.length,n=new Array(a),r=0;r<a;r++)n[r]=u[r];e.t0=o.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=12;break}return c=e.t1.value,i=this.tipsets[c],e.next=8,(s=this.fetcher).parentAndReceiptsMessages.apply(s,[i.Cids[0]].concat(n));case 8:l=e.sent,t+=l.reduce((function(e,t){return e+parseInt(t[0].Message.GasFeeCap)}),0)/l.length,e.next=3;break;case 12:return e.abrupt("return",t/Object.keys(this.tipsets).length);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgTotalGasUsed",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.keys(this.tipsets).length,e.next=3,this.transactions.apply(this,n);case 3:return a=e.sent.reduce((function(e,t){return e+t[1].GasUsed}),0),e.abrupt("return",a/t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgNumberTx",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,a);case 2:return t=e.sent,e.abrupt("return",t.length/Object.keys(this.tipsets).length);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"transactions",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r,c,s,i,l,u=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],a=u.length,n=new Array(a),r=0;r<a;r++)n[r]=u[r];e.t0=o.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=12;break}return c=e.t1.value,i=this.tipsets[c],e.next=8,(s=this.fetcher).parentAndReceiptsMessages.apply(s,[i.Cids[0]].concat(n));case 8:l=e.sent,t=t.concat(l),e.next=3;break;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"transactionsPerHeight",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r,c,s,i,l,u=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},a=u.length,n=new Array(a),r=0;r<a;r++)n[r]=u[r];e.t0=o.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=12;break}return c=e.t1.value,i=this.tipsets[c],e.next=8,(s=this.fetcher).parentAndReceiptsMessages.apply(s,[i.Cids[0]].concat(n));case 8:l=e.sent,t[c]=l,e.next=3;break;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgRatioUsedOverTotalUsed",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,n);case 2:return t=e.sent.reduce((function(e,t){return e+t[1].GasUsed}),0),e.next=5,this.transactions();case 5:return a=e.sent.reduce((function(e,t){return e+t[1].GasUsed}),0),e.abrupt("return",t/a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgRatioLimitOverTotalLimit",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,n);case 2:return t=e.sent.reduce((function(e,t){return e+t[0].Message.GasLimit}),0),e.next=5,this.transactions();case 5:return a=e.sent.reduce((function(e,t){return e+t[0].Message.GasLimit}),0),e.abrupt("return",t/a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgTotalGasLimitOverTipsetLimit",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r,c,s,i,l,u,d,p,m=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],a=m.length,n=new Array(a),r=0;r<a;r++)n[r]=m[r];e.t0=o.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=15;break}return c=e.t1.value,i=this.tipsets[c],e.next=8,(s=this.fetcher).parentAndReceiptsMessages.apply(s,[i.Cids[0]].concat(n));case 8:l=e.sent,u=l.reduce((function(e,t){return e+t[0].Message.GasLimit}),0),d=i.Cids.length,p=u/(M*d),t.push(p),e.next=3;break;case 15:return e.abrupt("return",t.reduce((function(e,t){return e+t}),0)/t.length);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgTotalGasUsedOverTipsetLimit",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r,c,s,i,l,u,d,p,m=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],a=m.length,n=new Array(a),r=0;r<a;r++)n[r]=m[r];e.t0=o.a.keys(this.tipsets);case 3:if((e.t1=e.t0()).done){e.next=15;break}return c=e.t1.value,i=this.tipsets[c],e.next=8,(s=this.fetcher).parentAndReceiptsMessages.apply(s,[i.Cids[0]].concat(n));case 8:l=e.sent,u=l.reduce((function(e,t){return e+t[1].GasUsed}),0),d=i.Cids.length,p=u/(M*d),t.push(p),e.next=3;break;case 15:return e.abrupt("return",t.reduce((function(e,t){return e+t}),0)/t.length);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"avgRatioUsedOverLimit",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transactions.apply(this,n);case 2:return t=e.sent.reduce((function(e,t){return e+t[1].GasUsed}),0),e.next=5,this.transactions.apply(this,n);case 5:return a=e.sent.reduce((function(e,t){return e+t[0].Message.GasLimit}),0),e.abrupt("return",t/a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"biggestGasUserFor",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r,c,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},e.t0=o.a.keys(this.tipsets);case 2:if((e.t1=e.t0()).done){e.next=13;break}return a=e.t1.value,e.next=6,this.transactions.apply(this,s);case 6:n=e.sent,r=n.reduce((function(e,t){return void 0==e[t[0].Message.To]&&(e[t[0].Message.To]=0),e[t[0].Message.To]+=t[1].GasUsed,e}),{}),c=R(r,(function(e,t){return[t,e]})).sort((function(e,t){return t[1]-e[1]})),t[a]=c,console.log("Biggest txs at height",a," -> ",c.slice(0,10)),e.next=2;break;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sortedHeights",value:function(){return Object.keys(this.tipsets).sort((function(e,t){return t-e}))}},{key:"minerInfo",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,r,c,s,i,l,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.sortedHeights(),n=this.tipsets[a[0]],e.next=4,this.fetcher.getMinerPower(n.Cids,n.Height,t);case 4:return r=e.sent,e.next=7,this.avgGasOfMethod(5);case 7:return c=e.sent,d=r.MinerPower.RawBytePower,s=d/1024/1024/1024/32,i=F(r.MinerPower.RawBytePower),l=s/2349*c,e.t0=l,e.next=14,this.avgGasFeeCap(5);case 14:return e.t1=e.sent,u=e.t0*e.t1,e.abrupt("return",{raw:r.MinerPower.RawBytePower,ratio:(r.MinerPower.RawBytePower/r.TotalPower.RawBytePower).toFixed(3),size:i,dailyGas:l.toFixed(2),maxDailyPrice:(o=u,o*Math.pow(10,-18)).toFixed(2)});case 17:case"end":return e.stop()}var o,d}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),T=(a(28),a(22)),G=a.n(T),L=a(28),D=L.format("0.2f"),A=a(146)("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),B=a(35),H=a(158).testnet.fullNode;function U(e){if(""===e)return window.BigInt(0);var t=atob(e),a=[];return t.split("").forEach((function(e){var t=e.charCodeAt(0).toString(16);t.length%2&&(t="0"+t),a.push(t)})),window.BigInt("0x"+a.join(""))}var Q=function(e){return console.log(">>>> HEIGHT",e),!e||e>=138720?{Sectors:"buffer",Unproven:"buffer",Faults:"buffer",Recoveries:"buffer",Terminated:"buffer",ExpirationEpochs:"cid",EarlyTerminated:"cid",LivePower:{a:"bigint",b:"bigint"},UnprovenPower:{a:"bigint",b:"bigint"},FaultyPower:{a:"bigint",b:"bigint"},RecoveringPower:{a:"bigint",b:"bigint"}}:{Sectors:"buffer",Faults:"buffer",Recoveries:"buffer",Terminated:"buffer",ExpirationEpochs:"cid",EarlyTerminated:"cid",LivePower:{a:"bigint",b:"bigint"},FaultyPower:{a:"bigint",b:"bigint"},RecoveringPower:{a:"bigint",b:"bigint"}}},_={type:"hamt",key:"bigint",value:{info:{seal_proof:"int",sector_number:"int",sealed_cid:"cid",seal_rand_epoch:"int",deal_ids:["list","int"],expiration:"int",replace_capacity:"bool",replace_sector_deadline:"int",replace_sector_partition:"int",replace_sector_number:"int"},precommit_deposit:"bigint",precommit_epoch:"int",deal_weight:"bigint",verified_deal_weight:"bigint"}};function q(e){for(var t=0n,a=0;a<e.length;a++)t*=256n,t+=window.BigInt(e[a]);return t}function V(e){for(var t=new B(0),a=0;a<e.length;a++)t=(t=t.mul(new B(256))).add(new B(e[e.length-a-1]));return t}function z(e,t){var a=e.num.and(new B(1).shln(t).sub(new B(1)));return e.num=e.num.shrn(t),e.left-=t,a.toNumber()}function W(e){var t,a=function(e){for(var t={left:8*e.length,num:V(e)},a=(z(t,2),z(t,1)),n=[];t.left>0;){if(1!==z(t,1))if(1!==z(t,1)){for(var r=0,c=0,s=0;;s++){if(10===s)throw new Error("run too long");var i=z(t,8);if(i<128){if(s>9||9===s&&i>1)throw new Error("run too long");if(0===i&&c>0)throw new Error("invalid run");r|=i<<c;break}r|=(127&i)<<c,c+=7}n.push(r)}else{var o=z(t,4);n.push(o)}else n.push(1)}return{first:a,runs:n}}(e),n=a.first,r=a.runs,c=n,s=[],i=0,o=Object(E.a)(r);try{for(o.s();!(t=o.n()).done;){for(var l=t.value,u=0;u<l;u++)1===c&&s.push(i),i++;c=1-c}}catch(d){o.e(d)}finally{o.f()}return s}var J=function(){function e(t){Object(v.a)(this,e),this.url=t;var a=new g.a(t);console.log("new endpoint",t),this.client=new w.LotusRPC(a,{schema:H}),this.parents={},this.receipts={},this.minfo={}}return Object(b.a)(e,[{key:"getData",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a,n){var r,c,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.Blocks[0].ParentStateRoot["/"],c=t.Height>=138720?"".concat(r,"/1/").concat(a):"".concat(r,"/").concat(a),e.next=4,this.client.chainGetNode(c);case 4:return s=e.sent.Obj,i=this,e.next=8,j.a.methods.decode(n,s).asObject(function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.client.chainGetNode(t);case 2:return a=e.sent,e.abrupt("return",a.Obj);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"fetchHead",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.client.chainHead());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchPartitionsSectors",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.chainGetNode("".concat(t["/"]));case 2:return n=e.sent.Obj[2][2],console.log(">> partition",n),e.abrupt("return",n.map((function(e){var t=j.a.methods.decode(Q(a),e);return[{Sectors:W(t.Sectors),Faults:W(t.Faults).reduce((function(e,t){return e[t]=!0,e}),{}),Terminated:W(t.Terminated).reduce((function(e,t){return e[t]=!0,e}),{}),Recoveries:W(t.Recoveries).reduce((function(e,t){return e[t]=!0,e}),{})}]})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchTipsetHead",value:function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.ChainGetTipSetByHeight(t,null);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchPower",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.Blocks[0].ParentStateRoot["/"],n=t.Height>=138720?"".concat(a,"/1/@Ha:t04/1"):"".concat(a,"/@Ha:t04/1"),e.next=4,this.client.chainGetNode(n);case 4:return r=e.sent.Obj,e.abrupt("return",{TotalRawBytePower:q(A.decode(r[0])),TotalBytesCommitted:q(A.decode(r[1])),TotalQualityAdjPower:q(A.decode(r[2])),TotalQABytesCommitted:q(A.decode(r[3])),TotalPledgeCollateral:q(A.decode(r[4])),ThisEpochRawBytePower:q(A.decode(r[5])),ThisEpochQualityAdjPower:q(A.decode(r[6])),ThisEpochPledgeCollateral:q(A.decode(r[7]))});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchDeposits",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r,c,s,i,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.StateReadState(t,a.Cids);case 2:return n=e.sent,r=n.State,c=n.Balance,s=r.PreCommitDeposits,i=r.LockedFunds,l=r.InitialPledge,u=r.FeeDebt,d=c-l-s-i,e.abrupt("return",{Balance:D(c/1e18),InitialPledge:D(l/1e18),Available:D(d/1e18),LockedFunds:D(i/1e18),PreCommitDeposits:D(s/1e18),FeeDebt:D(u/1e18)});case 7:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getMiners",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window.localStorage.getItem("miners"),a=window.localStorage.getItem("time"),!(t&&a&&Date.now()-+a<1e3)){e.next=4;break}return e.abrupt("return",JSON.parse(t));case 4:return e.next=6,fetch("https://filfox.info/api/v0/miner/list/power?pageSize=1000");case 6:return e.next=8,e.sent.json();case 8:return n=e.sent,r=n.miners.reduce((function(e,t){return e[t.address]=t,e}),{}),window.localStorage.setItem("miners",JSON.stringify(r)),window.localStorage.setItem("time",Date.now()),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchDeadlinesProxy",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r,c,s,i=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.Blocks[0].ParentStateRoot["/"],r=a.Height>=138720?"".concat(n,"/1/@Ha:").concat(t,"/1/12"):"".concat(n,"/@Ha:").concat(t,"/1/11"),e.next=4,this.client.chainGetNode(r);case 4:return c=e.sent.Obj[0],console.log("d - ",r),e.next=8,G()(24,c,function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.client.ChainGetNode("".concat(t["/"]));case 2:return a=e.sent.Obj,console.log("d - ","".concat(t["/"])),e.abrupt("return",{Partitions:a[0],LiveSectors:a[4],TotalSectors:a[5],FaultyPower:{Raw:Number(U(a[6][0]))}});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return s=e.sent,e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchMinerInfo",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.client.StateMinerInfo(t,a.Cids));case 1:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchDeadlines",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r,c,s,i,l,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.client.StateMinerProvingDeadline(t,a.Cids),this.fetchDeadlinesProxy(t,a)]);case 2:return n=e.sent,r=Object(u.a)(n,2),c=r[0],s=r[1],console.log(">>> got deadline and deadline"),i=Object(f.a)(Array(48)).map((function(e,t){return Object(h.a)(Object(h.a)({},s[(c.Index+t)%48]),{},{Close:c.Close+60*t,Index:(c.Index+t)%48})})),l=s.map((function(e){return+e.LiveSectors})).reduce((function(e,t){return e+t}),0),d=s.map((function(e){return+e.FaultyPower.Raw})).reduce((function(e,t){return e+t}),0)/34359738368,e.abrupt("return",{deadlines:s.map((function(e,t){return Object(h.a)(Object(h.a)({},s[t]),{},{Close:c.Close+60*t,Index:t})})),nextDeadlines:i,SectorsCount:l,FaultsCount:d,ActiveCount:l-d,deadline:c});case 11:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"updateMinerInfo",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a,n,r){var c,s,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=i.length>4&&void 0!==i[4]?i[4]:{deadlines:!0},s=t[a],n(Object(h.a)(Object(h.a)({},t),{},Object(m.a)({},a,Object(h.a)({},s)))),this.fetchMinerInfo(a,r).then((function(e){s.info=e,n(Object(h.a)(Object(h.a)({},t),{},Object(m.a)({},a,Object(h.a)({},s))))})).catch((function(e){console.error("failed to fetch miner info")})),c.deadlines&&this.fetchDeadlines(a,r).then((function(e){s.deadlines=e,n(Object(h.a)(Object(h.a)({},t),{},Object(m.a)({},a,Object(h.a)({},s)))),console.log("deadlines setting")})).catch((function(e){console.error("failed to fetch deadlines")})),this.fetchDeposits(a,r).then((function(e){s.deposits=e,n(Object(h.a)(Object(h.a)({},t),{},Object(m.a)({},a,Object(h.a)({},s))))})).catch((function(e){console.error("failed to fetch deposits")})),this.fetchPreCommittedSectors(a,r).then((function(e){s.preCommits=e,n(Object(h.a)(Object(h.a)({},t),{},Object(m.a)({},a,Object(h.a)({},s))))})).catch((function(e){console.error("failed to fetch precommitted sectors",e)}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"fetchPreCommittedSectors",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.Height>=138720?"@Ha:".concat(t,"/1/6"):"@Ha:".concat(t,"/1/5"),e.next=3,this.getData(a,n,_);case 3:return r=e.sent,c=L.groups(Object.keys(r).map((function(e){return{SectorNumber:r[e].info.sector_number,Expiry:r[e].precommit_epoch+10210}})),(function(e){return e.Expiry})).map((function(e){var t=Object(u.a)(e,2);return{Expiry:t[0],Sectors:t[1].map((function(e){return e.SectorNumber}))}})).sort((function(e,t){return e.Expiry-t.Expiry})),e.abrupt("return",{PreCommitDeadlines:c,Count:Object.keys(r).length});case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchSectors",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.StateMinerSectors(t,null,a.Cids);case 2:return n=e.sent,r=n.reduce((function(e,t){return e[t.ID]={number:t.ID,info:t},e}),{}),c=Object.keys(r).length,e.abrupt("return",{sectorsCount:c,Sectors:r});case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"parentMessages",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t["/"]in this.parents)){e.next=2;break}return e.abrupt("return",this.parents[t["/"]]);case 2:return e.next=4,this.client.chainGetParentMessages(t);case 4:return a=e.sent,this.parents[t["/"]]=a,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiptParentMessages",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t["/"]in this.receipts)){e.next=2;break}return e.abrupt("return",this.receipts[t["/"]]);case 2:return e.next=4,this.client.chainGetParentReceipts(t);case 4:return a=e.sent,this.receipts[t["/"]]=a,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parentAndReceiptsMessages",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,r,c,s,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=i.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=i[r];return e.next=3,this.parentMessages(t);case 3:return c=e.sent,e.next=6,this.receiptParentMessages(t);case 6:if(s=e.sent,c.length==s.length){e.next=9;break}throw new Error("invalid length");case 9:return e.abrupt("return",K(c,s).filter((function(e){var t=Object(u.a)(e,2),a=t[0],r=0==t[1].ExitCode,c=!0;return n.length>0&&(c=n.includes(a.Message.Method)),r&&c})));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMinerPower",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t["/"]in this.minfo)){e.next=2;break}return e.abrupt("return",this.minfo[t["/"]]);case 2:return e.next=4,this.client.stateMinerPower(n,t);case 4:return r=e.sent,this.minfo[t["/"]]=r,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"fetchGenesisActors",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,r,c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.client.StateCirculatingSupply(t.Cids),this.client.StateReadState("f02",t.Cids),this.client.StateReadState("f04",t.Cids)]);case 2:return a=e.sent,n=Object(u.a)(a,3),r=n[0],c=n[1],s=n[2],e.abrupt("return",{Supply:r,Reward:c,Power:s});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"computeEconomics",value:function(e,t,a){var n=t.Supply,r=t.Reward,c=t.Power,s=a.projectedDays,i=a.perDurationNwRbGrowth,o=void 0===i?10*Math.pow(2,50):i,l=a.perDurationMinerQaGrowth,u=void 0===l?Math.pow(2,51):l,d={currEpoch:+e.Height,nwqap:+c.State.ThisEpochQualityAdjPower,nwqapP:+c.State.ThisEpochQAPowerSmoothed.PositionEstimate/Math.pow(2,128),nwqapV:+c.State.ThisEpochQAPowerSmoothed.VelocityEstimate/Math.pow(2,128),nwCircSupply:+n/1e18,perEpochRewardP:+r.State.ThisEpochRewardSmoothed.PositionEstimate/(1e18*Math.pow(2,128)),perEpochRewardV:+r.State.ThisEpochRewardSmoothed.VelocityEstimate/(1e18*Math.pow(2,128)),nwCumsumRealized:+r.State.CumsumRealized,perDurationNwRbGrowth:o,projectedDays:s,perDurationMinerQaGrowth:u};return new N(d).summary()}}]),e}(),K=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return e.map((function(e,t){return a.reduce((function(e,a){return[].concat(Object(f.a)(e),[a[t]])}),[e])}))};function Y(e){var t=e.title,a=e.url,n=e.desc;return r.a.createElement("div",{className:"summary col-sm"},r.a.createElement("div",{className:"summary-title"},a?r.a.createElement("a",{href:a},t):r.a.createElement(r.a.Fragment,null,t)),r.a.createElement("div",{className:"summary-desc"},n))}var Z=a(28),X=(Z.format(","),Z.format(",.0f")),$=Z.format(",.3f"),ee=Z.format(",.1f");function te(e){var t=e.miners,a=e.client,c=e.actors,s=e.head,i=c&&a.computeEconomics(s,c,{projectedDays:1}),o=Object(n.useState)({}),l=Object(u.a)(o,2),p=l[0],m=l[1];Object(n.useEffect)((function(){m(t)}),[t]);var h=0;return Object(n.useEffect)((function(){if(a&&s&&t){console.log("reload miners list",h++);var e=!0,n=function(t){e&&m(t)};return Object.keys(t).forEach((function(e){a.updateMinerInfo(p,e,n,s,{deadlines:!1})})),function(){e=!1}}}),[a,s,t]),r.a.createElement("section",{id:"home",className:"container"},c&&r.a.createElement("div",{id:"actors",className:"section"},r.a.createElement("h3",null,"Tokens"),r.a.createElement("div",{className:"grid"},r.a.createElement(Y,{title:"".concat(X(+c.Supply/1e18||0)," FIL"),desc:"Circulating Supply"}))),c&&r.a.createElement("div",{id:"actors2",className:"section"},r.a.createElement("h3",null,"Power"),r.a.createElement("div",{className:"grid"},r.a.createElement(Y,{title:"".concat(X(+c.Power.State.TotalBytesCommitted/Math.pow(2,50)||0)," PiB"),desc:"Network Raw"}),r.a.createElement(Y,{title:"".concat($(+c.Reward.State.ThisEpochReward/5/1e18||0)," FIL"),desc:"Block Reward"}),r.a.createElement(Y,{desc:"Active Miners",title:"".concat(X(+c.Power.State.MinerAboveMinPowerCount||0))}))),i&&r.a.createElement("div",{id:"economics",className:"section"},r.a.createElement("h3",null,"Economics"),r.a.createElement("div",{className:"grid"},i&&r.a.createElement(Y,{title:"".concat($(i.sectorIp||0)," FIL"),desc:"Sector Pledge"}),i&&r.a.createElement(Y,{title:"".concat($(i.sectorProjectedReward||0)," FIL"),desc:"Sector 360-Days Reward"}),i&&r.a.createElement(Y,{desc:"Sector Fault Fee",title:"".concat($(i.sectorFaultFee||0)," FIL")})),"These numbers are approximate projections based on the current network state and may be incorrect, do your own research."),r.a.createElement("div",{className:"section"},r.a.createElement("h3",null,"Gas"),"See ",r.a.createElement(d.b,{to:"/gas"}," here ")," for a detailed gas analysis."),r.a.createElement("div",{className:"spacerace"},r.a.createElement("h3",null,"Top miners"),r.a.createElement("table",{class:"table space"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"#"),r.a.createElement("th",{scope:"col"},"Miner"),r.a.createElement("th",{scope:"col"},"Power"),r.a.createElement("th",{scope:"col"},"PreCommits"),r.a.createElement("th",{scope:"col"},"Available Balance"))),r.a.createElement("tbody",null,p&&t&&Object.keys(t).map((function(e,a){return r.a.createElement("tr",{key:a},r.a.createElement("th",{scope:"row"},a+1),r.a.createElement("td",{align:"right"},r.a.createElement(d.b,{to:"/miners/".concat(t[e].address)},t&&t[e]&&t[e].address)),r.a.createElement("td",{align:"right"},ee(p[e]&&+p[e].rawBytePower/Math.pow(2,50))," ","PiB"),r.a.createElement("td",{align:"right"},p[e]&&p[e].preCommits&&p[e].preCommits.Count),r.a.createElement("td",{align:"right"},p[e]&&p[e].deposits&&p[e].deposits.Available))})))),r.a.createElement("div",null,"See deadlines of ",r.a.createElement(d.b,{to:"/full"},"top 50 miners")," or click on individual miners or the ",r.a.createElement(d.b,{to:"/status"},"network status"),".")))}function ae(e){var t=e.deadline,a=e.head,n=t;return r.a.createElement("div",{className:"deadlines windowpost"},r.a.createElement("div",{className:0===n.LiveSectors?"deadline opacity5":"deadline"},r.a.createElement("div",{className:"out"},"In ",n.Close-a.Height),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(32*n.LiveSectors/1024)," TiB"),r.a.createElement("div",{className:"hdds"},Object(f.a)(Array(Math.ceil(Math.round(32*n.LiveSectors/1024-+n.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd"}," ")})),Object(f.a)(Array(Math.ceil(Math.round(+n.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd faulty"}," ")}))))))}var ne=a(28).format(",.2f");function re(e){var t=e.client,a=e.spa,c=e.head,s=e.miners,i=Object(n.useState)({}),p=Object(u.a)(i,2),m=p[0],f=p[1],v=Object(n.useState)({}),b=Object(u.a)(v,2),E=b[0],w=b[1],g=Object(n.useState)(),y=Object(u.a)(g,2),j=y[0],O=y[1],x=Object(n.useState)(),k=Object(u.a)(x,2),N=k[0],S=k[1];return Object(n.useEffect)((function(){c&&function(){var e=Object(l.a)(o.a.mark((function e(){var a,n,r,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){var e=Object(l.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchTipsetHead(c.Height-a);case 2:return n=e.sent,e.next=5,t.fetchPower(n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=3,Promise.all([a(60),a(120)]);case 3:return n=e.sent,r=Object(u.a)(n,2),s=r[0],i=r[1],e.next=9,O(s);case 9:return e.next=11,S(i);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[c]),Object(n.useEffect)((function(){var e=!0;if(c){var a=Object.keys(s).slice(0,40).map((function(e){return s[e].address}));return G()(5,a,function(){var a=Object(l.a)(o.a.mark((function a(n){var r,s,i;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,t.fetchDeadlines(n,c);case 4:if(r=a.sent,e){a.next=7;break}return a.abrupt("return");case 7:return a.next=9,t.fetchTipsetHead(c.Height-2880);case 9:if(s=a.sent,e){a.next=12;break}return a.abrupt("return");case 12:return a.next=14,t.fetchDeadlines(n,s);case 14:if(i=a.sent,e){a.next=17;break}return a.abrupt("return");case 17:return m[n]=r,E[n]=i,a.next=21,f(Object(h.a)({},m));case 21:return a.next=23,w(Object(h.a)({},E));case 23:return a.abrupt("return",a.sent);case 24:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),function(){e=!1}}}),[t,c,s]),r.a.createElement("section",{className:"container"},r.a.createElement("div",{id:"deposits",className:"section"},r.a.createElement("div",{className:"grid"},a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,{title:ne(parseInt(a.TotalQualityAdjPower)/0x4000000000000),desc:"Total QA Power"})),j&&a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,{title:ne(parseInt(a.TotalQualityAdjPower-j.TotalQualityAdjPower)/0x4000000000000),desc:"60 Epochs delta"})),N&&a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,{title:ne(parseInt(a.TotalQualityAdjPower-N.TotalQualityAdjPower)/0x4000000000000),desc:"120 Epochs delta"})))),"Listing WindowPoSt duties of the top 50 miners.",s&&Object.keys(s).slice(0,40).map((function(e,t){return r.a.createElement("div",{className:"flex",key:t},r.a.createElement(d.b,{to:"/miners/".concat(s[e].address)},s[e].address),m&&m[s[e].address]&&r.a.createElement(ae,{head:c,deadline:m[s[e].address].nextDeadlines[47]}),E&&E[s[e].address]&&r.a.createElement(ae,{head:c,deadline:E[s[e].address].nextDeadlines[47]}))})))}function ce(e){var t=e.minerId,a=e.deadlines,n=e.head,c=e.link,s=e.out;return c||(c=function(e){return"/miners/".concat(t,"/deadlines/").concat(e.Index)}),s||(s=function(e){var t=e.d,a=e.head;e.i;return"In ".concat(t.Close-a.Height)}),n&&a?r.a.createElement("div",{className:"deadlines windowpost"},a&&a.map((function(e,t){return r.a.createElement("div",{key:t,className:0===e.LiveSectors?"deadline opacity5":"deadline"},r.a.createElement(d.b,{to:c(e)},r.a.createElement("div",{className:"out"},s({d:e,head:n,i:t})),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(32*e.LiveSectors/1024)," TiB"),r.a.createElement("div",{className:"hdds"},Object(f.a)(Array(Math.ceil(Math.round(32*e.LiveSectors/1024-+e.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd"}," ")})),Object(f.a)(Array(Math.ceil(Math.round(+e.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd faulty"}," ")}))))))}))):r.a.createElement(r.a.Fragment,null)}function se(e){var t=e.miners,a=e.client,c=Object(n.useState)({}),s=Object(u.a)(c,2),i=s[0],p=s[1],m=Object(n.useState)(),f=Object(u.a)(m,2),v=f[0],b=f[1];return Object(n.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetchHead();case 2:t=e.sent,b(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[a]),Object(n.useEffect)((function(){var e=!0;if(v){var n=Object.keys(t).slice(0,50).map((function(e){return t[e].address}));return G()(5,n,function(){var t=Object(l.a)(o.a.mark((function t(n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,a.fetchDeadlines(n,v);case 4:if(r=t.sent,e){t.next=7;break}return t.abrupt("return");case 7:return i[n]=r.nextDeadlines,t.next=10,p(Object(h.a)({},i));case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),function(){e=!1}}}),[a,v,t]),r.a.createElement("section",{id:"LookUp",className:"container"},"Listing WindowPoSt duties of the top 50 miners.",t&&Object.keys(t).slice(0,50).map((function(e,a){return r.a.createElement("div",{key:a},r.a.createElement(d.b,{to:"/miners/".concat(t[e].address)},t[e].address),r.a.createElement(ce,{deadlines:i[t[e].address],head:v}))})))}var ie=a(34);function oe(e){e.client;var t=e.miners,a=e.minerId,n=e.deadlineId,c=e.miner;return r.a.createElement("div",{className:"section minerbar"},r.a.createElement("div",{className:"minerId"},!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.b,{to:"/miners/".concat(a)},a),r.a.createElement("span",{className:"tinyarrow"},r.a.createElement("a",{href:"https://filfox.info/en/address/".concat(a)},"\u2197")),c&&c.deposits&&0!==+c.deposits.FeeDebt&&r.a.createElement("span",{className:"rekt"},"DEBT")),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.b,{to:"/miners/".concat(a,"/deadlines/").concat(n)},"Deadline ",n))),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"backto"},r.a.createElement(d.b,{to:"/miners/".concat(a)},"See miner",r.a.createElement("span",{className:"bolder"}," ",a)))),!n&&r.a.createElement("div",null,t&&t[a]&&t[a].tag&&r.a.createElement("span",{className:"miner-name"},t[a].tag.name,t&&t[a].location&&r.a.createElement("span",null," ",t[a].location.flagEmoji))))}var le=a(28),ue=le.format(","),de=le.format(",.1f");var pe=Object(p.g)((function(e){var t,a=e.miners,c=e.client,s=e.head,i=Object(p.f)(),d=i.minerId,m=i.deadlineId,v=Object(n.useState)(),b=Object(u.a)(v,2),E=b[0],w=b[1],g=Object(n.useState)({}),y=Object(u.a)(g,2),j=y[0],O=y[1],x=Object(n.useState)(),k=Object(u.a)(x,2),N=k[0],S=k[1];return Object(n.useEffect)((function(){N&&(console.log(">> today is set",N),c.fetchPartitionsSectors(N.deadlines[m].Partitions).then((function(e){w(e)})).catch((function(e){console.error("failed to load sectors")})))}),[N]),Object(n.useEffect)((function(){if(d&&s&&m){var e=Math.ceil(s.Height/2880),t=Object(f.a)(Array(e)).map((function(t,a){return{height:2880*a<=s.Height?2880*a:s.Height,day:e-a-1}})).reverse();if(console.log(">>> epochs",t),!N){try{G()(40,t,function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.day,n=t.height,e.prev=1,e.next=4,c.fetchTipsetHead(n);case 4:r=e.sent,e.next=7;break;case 7:e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(1),console.log("could not fetch head",d,a,n,e.t0),e.abrupt("return");case 13:return e.prev=13,e.next=16,c.fetchDeadlines(d,r);case 16:s=e.sent,e.next=19;break;case 19:j[a]=s,O(Object(h.a)({},j)),0===a&&S(s),e.next=27;break;case 24:e.prev=24,e.t1=e.catch(13),console.log("could not find",d,a,n,e.t1);case 27:case"end":return e.stop()}}),e,null,[[1,9],[13,24]])})));return function(t){return e.apply(this,arguments)}}())}catch(a){console.log("trouble with ",a)}return function(){!1}}}}),[c,s,d,m,N]),r.a.createElement("section",{className:"container"},r.a.createElement(oe,{client:c,miners:a,minerId:d,deadlineId:m}),r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"grid"},j&&j[0]&&r.a.createElement(Y,{title:"".concat(de(32*+j[0].deadlines[m].LiveSectors/1024)," TiB"),desc:"".concat(ue(j[0].deadlines[m].LiveSectors)," Live Sectors")}),j&&j[0]&&r.a.createElement(Y,{title:"".concat(de(+j[0].deadlines[m].FaultyPower.Raw/1099511627776)," TiB"),desc:"".concat(ue(+j[0].deadlines[m].FaultyPower.Raw/34359738368)," Faulty Sectors")}))),r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"History"),r.a.createElement("a",{"data-tip":!0,"data-for":"wpost-desc"},"(what is this?)"),r.a.createElement(ie.a,{id:"wpost-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of 48 WindowPoSt submission deadlines ordered by due time (in epochs).",r.a.createElement("br",null),"Bars represent ~8TB disks to be proven, white are healthy disks, red are faulty.")))),r.a.createElement(ce,{link:function(e){return"/miners/".concat(d,"/deadlines/").concat(m)},deadlines:(t=m,Object.keys(j).sort((function(e,t){return+e-+t})).map((function(e){return[e,j[e]]})).map((function(e){var a=Object(u.a)(e,2);return a[0],a[1].deadlines[t]})).flat()),head:s,out:function(e){e.d,e.head;var t=e.i;return 0===t?"Today":"".concat(t,"d ago")}})),r.a.createElement("div",{className:"section sectors"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Sectors"),r.a.createElement("a",{"data-tip":!0,"data-for":"sectors-desc"},"(what is this?)"),r.a.createElement(ie.a,{id:"sectors-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"Each square is a 32GiB sector.")))),E&&r.a.createElement("div",null,E.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("h4",null,"Partition ",t," ",Object.keys(e[0].Faults).length===e[0].Sectors.length&&r.a.createElement("span",{className:"rekt"},"REKT")),r.a.createElement("div",{className:"s-partition"},e[0].Sectors.map((function(t){return r.a.createElement("div",{key:t,className:"s-sector ".concat(e[0].Faults[t]&&"faulty"," ").concat(e[0].Terminated[t]&&"terminated"," ").concat(e[0].Recoveries[t]&&"recovering")},r.a.createElement("span",null,t))}))))})))))})),me=a(28),he=me.format(","),fe=me.format(",.0f");var ve=Object(p.g)((function(e){var t=e.client,a=e.miners,c=e.head,s=e.actors,i=Object(p.f)().minerId,o=Object(n.useState)(Object(m.a)({},i,{id:i})),l=Object(u.a)(o,2),d=l[0],h=l[1],f=s&&t.computeEconomics(c,s,{projectedDays:1}).sectorFaultFee;if(Object(n.useEffect)((function(){if(i&&c&&t){var e=!0;return t.updateMinerInfo(d,i,(function(t){e&&h(t)}),c),function(){e=!1}}}),[t,c,i]),!i||!c||!d[i])return r.a.createElement(r.a.Fragment,null);var v=d[i];return r.a.createElement("section",{className:"container"},r.a.createElement(oe,{client:t,miners:a,minerId:i,miner:v}),r.a.createElement("div",{id:"deposits",className:"section"},r.a.createElement("div",{className:"grid"},v.deposits&&r.a.createElement(Y,{title:"".concat(he(v.deposits.Balance||0)," FIL"),desc:"Balance"}),v.deposits&&r.a.createElement(Y,{title:"".concat(he(v.deposits.Available||0)," FIL"),desc:"Available"}),v.deposits&&r.a.createElement(Y,{desc:"Vesting",title:"".concat(he(v.deposits.LockedFunds||0)," FIL")})),r.a.createElement("div",{className:"grid grid-4"},v.deposits&&r.a.createElement(Y,{title:"".concat(he(v.deposits.InitialPledge||0)," FIL"),desc:"Initial Pledge"}),v.deposits&&r.a.createElement(Y,{desc:"PreCommit Deposit",title:"".concat(he(v.deposits.PreCommitDeposits||0)," FIL")}),v.deposits&&r.a.createElement(Y,{title:"".concat(he(v.deposits.FeeDebt||0)," FIL"),desc:"Fee Debt"}),v.deposits&&f&&r.a.createElement(Y,{title:"".concat(fe((+v.deposits.Available+ +v.deposits.LockedFunds)/+f||0)),desc:"Faults to Debt"}))),r.a.createElement("div",{id:"sectors"},r.a.createElement("div",{className:"grid grid-4"},v.deadlines&&r.a.createElement(Y,{title:"".concat(fe(32*v.deadlines.SectorsCount/1024)," TiB"),desc:"".concat(he(v.deadlines.SectorsCount||0)," Total Sectors")}),v.deadlines&&r.a.createElement(Y,{title:"".concat(fe(32*v.deadlines.ActiveCount/1024)," TiB"),desc:"".concat(he(v.deadlines.ActiveCount||0)," Active Sectors")}),v.deadlines&&r.a.createElement(Y,{title:"".concat(fe(32*v.deadlines.FaultsCount/1024)," TiB"),desc:"".concat(he(v.deadlines.FaultsCount||0)," Faulty Sectors")}),v.preCommits&&r.a.createElement(Y,{title:he(v.preCommits.Count||0),desc:"PreCommits"}))),v.deadlines&&r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Deadlines"),r.a.createElement("a",{"data-tip":!0,"data-for":"wpost-desc"},"(what is this?)"),r.a.createElement(ie.a,{id:"wpost-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of 48 WindoPoSt submission deadlines ordered by due time (in epochs).",r.a.createElement("br",null),"Bars represent ~8TB disks to be proven, white are healthy disks, red are faulty.")))),r.a.createElement(ce,{minerId:i,deadlines:v.deadlines.nextDeadlines,head:c})),v.deadlines&&r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Upcoming Deadline"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"timeline"}),r.a.createElement("ul",null,r.a.createElement("li",null,"PoStSubmissions:",v.deadlines.nextDeadlines[0].PostSubmissions),r.a.createElement("li",null,"Sectors to Prove:"," ",v.deadlines.nextDeadlines[0].LiveSectors),r.a.createElement("li",null,"Current Deadline: ",v.deadlines.deadline.Index),r.a.createElement("li",null,"FaultCutoff:"," ",v.deadlines.deadline.FaultCutoff-c.Height),r.a.createElement("li",null,"Challenge: ",v.deadlines.deadline.Challenge-c.Height),r.a.createElement("li",null,v.deadlines.deadline.Open-c.Height>0?"Open":"Opened",": ",v.deadlines.deadline.Open-c.Height),r.a.createElement("li",null,"Close: ",v.deadlines.deadline.Close-c.Height))),r.a.createElement("div",{className:"col"},r.a.createElement(ce,{minerId:i,deadlines:[v.deadlines.nextDeadlines[0]],head:c})))),v.preCommits&&r.a.createElement("div",{id:"provecommit",className:"section"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"New sectors"),r.a.createElement("a",{"data-tip":!0,"data-for":"provecommit-desc"},"(what is this?)"),r.a.createElement(ie.a,{id:"provecommit-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of ProveCommits ordered by due time (in epochs).",r.a.createElement("br",null),"Circles represent sectors to be proven.")))),r.a.createElement("div",{className:"deadlines provecommit"},v.preCommits.PreCommitDeadlines.map((function(e,t){return r.a.createElement("div",{key:t,className:"deadline"},r.a.createElement("div",{className:"out"},"In ",e.Expiry-c.Height),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(e.Sectors.length)," sectors"),r.a.createElement("div",{className:"hdds"},e.Sectors.map((function(e){return r.a.createElement("div",{key:e,className:"hdd"},"")})))))})))))})),be=function(){return Ee.apply(this,arguments)};function Ee(){return(Ee=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api3.drand.sh/health");case 2:return e.next=4,e.sent.json();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we=a(28).format(",");function ge(){var e=new Date("2020-08-24 22:00:00Z").getTime();return Math.floor((Date.now()-e)/1e3/30)}function ye(e){var t=e.client,a=e.head,c=Object(n.useState)(ge()),s=Object(u.a)(c,2),i=s[0],d=s[1],p=Object(n.useState)(),m=Object(u.a)(p,2),h=m[0],f=m[1];return Object(n.useEffect)((function(){var e=!0,t=function(){var t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:be().then((function(t){e&&(h&&t.current===h.current?console.log("   repeated drand, skip"):(console.log("   new drand",t),f(t)))})),ge()!==i&&d(ge());case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t();var a=setInterval((function(){e&&t()}),5e3);return function(){e=!1,clearInterval(a),console.log("removing interval")}}),[t,a,h]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"tiny-grid"},a&&i&&r.a.createElement("div",null,"Filecoin Status"," ",r.a.createElement("span",null,a.Height<i?i-a.Height===1?"gathering blocks":"catching up":"ok")),a&&r.a.createElement("div",{className:"tiny"},"Current Tipset"," ",r.a.createElement("a",{href:"https://filfox.info/en/tipset/".concat(a.Height)},we(a.Height))),i&&r.a.createElement("div",{className:"tiny"},"Expected Tipset"," ",r.a.createElement("a",{href:"https://filfox.info/en/tipset/".concat(i)},we(i))),h&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"tiny"},"Drand Status"," ",r.a.createElement("span",null,h.current<h.expected?"catching up":"ok")),r.a.createElement("div",{className:"tiny"},"Current Drand"," ",r.a.createElement("a",{href:"https://api.drand.sh/public/".concat(h.current)},we(h.current))),r.a.createElement("div",{className:"tiny"},"Expected Drand"," ",r.a.createElement("a",{href:"https://api.drand.sh/public/".concat(h.expected)},we(h.expected))))))}var je=a(62),Oe=a.n(je);function xe(e){var t=e.nstats,a=e.head,c=Object(n.useState)({}),s=Object(u.a)(c,2),i=s[0],d=s[1],p=Object(n.useState)({}),m=Object(u.a)(p,2),f=m[0],v=m[1],b=Object(n.useState)(void 0),E=Object(u.a)(b,2),w=E[0],g=E[1],y=Object(n.useRef)(null),j=Object(n.useRef)(null),O=function(e){j.current.addEventListener("show.bs.collapse",(function(){e.update()})),j.current.addEventListener("hide.bs.collapse",(function(){e.update()}))},x={title:{display:!0,text:"Growth rate and proven sectors"},scales:{yAxes:[{id:"commits",type:"linear",position:"left",scaleLabel:{labelString:"Estimated Growth Rate (PB/day) ",display:!0}},{id:"wposts",type:"linear",position:"right",scaleLabel:{labelString:"Estimated Sectors Proven per height",display:!0}}]}},k=function(){var e=Object(l.a)(o.a.mark((function e(){var a,n,r,c,s,l,u,p,m,b,E,j,k,N,S,P;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.transactionsPerHeight(7);case 2:return a=e.sent,e.next=5,t.transactionsPerHeight(5);case 5:n=e.sent,r=Object.fromEntries(R(a,(function(e,t){return[t,e.length]}))),c=Object.fromEntries(R(n,(function(e,t){return[t,e.length]}))),s=Object(h.a)(Object(h.a)({},i),r),l=Object(h.a)(Object(h.a)({},f),c),u=R(s,(function(e,t){return t})).sort((function(e,t){return t-e})).slice(0,30).reverse(),p=C(s,(function(e,t){return u.includes(t)})),d(p),m=u.map((function(e){return p[e]})).map((function(e){return Math.round(32*e/1024/1024*2880)})),b=C(l,(function(e,t){return u.includes(t)})),v(b),E=u.map((function(e){return b[e]})).map((function(e){return Math.round(2349*e)})),void 0==(j=w)?(k=[{data:m,borderColor:Ce.blue,fill:!1,label:"Estimated growth rate in PB per day",yAxisID:"commits"},{data:E,borderColor:Ce.red,fill:!1,label:"Estimated number of proven sectors per height",yAxisID:"wposts"}],N={datasets:k,labels:u},S=y.current.getContext("2d"),P=new Oe.a(S,{type:"line",data:N,options:x}),O(j=P)):(j.data.datasets[0].data=m,j.data.datasets[1].data=E,j.data.labels=u,j.update()),g(j);case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){k()}),[a,t]),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"growth"},r.a.createElement("h2",null,r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseGrowth","aria-expanded":"true","aria-controls":"collapseBiggest"},"Growth evolution"))),r.a.createElement("div",{id:"collapseGrowth",ref:j,className:"collapse","aria-labelledby":"growth","data-parent":"#accordionExample"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"col-12"},void 0==w&&r.a.createElement("p",null," Loading.... "),r.a.createElement("canvas",{ref:y},"Loading...")))))}function ke(e){var t=e.nstats,a=Object(n.useState)(""),c=Object(u.a)(a,2),s=c[0],i=c[1],d=Object(n.useState)({}),p=Object(u.a)(d,2),m=p[0],h=p[1],f=function(){var e=Object(l.a)(o.a.mark((function e(a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),console.log("search miner for ",s),e.next=4,t.minerInfo(s);case 4:n=e.sent,h(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"minerInfo"},r.a.createElement("h2",null,r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseInfo","aria-expanded":"true","aria-controls":"collapseInfo"},"Miner info search"))),r.a.createElement("div",{id:"collapseInfo",className:"collapse","aria-labelledby":"minerInfo","data-parent":"#accordionExample"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-4"}," "),r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{for:"minerAddress"},"Miner address"),r.a.createElement("input",{value:s,onChange:function(e){return i(e.target.value)},type:"text",className:"form-control",placeholder:"Enter miner address"})),r.a.createElement("button",{onClick:f,type:"submit",className:"btn btn-primary"},"Search"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,["Miner","Raw Byte Power","Ratio over total raw power","Size","Daily gas required (wpost)","Daily price FIL"].map((function(e){return r.a.createElement("th",{key:e}," ",e," ")})))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null," ",s," "),r.a.createElement("td",null," ",m.raw," "),r.a.createElement("td",null," ",m.ratio," "),r.a.createElement("td",null," ",m.size," "),r.a.createElement("td",null," ",m.dailyGas," "),r.a.createElement("td",null," ",m.maxDailyPrice," ")))))))))}function Ne(e){var t=e.head,a=e.nstats,c=Object(n.useState)({}),s=Object(u.a)(c,2),i=(s[0],s[1]),d=Object(n.useState)({}),p=Object(u.a)(d,2),m=(p[0],p[1]),h=Object(n.useState)(void 0),f=Object(u.a)(h,2),v=f[0],b=f[1],E=Object(n.useRef)(null),w=Object(n.useRef)(null),g=function(e){w.current.addEventListener("show.bs.collapse",(function(){e.update()})),w.current.addEventListener("hide.bs.collapse",(function(){e.update()}))},y=function(){var e=Object(l.a)(o.a.mark((function e(){var t,n,r,c,s,l,u,d,p,h,f;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.biggestGasUserFor();case 2:if(t=e.sent,!(Object.keys(t).length<1)){e.next=5;break}return e.abrupt("return");case 5:n=Object.keys(t).sort((function(e,t){return t-e})),r=t[n[0]],c=r.slice(0,10).map((function(e){return e[1]})),s=[{data:c,backgroundColor:R(Ce,(function(e,t){return e})).slice(0,10),label:"transaction gas"}],l=r.slice(0,10).map((function(e){return e[0]})),u={title:{display:!0,text:"Gas usage at height ".concat(n[0])}},d={datasets:s,labels:l},m(u),i(d),void 0==(p=v)?(h=E.current.getContext("2d"),f=new Oe.a(h,{type:"doughnut",data:d,options:u}),g(p=f)):(v.data.datasets[0].data=c,v.options=u,v.update()),b(p);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){y()}),[t,a]),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"biggestGas"},r.a.createElement("h2",null,r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseBiggest","aria-expanded":"true","aria-controls":"collapseBiggest"},"Biggest gas users"))),r.a.createElement("div",{id:"collapseBiggest",ref:w,className:"collapse","aria-labelledby":"biggestGas","data-parent":"#accordionExample"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"col-12"},void 0==v&&r.a.createElement("p",null," Loading.... "),r.a.createElement("canvas",{ref:E},"Loading...")))))}function Se(e){var t=e.nstats,a=e.head,c=["","Average Count","Average GasUsed ","Ratio over total GasUsed","Average GasLimit","Ratio avg over total GasLimit","Ratio GasUsed over GasLimit","Ratio GasUsed over BlockLimit","Ratio GasLimit over BlockLimit"],s=Array(c.length-1).fill(0),i=Object(n.useState)({headers:c,total:s,wpost:s,pre:s,prove:s}),d=Object(u.a)(i,2),p=d[0],m=d[1],h=function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.avgTotalGasUsed();case 2:return e.sent,e.next=5,t.avgGasLimit();case 5:return e.sent,a=function(){var e=Object(l.a)(o.a.mark((function e(){var a,n,r,c,s,i,l,u,d=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.avgNumberTx.apply(t,d);case 2:return a=e.sent,e.next=5,t.avgGasOfMethod.apply(t,d);case 5:return n=e.sent,e.next=8,t.avgGasLimit.apply(t,d);case 8:return r=e.sent,e.next=11,t.avgRatioUsedOverTotalUsed.apply(t,d);case 11:return c=e.sent,e.next=14,t.avgRatioLimitOverTotalLimit.apply(t,d);case 14:return s=e.sent,e.next=17,t.avgRatioUsedOverLimit.apply(t,d);case 17:return i=e.sent,e.next=20,t.avgTotalGasUsedOverTipsetLimit.apply(t,d);case 20:return l=e.sent,e.next=23,t.avgTotalGasLimitOverTipsetLimit.apply(t,d);case 23:return u=e.sent,e.abrupt("return",[a,n,c,r,s,i,l,u]);case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),(n={}).headers=c,e.next=11,a();case 11:return n.total=e.sent,e.next=14,a(5);case 14:return n.wpost=e.sent,e.next=17,a(6);case 17:return n.pre=e.sent,e.next=20,a(7);case 20:n.prove=e.sent,m(n);case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){h(t)}),[t,a]);return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header",id:"headingOne"},r.a.createElement("h2",null,r.a.createElement("button",{className:"btn btn-link",type:"button","data-toggle":"collapse","data-target":"#collapseOne","aria-expanded":"false","aria-controls":"collapseOne"},"Gas usage table"))),r.a.createElement("div",{id:"collapseOne",className:"collapse","aria-labelledby":"headingOne","data-parent":"#accordionExample"},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"row"},r.a.createElement("p",null," ","This table shows different statistics about the gas usage per epoch. All results are averaged accross the last",3," epochs. You can find a complete description of each column below the table."," "),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("table",{className:"table table-hover"},r.a.createElement("thead",null,r.a.createElement("tr",null,p.headers.map((function(e){return r.a.createElement("th",{key:e}," ",e," ")})))),r.a.createElement("tbody",null,r.a.createElement(Pe,{name:"Total gas used:",values:p.total}),r.a.createElement(Pe,{name:"WindowPoSt:",values:p.wpost}),r.a.createElement(Pe,{name:"PreCommit:",values:p.pre}),r.a.createElement(Pe,{name:"ProveCommit:",values:p.prove}))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-0"}," "),r.a.createElement("div",{className:"col-11"},r.a.createElement("ul",{className:"list-group list-group-flush"},r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Average Count:")," number of transaction per epoch in average of the method"," "),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Average GasUsed:")," gas used per transaction of the method"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Ratio over total GasUsed:")," Precedent number divided by the total gas used accross all epochs"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Average GasLimit:")," gas limit set per transaction of the method"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Ratio over total GasLimit:")," Precedent number divided by the total gas used accross all epochs"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Ratio GasUsed over GasLimit:")," Total gas used for the method over total gas limit set accross all epoch"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Total GasUsed over BlockLimit:")," Total gas used divided by total gas limit set per epoch"),r.a.createElement("li",{className:"list-group-item"},r.a.createElement("b",null,"Total GasLimit over BlockLimit:")," precedent number divided by total gas limit set per epoch"))))))))}function Pe(e){return r.a.createElement("tr",null,r.a.createElement("td",null," ",e.name," "),e.values.map((function(e,t){return r.a.createElement("td",{key:t.toString()},isNaN(e)||Math.ceil(e)===e?e:e.toFixed(2))})))}var Me=Object(p.g)((function(e){var t=e.client,a=e.head,c=Object(n.useState)(),s=Object(u.a)(c,2),i=s[0],d=s[1],p=function(){var e=Object(l.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new I(t,3),e.next=3,a.fetchCids();case 3:d(a);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){p()}),[t,a]),i?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"accordion col-12",id:"accordionExample"},r.a.createElement(xe,{nstats:i,head:a}),r.a.createElement(ke,{nstats:i}),r.a.createElement(Ne,{nstats:i,head:a}),r.a.createElement(Se,{nstats:i,head:a}))):r.a.createElement(r.a.Fragment,null)})),Ce={red:"rgb(255, 99, 132)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(75, 192, 192)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"};a(152),a(153),a(155);var Re=function(){console.log("reloaded");var e=Object(n.useState)(),t=Object(u.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(),i=Object(u.a)(s,2),m=i[0],h=i[1],f=Object(n.useState)("wss://node.glif.io/space07/lotus/rpc/v0"),v=Object(u.a)(f,2),b=v[0],E=(v[1],Object(n.useState)(new J(b))),w=Object(u.a)(E,2),g=w[0],y=w[1],j=Object(n.useState)(),O=Object(u.a)(j,2),x=O[0],k=(O[1],Object(n.useState)()),N=Object(u.a)(k,2),S=N[0],P=N[1];return Object(n.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:return e.next=4,y(new J(b));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[b]),Object(n.useEffect)((function(){m&&function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.fetchGenesisActors(m);case 2:t=e.sent,P(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[g,m]),Object(n.useEffect)((function(){var e=!0;g.getMiners().then((function(t){e&&c(t)}));var t=function(){var t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:g.fetchHead().then((function(t){e&&(m&&t.Height===m.Height?console.log("   repeated block, skip"):(console.log("   new block",t.Height,m&&m.Height),h(t)))}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t();var a=setInterval((function(){e&&t()}),5e3);return function(){e=!1,clearInterval(a),console.log("removing interval")}}),[g,m]),r.a.createElement(d.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"container"},r.a.createElement(ye,{client:g,head:m})),r.a.createElement("header",{className:"container-fluid"},r.a.createElement(d.b,{to:"/"},r.a.createElement("h1",{id:"logo",className:"logo"},r.a.createElement("span",null,"spacegap")))),r.a.createElement("div",{className:"container"},r.a.createElement(p.c,null,r.a.createElement(p.a,{path:"/miners/:minerId/deadlines/:deadlineId"},r.a.createElement(pe,{client:g,miners:a,head:m})),r.a.createElement(p.a,{path:"/miners/:minerId"},r.a.createElement(ve,{actors:S,client:g,miners:a,head:m})),r.a.createElement(p.a,{path:"/full"},r.a.createElement(se,{client:g,miners:a})),r.a.createElement(p.a,{path:"/status"},r.a.createElement(re,{head:m,spa:x,client:g,miners:a})),r.a.createElement(p.a,{path:"/gas"},r.a.createElement(Me,{client:g,head:m})),r.a.createElement(p.a,{path:"/"},r.a.createElement(te,{actors:S,client:g,head:m,miners:a}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},87:function(e,t,a){e.exports=a(156)},92:function(e,t,a){}},[[87,1,2]]]);
//# sourceMappingURL=main.78f28e30.chunk.js.map