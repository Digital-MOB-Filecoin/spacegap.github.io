(this.webpackJsonpspacegap=this.webpackJsonpspacegap||[]).push([[0],{101:function(e,t){},113:function(e,t){},115:function(e,t){},152:function(e,t,a){},153:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(83),s=a.n(c),i=(a(92),a(1)),o=a.n(i),l=a(5),u=a(3),d=a(10),m=a(7),p=a(6),f=a(15),h=a(8),v=a(9),E=a(2),b=a(57),w=a(45),y=a(58),j=a.n(y),g=(a(31),a(31)),O=g.format("0.2f"),x=a(142)("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),k=a(35),S=a(81).testnet.fullNode,N={Sectors:"buffer",Faults:"buffer",Recoveries:"buffer",Terminated:"buffer",ExpirationEpochs:"cid",EarlyTerminated:"cid",LivePower:{a:"bigint",b:"bigint"},FaultyPower:{a:"bigint",b:"bigint"},RecoveringPower:{a:"bigint",b:"bigint"}},C={type:"hamt",key:"bigint",value:{info:{seal_proof:"int",sector_number:"int",sealed_cid:"cid",seal_rand_epoch:"int",deal_ids:["list","int"],expiration:"int",replace_capacity:"bool",replace_sector_deadline:"int",replace_sector_partition:"int",replace_sector_number:"int"},precommit_deposit:"bigint",precommit_epoch:"int",deal_weight:"bigint",verified_deal_weight:"bigint"}};function P(e){for(var t=0n,a=0;a<e.length;a++)t*=256n,t+=window.BigInt(e[a]);return t}function T(e){for(var t=new k(0),a=0;a<e.length;a++)t=(t=t.mul(new k(256))).add(new k(e[e.length-a-1]));return t}function I(e,t){var a=e.num.and(new k(1).shln(t).sub(new k(1)));return e.num=e.num.shrn(t),e.left-=t,a.toNumber()}function D(e){var t,a=function(e){for(var t={left:8*e.length,num:T(e)},a=(I(t,2),I(t,1)),n=[];t.left>0;){if(1!==I(t,1))if(1!==I(t,1)){for(var r=0,c=0,s=0;;s++){if(10===s)throw new Error("run too long");var i=I(t,8);if(i<128){if(s>9||9===s&&i>1)throw new Error("run too long");if(0===i&&c>0)throw new Error("invalid run");r|=i<<c;break}r|=(127&i)<<c,c+=7}n.push(r)}else{var o=I(t,4);n.push(o)}else n.push(1)}return{first:a,runs:n}}(e),n=a.first,r=a.runs,c=n,s=[],i=0,o=Object(E.a)(r);try{for(o.s();!(t=o.n()).done;){for(var l=t.value,u=0;u<l;u++)1===c&&s.push(i),i++;c=1-c}}catch(d){o.e(d)}finally{o.f()}return s}var F=function(){function e(t){Object(h.a)(this,e),this.url=t;var a=new w.a(t);console.log("new endpoint",t),this.client=new b.LotusRPC(a,{schema:S})}return Object(v.a)(e,[{key:"getData",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a,n){var r,c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.Blocks[0].ParentStateRoot["/"],e.next=3,this.client.chainGetNode("".concat(r,"/").concat(a));case 3:return c=e.sent.Obj,s=this,e.next=7,j.a.methods.decode(n,c).asObject(function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.client.chainGetNode(t);case 2:return a=e.sent,e.abrupt("return",a.Obj);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"fetchHead",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.chainHead();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchPartitionsSectors",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.chainGetNode("".concat(t["/"]));case 2:return a=e.sent.Obj[2][2],e.abrupt("return",a.map((function(e){return[{Sectors:D(j.a.methods.decode(N,e).Sectors)}]})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchTipsetHead",value:function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.ChainGetTipSetByHeight(t,null);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchPower",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.Blocks[0].ParentStateRoot["/"],e.next=3,this.client.chainGetNode("".concat(a,"/@Ha:t04/1"));case 3:return n=e.sent.Obj,e.abrupt("return",{TotalRawBytePower:P(x.decode(n[0])),TotalBytesCommitted:P(x.decode(n[1])),TotalQualityAdjPower:P(x.decode(n[2])),TotalQABytesCommitted:P(x.decode(n[3])),TotalPledgeCollateral:P(x.decode(n[4])),ThisEpochRawBytePower:P(x.decode(n[5])),ThisEpochQualityAdjPower:P(x.decode(n[6])),ThisEpochPledgeCollateral:P(x.decode(n[7]))});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchDeposits",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r,c,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.StateReadState(t,a.Cids);case 2:return n=e.sent,r=n.State.PreCommitDeposits,c=n.State.LockedFunds,s=n.Balance,i=s-r-c,e.abrupt("return",{collateral:O(n.Balance/1e18),available:O(i/1e18),locked:O(c/1e18),precommitdeposits:O(r/1e18)});case 8:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getMiners",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=window.localStorage.getItem("miners"))){e.next=3;break}return e.abrupt("return",JSON.parse(t));case 3:return e.next=5,fetch("https://filfox.info/api/v0/miner/list/power?pageSize=1000&page=0");case 5:return e.next=7,e.sent.json();case 7:return a=e.sent,n=a.miners.reduce((function(e,t){return e[t.address]=t,e}),{}),window.localStorage.setItem("miners",JSON.stringify(n)),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchDeadlines",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r,c,s,i,l,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.client.StateMinerProvingDeadline(t,a.Cids),this.client.StateMinerDeadlines(t,a.Cids)]);case 2:return n=e.sent,r=Object(u.a)(n,2),c=r[0],s=r[1],i=Object(f.a)(Array(48)).map((function(e,t){return Object(p.a)(Object(p.a)({},s[(c.Index+t)%48]),{},{Close:c.Close+60*t,Index:(c.Index+t)%48})})).map((function(e){return{Close:e.Close,LiveSectors:e.LiveSectors,TotalSectors:e.TotalSectors,FaultyPower:e.FaultyPower,Index:e.Index,Partitions:e.Partitions}})),l=s.map((function(e){return+e.LiveSectors})).reduce((function(e,t){return e+t}),0),d=s.map((function(e){return+e.FaultyPower.Raw})).reduce((function(e,t){return e+t}),0)/34359738368,e.abrupt("return",{deadlines:s.map((function(e,t){return Object(p.a)(Object(p.a)({},s[t]),{},{Close:c.Close+60*t,Index:t})})),nextDeadlines:i,SectorsCount:l,FaultsCount:d,ActiveCount:l-d,deadline:c});case 10:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchPreCommittedSectors",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData(a,"@Ha:".concat(t,"/1/5"),C);case 2:return n=e.sent,r=g.groups(Object.keys(n).map((function(e){return{SectorNumber:n[e].info.sector_number,Expiry:n[e].precommit_epoch+10210}})),(function(e){return e.Expiry})).map((function(e){var t=Object(u.a)(e,2);return{Expiry:t[0],Sectors:t[1].map((function(e){return e.SectorNumber}))}})).sort((function(e,t){return e.Expiry-t.Expiry})),e.abrupt("return",{PreCommitDeadlines:r,Count:Object.keys(n).length});case 5:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchSectors",value:function(){var e=Object(l.a)(o.a.mark((function e(t,a){var n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.StateMinerSectors(t,null,null,a.Cids);case 2:return n=e.sent,r=n.reduce((function(e,t){return e[t.ID]={number:t.ID,info:t},e}),{}),c=Object.keys(r).length,e.abrupt("return",{sectorsCount:c,Sectors:r});case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),H=function(){return B.apply(this,arguments)};function B(){return(B=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://pl-us.incentinet.drand.sh/health");case 2:return e.next=4,e.sent.json();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){var t=e.miners;return r.a.createElement("section",{id:"home",className:"container"},r.a.createElement("div",{className:"spacerace"},"Top miners:",t&&Object.keys(t).slice(0,5).map((function(e,a){return r.a.createElement("div",{key:a},a+1,"."," ",r.a.createElement(d.b,{to:"/miners/".concat(t[e].address)},t[e].address))}))),r.a.createElement("div",null,"See deadlines of ",r.a.createElement(d.b,{to:"/full"},"top 50 miners")," or click on individual miners or the ",r.a.createElement(d.b,{to:"/status"},"network status"),"."))}var _=a(33),L=a.n(_);function M(e){var t=e.title,a=e.url,n=e.desc;return r.a.createElement("div",{className:"summary col-sm"},r.a.createElement("div",{className:"summary-title"},a?r.a.createElement("a",{href:a},t):r.a.createElement(r.a.Fragment,null,t)),r.a.createElement("div",{className:"summary-desc"},n))}function R(e){var t=e.deadline,a=e.head,n=t;return r.a.createElement("div",{className:"deadlines windowpost"},r.a.createElement("div",{className:0===n.TotalSectors?"deadline opacity5":"deadline"},r.a.createElement("div",{className:"out"},"In ",n.Close-a.Height),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(32*n.TotalSectors/1024)," TiB"),r.a.createElement("div",{className:"hdds"},Object(f.a)(Array(Math.ceil(Math.round(32*n.TotalSectors/1024-+n.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd"}," ")})),Object(f.a)(Array(Math.ceil(Math.round(+n.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd faulty"}," ")}))))))}var W=a(31).format(",.2f");function Q(e){var t=e.client,a=e.spa,c=e.head,s=e.miners,i=Object(n.useState)({}),m=Object(u.a)(i,2),f=m[0],h=m[1],v=Object(n.useState)({}),E=Object(u.a)(v,2),b=E[0],w=E[1],y=Object(n.useState)(),j=Object(u.a)(y,2),g=j[0],O=j[1],x=Object(n.useState)(),k=Object(u.a)(x,2),S=k[0],N=k[1];return Object(n.useEffect)((function(){c&&function(){var e=Object(l.a)(o.a.mark((function e(){var a,n,r,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){var e=Object(l.a)(o.a.mark((function e(a){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetchTipsetHead(c.Height-a);case 2:return n=e.sent,e.next=5,t.fetchPower(n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=3,Promise.all([a(60),a(120)]);case 3:return n=e.sent,r=Object(u.a)(n,2),s=r[0],i=r[1],e.next=9,O(s);case 9:return e.next=11,N(i);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[c]),Object(n.useEffect)((function(){var e=!0;if(c){var a=Object.keys(s).slice(0,40).map((function(e){return s[e].address}));return L()(5,a,function(){var a=Object(l.a)(o.a.mark((function a(n){var r,s,i;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,t.fetchDeadlines(n,c);case 4:if(r=a.sent,e){a.next=7;break}return a.abrupt("return");case 7:return a.next=9,t.fetchTipsetHead(c.Height-2880);case 9:if(s=a.sent,e){a.next=12;break}return a.abrupt("return");case 12:return a.next=14,t.fetchDeadlines(n,s);case 14:if(i=a.sent,e){a.next=17;break}return a.abrupt("return");case 17:return f[n]=r,b[n]=i,a.next=21,h(Object(p.a)({},f));case 21:return a.next=23,w(Object(p.a)({},b));case 23:return a.abrupt("return",a.sent);case 24:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),function(){e=!1}}}),[t,c,s]),r.a.createElement("section",{className:"container"},r.a.createElement("div",{id:"deposits",className:"section"},r.a.createElement("div",{className:"grid"},a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{title:W(parseInt(a.TotalQualityAdjPower)/0x4000000000000),desc:"Total QA Power"})),g&&a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{title:W(parseInt(a.TotalQualityAdjPower-g.TotalQualityAdjPower)/0x4000000000000),desc:"60 Epochs delta"})),S&&a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{title:W(parseInt(a.TotalQualityAdjPower-S.TotalQualityAdjPower)/0x4000000000000),desc:"120 Epochs delta"})))),"Listing WindowPoSt duties of the top 50 miners.",s&&Object.keys(s).slice(0,40).map((function(e,t){return r.a.createElement("div",{className:"flex",key:t},r.a.createElement(d.b,{to:"/miners/".concat(s[e].address)},s[e].address),f&&f[s[e].address]&&r.a.createElement(R,{head:c,deadline:f[s[e].address].nextDeadlines[47]}),b&&b[s[e].address]&&r.a.createElement(R,{head:c,deadline:b[s[e].address].nextDeadlines[47]}))})))}function G(e){var t=e.minerId,a=e.deadlines,n=e.head,c=e.link,s=e.out;return c||(c=function(e){return"/miners/".concat(t,"/deadlines/").concat(e.Index)}),s||(s=function(e){var t=e.d,a=e.head;e.i;return"In ".concat(t.Close-a.Height)}),n&&a?r.a.createElement("div",{className:"deadlines windowpost"},a&&a.map((function(e,t){return r.a.createElement("div",{key:t,className:0===e.TotalSectors?"deadline opacity5":"deadline"},r.a.createElement(d.b,{to:c(e)},r.a.createElement("div",{className:"out"},s({d:e,head:n,i:t})),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(32*e.TotalSectors/1024)," TiB"),r.a.createElement("div",{className:"hdds"},Object(f.a)(Array(Math.ceil(Math.round(32*e.TotalSectors/1024-+e.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd"}," ")})),Object(f.a)(Array(Math.ceil(Math.round(+e.FaultyPower.Raw/1099511627776)/8))).map((function(e,t){return r.a.createElement("div",{key:t,className:"hdd faulty"}," ")}))))))}))):r.a.createElement(r.a.Fragment,null)}function J(e){var t=e.miners,a=e.client,c=Object(n.useState)({}),s=Object(u.a)(c,2),i=s[0],m=s[1],f=Object(n.useState)(),h=Object(u.a)(f,2),v=h[0],E=h[1];return Object(n.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.fetchHead();case 2:t=e.sent,E(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[a]),Object(n.useEffect)((function(){var e=!0;if(v){var n=Object.keys(t).slice(0,50).map((function(e){return t[e].address}));return L()(5,n,function(){var t=Object(l.a)(o.a.mark((function t(n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,a.fetchDeadlines(n,v);case 4:if(r=t.sent,e){t.next=7;break}return t.abrupt("return");case 7:return i[n]=r.nextDeadlines,t.next=10,m(Object(p.a)({},i));case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),function(){e=!1}}}),[a,v,t]),r.a.createElement("section",{id:"LookUp",className:"container"},"Listing WindowPoSt duties of the top 50 miners.",t&&Object.keys(t).slice(0,50).map((function(e,a){return r.a.createElement("div",{key:a},r.a.createElement(d.b,{to:"/miners/".concat(t[e].address)},t[e].address),r.a.createElement(G,{deadlines:i[t[e].address],head:v}))})))}var U=a(34);function z(e){e.client;var t=e.miners,a=e.minerId,n=e.deadlineId;return r.a.createElement("div",{className:"section minerbar"},r.a.createElement("div",{class:"minerId"},!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.b,{to:"/miners/".concat(a)},a),r.a.createElement("span",{className:"tinyarrow"},r.a.createElement("a",{href:"https://filfox.info/en/address/".concat(a)},"\u2197"))),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(d.b,{to:"/miners/".concat(a,"/deadlines/").concat(n)},"Deadline ",n))),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{class:"backto"},r.a.createElement(d.b,{to:"/miners/".concat(a)},"See miner",r.a.createElement("span",{class:"bolder"}," ",a)))),!n&&r.a.createElement("div",null,t&&t[a].tag&&r.a.createElement("span",{className:"miner-name"},t[a].tag.en,t&&t[a].location&&r.a.createElement("span",null," ",t[a].location.flagEmoji))))}var Z=a(31),q=Z.format(","),K=Z.format(",.1f");var V=Object(m.g)((function(e){var t,a=e.miners,c=e.client,s=e.head,i=Object(m.f)(),d=i.minerId,h=i.deadlineId,v=Object(n.useState)(),E=Object(u.a)(v,2),b=E[0],w=E[1],y=Object(n.useState)({}),j=Object(u.a)(y,2),g=j[0],O=j[1],x=Object(n.useState)(),k=Object(u.a)(x,2),S=k[0],N=k[1];return Object(n.useEffect)((function(){S&&c.fetchPartitionsSectors(S.nextDeadlines[0].Partitions).then((function(e){console.log("partitions, d",e),w(e)}))}),[S]),Object(n.useEffect)((function(){if(d&&s&&h){var e=!0,t=Object(f.a)(Array(28)).map((function(e,t){return{height:s.Height-2880*t,day:t}}));try{L()(10,t,function(){var t=Object(l.a)(o.a.mark((function t(a){var n,r,s,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.day,r=a.height,t.prev=1,t.next=4,c.fetchTipsetHead(r);case 4:if(s=t.sent,e){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,c.fetchDeadlines(d,s);case 9:if(i=t.sent,e){t.next=12;break}return t.abrupt("return");case 12:g[n]=i,O(Object(p.a)({},g)),0===n&&N(i),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(1),console.log("could not find",n,r),console.log(t.t0);case 21:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(e){return t.apply(this,arguments)}}())}catch(a){console.log("trouble with ",a)}return function(){e=!1}}}),[c,s,d,h]),r.a.createElement("section",{className:"container"},r.a.createElement(z,{client:c,miners:a,minerId:d,deadlineId:h}),r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"grid"},g&&g[0]&&r.a.createElement(M,{title:"".concat(K(32*+g[0].deadlines[h].LiveSectors/1024)," TiB"),desc:"".concat(q(g[0].deadlines[h].LiveSectors)," Live Sectors")}),g&&g[0]&&r.a.createElement(M,{title:"".concat(K(32*+g[0].deadlines[h].TotalSectors/1024)," TiB"),desc:"".concat(q(g[0].deadlines[h].TotalSectors)," Total Sectors")}),g&&g[0]&&r.a.createElement(M,{title:"".concat(K(+g[0].deadlines[h].FaultyPower.Raw/1099511627776)," TiB"),desc:"".concat(q(+g[0].deadlines[h].FaultyPower.Raw/34359738368)," Faulty Sectors")}))),r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"History"),r.a.createElement("a",{"data-tip":!0,"data-for":"wpost-desc"},"(what is this?)"),r.a.createElement(U.a,{id:"wpost-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of 48 WindowPoSt submission deadlines ordered by due time (in epochs).",r.a.createElement("br",null),"Bars represent ~8TB disks to be proven, white are healthy disks, red are faulty.")))),r.a.createElement(G,{link:function(e){return"/miners/".concat(d,"/deadlines/").concat(h)},deadlines:(t=h,Object.keys(g).sort((function(e,t){return e-t})).map((function(e){return[e,g[e]]})).map((function(e){var a=Object(u.a)(e,2);return a[0],a[1].deadlines[t]})).flat()),head:s,out:function(e){e.d,e.head;var t=e.i;return 0===t?"Today":"".concat(t,"d ago")}})),r.a.createElement("div",{className:"section sectors"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Sectors"),r.a.createElement("a",{"data-tip":!0,"data-for":"sectors-desc"},"(what is this?)"),r.a.createElement(U.a,{id:"sectors-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of 48 WindowPoSt submission deadlines ordered by due time (in epochs).")))),b&&r.a.createElement("div",null,b.map((function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Partition ",t),r.a.createElement("div",{className:"s-partition"},e[0].Sectors.map((function(e){return r.a.createElement("div",{className:"s-sector"},r.a.createElement("span",null,e))}))))})))))})),X=a(31),Y=X.format(","),$=X.format(",.0f");var ee=Object(m.g)((function(e){var t=e.client,a=e.miners,c=e.head,s=Object(m.f)().minerId,i=Object(n.useState)({id:s}),o=Object(u.a)(i,2),l=o[0],d=o[1];return Object(n.useEffect)((function(){if(s&&c){var e=!0;return d(Object(p.a)({},l)),t.fetchDeadlines(s,c).then((function(t){e&&(l.deadlines=t,d(Object(p.a)({},l)))})).catch((function(e){console.error("failed to load deadline")})),t.fetchDeposits(s,c).then((function(t){e&&(l.deposits=t,d(Object(p.a)({},l)))})),t.fetchPreCommittedSectors(s,c).then((function(t){e&&(l.preCommits=t,d(Object(p.a)({},l)))})),t.fetchSectors(s,c).then((function(t){e&&(l.sectors=t,d(Object(p.a)({},l)))})),function(){e=!1}}}),[t,c,s]),l&&c?r.a.createElement("section",{className:"container"},r.a.createElement(z,{client:t,miners:a,minerId:s}),r.a.createElement("div",{id:"deposits",className:"section"},r.a.createElement("div",{className:"grid"},l.deposits&&r.a.createElement(M,{title:"".concat(Y(l.deposits.collateral||0)," FIL"),desc:"Collateral"}),l.deposits&&r.a.createElement(M,{title:"".concat(Y(l.deposits.available||0)," FIL"),desc:"Available"}),l.deposits&&r.a.createElement(M,{desc:"Locked",title:"".concat(Y(l.deposits.locked||0)," FIL")}))),r.a.createElement("div",{id:"sectors"},r.a.createElement("div",{className:"grid grid-4"},l.deadlines&&r.a.createElement(M,{title:"".concat($(32*l.deadlines.SectorsCount/1024)," TiB"),desc:"".concat(Y(l.deadlines.SectorsCount||0)," Total Sectors")}),l.deadlines&&r.a.createElement(M,{title:"".concat($(32*l.deadlines.ActiveCount/1024)," TiB"),desc:"".concat(Y(l.deadlines.ActiveCount||0)," Active Sectors")}),l.deadlines&&r.a.createElement(M,{title:"".concat($(32*l.deadlines.FaultsCount/1024)," TiB"),desc:"".concat(Y(l.deadlines.FaultsCount||0)," Faulty Sectors")}),l.preCommits&&r.a.createElement(M,{title:Y(l.preCommits.Count||0),desc:"PreCommits"}))),l.deadlines&&r.a.createElement("div",{className:"section wpost"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Deadlines"),r.a.createElement("a",{"data-tip":!0,"data-for":"wpost-desc"},"(what is this?)"),r.a.createElement(U.a,{id:"wpost-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of 48 WindoPoSt submission deadlines ordered by due time (in epochs).",r.a.createElement("br",null),"Bars represent ~8TB disks to be proven, white are healthy disks, red are faulty.")))),r.a.createElement(G,{minerId:s,deadlines:l.deadlines.nextDeadlines,head:c})),l.deadlines&&r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"Upcoming Deadline"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("ul",null,r.a.createElement("li",null,"Sectors to Prove:"," ",l.deadlines.nextDeadlines[0].TotalSectors),r.a.createElement("li",null,"Current Deadline: ",l.deadlines.deadline.Index),r.a.createElement("li",null,"FaultCutoff:"," ",l.deadlines.deadline.FaultCutoff-c.Height),r.a.createElement("li",null,"Challenge: ",l.deadlines.deadline.Challenge-c.Height),r.a.createElement("li",null,l.deadlines.deadline.Open-c.Height>0?"Open":"Opened",": ",l.deadlines.deadline.Open-c.Height),r.a.createElement("li",null,"Close: ",l.deadlines.deadline.Close-c.Height))),r.a.createElement("div",{className:"col"},r.a.createElement(G,{minerId:s,deadlines:[l.deadlines.nextDeadlines[0]],head:c})))),l.preCommits&&r.a.createElement("div",{id:"provecommit",className:"section"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col section-title"},r.a.createElement("h3",null,"New sectors"),r.a.createElement("a",{"data-tip":!0,"data-for":"provecommit-desc"},"(what is this?)"),r.a.createElement(U.a,{id:"provecommit-desc",effect:"solid",place:"top"},r.a.createElement("span",null,"List of ProveCommits ordered by due time (in epochs).",r.a.createElement("br",null),"Circles represent sectors to be proven.")))),r.a.createElement("div",{className:"deadlines provecommit"},l.preCommits.PreCommitDeadlines.map((function(e,t){return r.a.createElement("div",{key:t,className:"deadline"},r.a.createElement("div",{className:"out"},"In ",e.Expiry-c.Height),r.a.createElement("div",{className:"hddWrapper"},r.a.createElement("div",{className:"in"},Math.round(e.Sectors.length)," sectors"),r.a.createElement("div",{className:"hdds"},e.Sectors.map((function(e){return r.a.createElement("div",{key:e,className:"hdd ".concat(!!l.sectors&&!!l.sectors.Sectors[e])},215428===e?l.sectors&&l.sectors.Sectors[e]:"")})))))}))))):r.a.createElement(r.a.Fragment,null)})),te=a(31).format(",");function ae(e){var t=e.head,a=e.expected,n=e.round;return r.a.createElement("div",{className:"tiny-grid"},t&&a&&r.a.createElement("div",null,"Filecoin Status"," ",r.a.createElement("span",null,t.Height<a?a-t.Height===1?"gathering blocks":"catching up":"ok")),t&&r.a.createElement("div",{className:"tiny"},"Current Tipset"," ",r.a.createElement("a",{href:"https://filfox.info/en/tipset/".concat(t.Height)},te(t.Height))),a&&r.a.createElement("div",{className:"tiny"},"Expected Tipset"," ",r.a.createElement("a",{href:"https://filfox.info/en/tipset/".concat(a)},te(a))),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"tiny"},"Drand Status"," ",r.a.createElement("span",null,n.current<n.expected?"catching up":"ok")),r.a.createElement("div",{className:"tiny"},"Current Drand"," ",r.a.createElement("a",{href:"https://api.drand.sh/public/".concat(n.current)},te(n.current))),r.a.createElement("div",{className:"tiny"},"Expected Drand"," ",r.a.createElement("a",{href:"https://api.drand.sh/public/".concat(n.expected)},te(n.expected)))))}a(151),a(152);function ne(){var e=new Date("2020-08-24 22:00:00Z").getTime();return Math.floor((Date.now()-e)/1e3/30)}var re=function(){var e=Object(n.useState)(),t=Object(u.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(),i=Object(u.a)(s,2),p=i[0],f=i[1],h=Object(n.useState)(),v=Object(u.a)(h,2),E=v[0],b=v[1],w=Object(n.useState)("wss://node.glif.io/space07/lotus/rpc/v0"),y=Object(u.a)(w,2),j=y[0],g=y[1],O=Object(n.useState)(new F(j)),x=Object(u.a)(O,2),k=x[0],S=x[1],N=Object(n.useState)(ne()),C=Object(u.a)(N,2),P=C[0],T=C[1],I=Object(n.useState)(),D=Object(u.a)(I,2),B=D[0],_=D[1];return Object(n.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return e.next=4,S(new F(j));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[j]),Object(n.useEffect)((function(){p&&k.fetchPower(p).then((function(e){_(e)}))}),[p,k]),Object(n.useEffect)((function(){var e=!0;k.getMiners().then((function(t){e&&c(t)}));var t=function(){var t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:k.fetchHead().then((function(t){e&&(p&&t.Height===p.Height?console.log("repeated block, skip"):(console.log("new block",t.Height,p&&p.Height),f(t)))})),H().then((function(t){e&&(E&&t.current===E.current?console.log("repeated drand, skip"):(console.log("new drand",t),b(t)))})),T(ne());case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t();var a=setInterval((function(){t()}),5e3);return function(){e=!1,clearInterval(a)}}),[k,p,E]),r.a.createElement(d.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("select",{onChange:function(e){return g(e.target.value)},value:j},r.a.createElement("option",{value:"wss://lotus.jimpick.com/spacerace_api/0/node/rpc/v0"},"Jim's node 0"),r.a.createElement("option",{value:"wss://lotus.jimpick.com/spacerace_api/1/node/rpc/v0"},"Jim's node 1"),r.a.createElement("option",{value:"ws://www.border.ninja:12342/node/rpc/v0"},"Border's node"),r.a.createElement("option",{value:"wss://node.glif.io/space07/lotus/rpc/v0"},"Glif's node")))),r.a.createElement(ae,{head:p,expected:P,round:E})),r.a.createElement("header",{className:"container-fluid"},r.a.createElement(d.b,{to:"/"},r.a.createElement("h1",{id:"logo",className:"logo"},r.a.createElement("span",null,"spacegap")))),r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/miners/:minerId/deadlines/:deadlineId"},r.a.createElement(V,{client:k,miners:a,head:p})),r.a.createElement(m.a,{path:"/miners/:minerId"},r.a.createElement(ee,{client:k,miners:a,head:p})),r.a.createElement(m.a,{path:"/full"},r.a.createElement(J,{client:k,miners:a})),r.a.createElement(m.a,{path:"/status"},r.a.createElement(Q,{head:p,spa:B,client:k,miners:a})),r.a.createElement(m.a,{path:"/"},r.a.createElement(A,{miners:a})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},87:function(e,t,a){e.exports=a(153)},92:function(e,t,a){}},[[87,1,2]]]);
//# sourceMappingURL=main.576ee155.chunk.js.map